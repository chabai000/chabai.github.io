<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>mysql基础和高级 | 茶白的博客</title><meta name="author" content="茶白"><meta name="copyright" content="茶白"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="MySQL基础123456789101112131415161718192021222324252627282930313233343536371.SQL.DB.DBMS分别是什么，他们之间的关系？DataBase（数据库，数据库实际上在硬盘上以文件的形式存在）DataBase Management System（数据库管理系统,常见的有:MYSQL Oracle DB2 Sybase Sqls">
<meta property="og:type" content="article">
<meta property="og:title" content="mysql基础和高级">
<meta property="og:url" content="https://chabai000.github.io/posts/37461/index.html">
<meta property="og:site_name" content="茶白的博客">
<meta property="og:description" content="MySQL基础123456789101112131415161718192021222324252627282930313233343536371.SQL.DB.DBMS分别是什么，他们之间的关系？DataBase（数据库，数据库实际上在硬盘上以文件的形式存在）DataBase Management System（数据库管理系统,常见的有:MYSQL Oracle DB2 Sybase Sqls">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://api.aqcoder.cn/random">
<meta property="article:published_time" content="2024-05-18T07:14:41.000Z">
<meta property="article:modified_time" content="2024-05-18T07:21:24.480Z">
<meta property="article:author" content="茶白">
<meta property="article:tag" content="数据库">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://api.aqcoder.cn/random"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://chabai000.github.io/posts/37461/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: 茶白","link":"链接: ","source":"来源: 茶白的博客","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体中文","cht_to_chs":"你已切换为简体中文","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'mysql基础和高级',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-05-18 15:21:24'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><style type="text/css">.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body{left:-66px!important}.aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover{left:0!important}</style><meta name="generator" content="Hexo 7.1.1"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (true) {
    document.addEventListener('pjax:send', () => { preloader.initLoading() })
    document.addEventListener('pjax:complete', () => { preloader.endLoading() })
  }
})()</script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fas fa-comments"></i><span> 说说</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://api.aqcoder.cn/random')"><nav id="nav"><span id="blog-info"><a href="/" title="茶白的博客"><span class="site-name">茶白的博客</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/artitalk/"><i class="fa-fw fas fa-comments"></i><span> 说说</span></a></li><li><a class="site-page child" href="/photos/"><i class="fa-fw fa fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page child" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 影视</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-paper-plane"></i><span> 留言板</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">mysql基础和高级</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-05-18T07:14:41.000Z" title="发表于 2024-05-18 15:14:41">2024-05-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-05-18T07:21:24.480Z" title="更新于 2024-05-18 15:21:24">2024-05-18</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">38.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>161分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="mysql基础和高级"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20210717152259981.png" alt="在这里插入图片描述"></p>
<h3 id="MySQL基础"><a href="#MySQL基础" class="headerlink" title="MySQL基础"></a>MySQL基础</h3><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">1.SQL.DB.DBMS分别是什么，他们之间的关系？</span><br><span class="line">DataBase（数据库，数据库实际上在硬盘上以文件的形式存在）</span><br><span class="line">DataBase Management System（数据库管理系统,常见的有:</span><br><span class="line">MYSQL Oracle DB2 Sybase Sqlserver...)</span><br><span class="line">SQL:结构化查询语言，是一门标准通用的语言。</span><br><span class="line">DBMS-(执行)-&gt;SQL-(操作)-&gt;DB</span><br><span class="line">2.SQL语言分类</span><br><span class="line">1、DML（Data Manipulation Language):数据操纵语句，用于添</span><br><span class="line">加、删除、修改、查询数据库记录，并检查数据完整性</span><br><span class="line">2、DDL（Data Definition Language):数据定义语句，用于库和</span><br><span class="line">表的创建、修改、删除。</span><br><span class="line">3、DCL（Data Control Language):数据控制语句，用于定义用</span><br><span class="line">户的访问权限和安全级别。</span><br><span class="line"></span><br><span class="line">DML用于查询与修改数据记录，包括如下SQL语句：</span><br><span class="line">INSERT：添加数据到数据库中</span><br><span class="line">UPDATE：修改数据库中的数据</span><br><span class="line">DELETE：删除数据库中的数据</span><br><span class="line">SELECT：选择（查询）数据</span><br><span class="line">SELECT是SQL语言的基础，最为重要。</span><br><span class="line"></span><br><span class="line">DDL用于定义数据库的结构，比如创建、修改或删除</span><br><span class="line">数据库对象，包括如下SQL语句：</span><br><span class="line">CREATE TABLE：创建数据库表</span><br><span class="line">ALTER TABLE：更改表结构、添加、删除、修改列长度</span><br><span class="line">DROP TABLE：删除表</span><br><span class="line">CREATE INDEX：在表上建立索引</span><br><span class="line">DROP INDEX：删除索引</span><br><span class="line"></span><br><span class="line">DCL用来控制数据库的访问，包括如下SQL语句：</span><br><span class="line">GRANT：授予访问权限</span><br><span class="line">REVOKE：撤销访问权限</span><br><span class="line">COMMIT：提交事务处理</span><br><span class="line">ROLLBACK：事务处理回退</span><br><span class="line">SAVEPOINT：设置保存点</span><br><span class="line">LOCK：对数据库的特定部分进行锁定</span><br><span class="line">123456789101112131415161718192021222324252627282930313233343536</span><br></pre></td></tr></table></figure>

<h4 id="1-1-启动和停止MySQL服务"><a href="#1-1-启动和停止MySQL服务" class="headerlink" title="1.1 启动和停止MySQL服务"></a>1.1 启动和停止MySQL服务</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">方式一：通过计算机管理方式</span><br><span class="line">右击计算机—管理—服务—启动或停止MySQL服务</span><br><span class="line">方式二：通过命令行方式</span><br><span class="line">启动：net start mysql服务名</span><br><span class="line">停止：net stop mysql服务名</span><br><span class="line">12345</span><br></pre></td></tr></table></figure>

<h4 id="1-2-MySQL服务端的登录和退出"><a href="#1-2-MySQL服务端的登录和退出" class="headerlink" title="1.2 MySQL服务端的登录和退出"></a>1.2 MySQL服务端的登录和退出</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">登录</span><br><span class="line">mysql –h 主机名 –u用户名 –p密码</span><br><span class="line">退出</span><br><span class="line">exit或ctrl+C</span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<h4 id="1-3-MySQL的常见命令"><a href="#1-3-MySQL的常见命令" class="headerlink" title="1.3 MySQL的常见命令"></a>1.3 MySQL的常见命令</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">1.查看当前所有的数据库</span><br><span class="line">show databases;</span><br><span class="line">2.查询当前使用的数据库</span><br><span class="line">select  database();</span><br><span class="line">3.打开指定的库</span><br><span class="line">use 库名</span><br><span class="line">4.导入数据</span><br><span class="line">source  D:\ bjpowernode.sql</span><br><span class="line"></span><br><span class="line">5.查看当前库的所有表</span><br><span class="line">show tables;</span><br><span class="line">6.查看其它库的所有表</span><br><span class="line">show tables from 库名;</span><br><span class="line">7.创建表</span><br><span class="line">create table 表名(</span><br><span class="line"></span><br><span class="line"><span class="code">	列名 列类型,</span></span><br><span class="line"><span class="code">	列名 列类型，</span></span><br><span class="line"><span class="code">	。。。</span></span><br><span class="line"><span class="code">);</span></span><br><span class="line"><span class="code">8.查看表结构</span></span><br><span class="line"><span class="code">desc 表名;</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">9.查看建表语句</span><br><span class="line">show create table <span class="language-xml"><span class="tag">&lt;<span class="name">table</span> <span class="attr">name</span>&gt;</span></span>;</span><br><span class="line">10.查看服务器的版本</span><br><span class="line">方式一：登录到mysql服务端</span><br><span class="line">select version();</span><br><span class="line">方式二：没有登录到mysql服务端</span><br><span class="line">mysql --version</span><br><span class="line">或</span><br><span class="line">mysql --V</span><br><span class="line">1234567891011121314151617181920212223242526272829303132</span><br></pre></td></tr></table></figure>

<h4 id="1-4-MySQL的语法规范"><a href="#1-4-MySQL的语法规范" class="headerlink" title="1.4 MySQL的语法规范"></a>1.4 MySQL的语法规范</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.不区分大小写,但建议关键字大写，表名、列名小写</span><br><span class="line">2.每条命令最好用分号结尾</span><br><span class="line">3.每条命令根据需要，可以进行缩进 或换行</span><br><span class="line">4.注释</span><br><span class="line">单行注释：#注释文字</span><br><span class="line">单行注释：-- 注释文字</span><br><span class="line">多行注释：/* 注释文字  <span class="emphasis">*/</span></span><br><span class="line"><span class="emphasis">1234567</span></span><br></pre></td></tr></table></figure>

<h4 id="1-5-基础查询"><a href="#1-5-基础查询" class="headerlink" title="1.5 基础查询"></a>1.5 基础查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">SQLyog Ultimate v10.00 Beta1</span></span><br><span class="line"><span class="comment">MySQL - 5.5.15 : Database - myemployees</span></span><br><span class="line"><span class="comment">*********************************************************************</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET NAMES utf8 */</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET SQL_MODE=&#x27;&#x27;*/</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#x27;NO_AUTO_VALUE_ON_ZERO&#x27; */</span>;</span><br><span class="line"><span class="comment">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span>;</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE <span class="comment">/*!32312 IF NOT EXISTS*/</span>`myemployees` <span class="comment">/*!40100 DEFAULT CHARACTER SET gb2312 */</span>;</span><br><span class="line"></span><br><span class="line">USE `myemployees`;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Table structure for table `departments` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `departments`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `departments` (</span><br><span class="line">  `department_id` <span class="type">int</span>(<span class="number">4</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `department_name` <span class="type">varchar</span>(<span class="number">3</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `manager_id` <span class="type">int</span>(<span class="number">6</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `location_id` <span class="type">int</span>(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`department_id`),</span><br><span class="line">  KEY `loc_id_fk` (`location_id`),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> `loc_id_fk` <span class="keyword">FOREIGN</span> KEY (`location_id`) <span class="keyword">REFERENCES</span> `locations` (`location_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">271</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>gb2312;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Data for the table `departments` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> `departments`(`department_id`,`department_name`,`manager_id`,`location_id`) <span class="keyword">values</span> (<span class="number">10</span>,<span class="string">&#x27;Adm&#x27;</span>,<span class="number">200</span>,<span class="number">1700</span>),(<span class="number">20</span>,<span class="string">&#x27;Mar&#x27;</span>,<span class="number">201</span>,<span class="number">1800</span>),(<span class="number">30</span>,<span class="string">&#x27;Pur&#x27;</span>,<span class="number">114</span>,<span class="number">1700</span>),(<span class="number">40</span>,<span class="string">&#x27;Hum&#x27;</span>,<span class="number">203</span>,<span class="number">2400</span>),(<span class="number">50</span>,<span class="string">&#x27;Shi&#x27;</span>,<span class="number">121</span>,<span class="number">1500</span>),(<span class="number">60</span>,<span class="string">&#x27;IT&#x27;</span>,<span class="number">103</span>,<span class="number">1400</span>),(<span class="number">70</span>,<span class="string">&#x27;Pub&#x27;</span>,<span class="number">204</span>,<span class="number">2700</span>),(<span class="number">80</span>,<span class="string">&#x27;Sal&#x27;</span>,<span class="number">145</span>,<span class="number">2500</span>),(<span class="number">90</span>,<span class="string">&#x27;Exe&#x27;</span>,<span class="number">100</span>,<span class="number">1700</span>),(<span class="number">100</span>,<span class="string">&#x27;Fin&#x27;</span>,<span class="number">108</span>,<span class="number">1700</span>),(<span class="number">110</span>,<span class="string">&#x27;Acc&#x27;</span>,<span class="number">205</span>,<span class="number">1700</span>),(<span class="number">120</span>,<span class="string">&#x27;Tre&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">130</span>,<span class="string">&#x27;Cor&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">140</span>,<span class="string">&#x27;Con&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">150</span>,<span class="string">&#x27;Sha&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">160</span>,<span class="string">&#x27;Ben&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">170</span>,<span class="string">&#x27;Man&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">180</span>,<span class="string">&#x27;Con&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">190</span>,<span class="string">&#x27;Con&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">200</span>,<span class="string">&#x27;Ope&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">210</span>,<span class="string">&#x27;IT &#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">220</span>,<span class="string">&#x27;NOC&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">230</span>,<span class="string">&#x27;IT &#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">240</span>,<span class="string">&#x27;Gov&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">250</span>,<span class="string">&#x27;Ret&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">260</span>,<span class="string">&#x27;Rec&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>),(<span class="number">270</span>,<span class="string">&#x27;Pay&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1700</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Table structure for table `employees` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `employees`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `employees` (</span><br><span class="line">  `employee_id` <span class="type">int</span>(<span class="number">6</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `first_name` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `last_name` <span class="type">varchar</span>(<span class="number">25</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `email` <span class="type">varchar</span>(<span class="number">25</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `phone_number` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `job_id` <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `salary` <span class="keyword">double</span>(<span class="number">10</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `commission_pct` <span class="keyword">double</span>(<span class="number">4</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `manager_id` <span class="type">int</span>(<span class="number">6</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `department_id` <span class="type">int</span>(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `hiredate` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`employee_id`),</span><br><span class="line">  KEY `dept_id_fk` (`department_id`),</span><br><span class="line">  KEY `job_id_fk` (`job_id`),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> `dept_id_fk` <span class="keyword">FOREIGN</span> KEY (`department_id`) <span class="keyword">REFERENCES</span> `departments` (`department_id`),</span><br><span class="line">  <span class="keyword">CONSTRAINT</span> `job_id_fk` <span class="keyword">FOREIGN</span> KEY (`job_id`) <span class="keyword">REFERENCES</span> `jobs` (`job_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">207</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>gb2312;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Data for the table `employees` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> `employees`(`employee_id`,`first_name`,`last_name`,`email`,`phone_number`,`job_id`,`salary`,`commission_pct`,`manager_id`,`department_id`,`hiredate`) <span class="keyword">values</span> (<span class="number">100</span>,<span class="string">&#x27;Steven&#x27;</span>,<span class="string">&#x27;K_ing&#x27;</span>,<span class="string">&#x27;SKING&#x27;</span>,<span class="string">&#x27;515.123.4567&#x27;</span>,<span class="string">&#x27;AD_PRES&#x27;</span>,<span class="number">24000.00</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>,<span class="number">90</span>,<span class="string">&#x27;1992-04-03 00:00:00&#x27;</span>),(<span class="number">101</span>,<span class="string">&#x27;Neena&#x27;</span>,<span class="string">&#x27;Kochhar&#x27;</span>,<span class="string">&#x27;NKOCHHAR&#x27;</span>,<span class="string">&#x27;515.123.4568&#x27;</span>,<span class="string">&#x27;AD_VP&#x27;</span>,<span class="number">17000.00</span>,<span class="keyword">NULL</span>,<span class="number">100</span>,<span class="number">90</span>,<span class="string">&#x27;1992-04-03 00:00:00&#x27;</span>),(<span class="number">102</span>,<span class="string">&#x27;Lex&#x27;</span>,<span class="string">&#x27;De Haan&#x27;</span>,<span class="string">&#x27;LDEHAAN&#x27;</span>,<span class="string">&#x27;515.123.4569&#x27;</span>,<span class="string">&#x27;AD_VP&#x27;</span>,<span class="number">17000.00</span>,<span class="keyword">NULL</span>,<span class="number">100</span>,<span class="number">90</span>,<span class="string">&#x27;1992-04-03 00:00:00&#x27;</span>),(<span class="number">103</span>,<span class="string">&#x27;Alexander&#x27;</span>,<span class="string">&#x27;Hunold&#x27;</span>,<span class="string">&#x27;AHUNOLD&#x27;</span>,<span class="string">&#x27;590.423.4567&#x27;</span>,<span class="string">&#x27;IT_PROG&#x27;</span>,<span class="number">9000.00</span>,<span class="keyword">NULL</span>,<span class="number">102</span>,<span class="number">60</span>,<span class="string">&#x27;1992-04-03 00:00:00&#x27;</span>),(<span class="number">104</span>,<span class="string">&#x27;Bruce&#x27;</span>,<span class="string">&#x27;Ernst&#x27;</span>,<span class="string">&#x27;BERNST&#x27;</span>,<span class="string">&#x27;590.423.4568&#x27;</span>,<span class="string">&#x27;IT_PROG&#x27;</span>,<span class="number">6000.00</span>,<span class="keyword">NULL</span>,<span class="number">103</span>,<span class="number">60</span>,<span class="string">&#x27;1992-04-03 00:00:00&#x27;</span>),(<span class="number">105</span>,<span class="string">&#x27;David&#x27;</span>,<span class="string">&#x27;Austin&#x27;</span>,<span class="string">&#x27;DAUSTIN&#x27;</span>,<span class="string">&#x27;590.423.4569&#x27;</span>,<span class="string">&#x27;IT_PROG&#x27;</span>,<span class="number">4800.00</span>,<span class="keyword">NULL</span>,<span class="number">103</span>,<span class="number">60</span>,<span class="string">&#x27;1998-03-03 00:00:00&#x27;</span>),(<span class="number">106</span>,<span class="string">&#x27;Valli&#x27;</span>,<span class="string">&#x27;Pataballa&#x27;</span>,<span class="string">&#x27;VPATABAL&#x27;</span>,<span class="string">&#x27;590.423.4560&#x27;</span>,<span class="string">&#x27;IT_PROG&#x27;</span>,<span class="number">4800.00</span>,<span class="keyword">NULL</span>,<span class="number">103</span>,<span class="number">60</span>,<span class="string">&#x27;1998-03-03 00:00:00&#x27;</span>),(<span class="number">107</span>,<span class="string">&#x27;Diana&#x27;</span>,<span class="string">&#x27;Lorentz&#x27;</span>,<span class="string">&#x27;DLORENTZ&#x27;</span>,<span class="string">&#x27;590.423.5567&#x27;</span>,<span class="string">&#x27;IT_PROG&#x27;</span>,<span class="number">4200.00</span>,<span class="keyword">NULL</span>,<span class="number">103</span>,<span class="number">60</span>,<span class="string">&#x27;1998-03-03 00:00:00&#x27;</span>),(<span class="number">108</span>,<span class="string">&#x27;Nancy&#x27;</span>,<span class="string">&#x27;Greenberg&#x27;</span>,<span class="string">&#x27;NGREENBE&#x27;</span>,<span class="string">&#x27;515.124.4569&#x27;</span>,<span class="string">&#x27;FI_MGR&#x27;</span>,<span class="number">12000.00</span>,<span class="keyword">NULL</span>,<span class="number">101</span>,<span class="number">100</span>,<span class="string">&#x27;1998-03-03 00:00:00&#x27;</span>),(<span class="number">109</span>,<span class="string">&#x27;Daniel&#x27;</span>,<span class="string">&#x27;Faviet&#x27;</span>,<span class="string">&#x27;DFAVIET&#x27;</span>,<span class="string">&#x27;515.124.4169&#x27;</span>,<span class="string">&#x27;FI_ACCOUNT&#x27;</span>,<span class="number">9000.00</span>,<span class="keyword">NULL</span>,<span class="number">108</span>,<span class="number">100</span>,<span class="string">&#x27;1998-03-03 00:00:00&#x27;</span>),(<span class="number">110</span>,<span class="string">&#x27;John&#x27;</span>,<span class="string">&#x27;Chen&#x27;</span>,<span class="string">&#x27;JCHEN&#x27;</span>,<span class="string">&#x27;515.124.4269&#x27;</span>,<span class="string">&#x27;FI_ACCOUNT&#x27;</span>,<span class="number">8200.00</span>,<span class="keyword">NULL</span>,<span class="number">108</span>,<span class="number">100</span>,<span class="string">&#x27;2000-09-09 00:00:00&#x27;</span>),(<span class="number">111</span>,<span class="string">&#x27;Ismael&#x27;</span>,<span class="string">&#x27;Sciarra&#x27;</span>,<span class="string">&#x27;ISCIARRA&#x27;</span>,<span class="string">&#x27;515.124.4369&#x27;</span>,<span class="string">&#x27;FI_ACCOUNT&#x27;</span>,<span class="number">7700.00</span>,<span class="keyword">NULL</span>,<span class="number">108</span>,<span class="number">100</span>,<span class="string">&#x27;2000-09-09 00:00:00&#x27;</span>),(<span class="number">112</span>,<span class="string">&#x27;Jose Manuel&#x27;</span>,<span class="string">&#x27;Urman&#x27;</span>,<span class="string">&#x27;JMURMAN&#x27;</span>,<span class="string">&#x27;515.124.4469&#x27;</span>,<span class="string">&#x27;FI_ACCOUNT&#x27;</span>,<span class="number">7800.00</span>,<span class="keyword">NULL</span>,<span class="number">108</span>,<span class="number">100</span>,<span class="string">&#x27;2000-09-09 00:00:00&#x27;</span>),(<span class="number">113</span>,<span class="string">&#x27;Luis&#x27;</span>,<span class="string">&#x27;Popp&#x27;</span>,<span class="string">&#x27;LPOPP&#x27;</span>,<span class="string">&#x27;515.124.4567&#x27;</span>,<span class="string">&#x27;FI_ACCOUNT&#x27;</span>,<span class="number">6900.00</span>,<span class="keyword">NULL</span>,<span class="number">108</span>,<span class="number">100</span>,<span class="string">&#x27;2000-09-09 00:00:00&#x27;</span>),(<span class="number">114</span>,<span class="string">&#x27;Den&#x27;</span>,<span class="string">&#x27;Raphaely&#x27;</span>,<span class="string">&#x27;DRAPHEAL&#x27;</span>,<span class="string">&#x27;515.127.4561&#x27;</span>,<span class="string">&#x27;PU_MAN&#x27;</span>,<span class="number">11000.00</span>,<span class="keyword">NULL</span>,<span class="number">100</span>,<span class="number">30</span>,<span class="string">&#x27;2000-09-09 00:00:00&#x27;</span>),(<span class="number">115</span>,<span class="string">&#x27;Alexander&#x27;</span>,<span class="string">&#x27;Khoo&#x27;</span>,<span class="string">&#x27;AKHOO&#x27;</span>,<span class="string">&#x27;515.127.4562&#x27;</span>,<span class="string">&#x27;PU_CLERK&#x27;</span>,<span class="number">3100.00</span>,<span class="keyword">NULL</span>,<span class="number">114</span>,<span class="number">30</span>,<span class="string">&#x27;2000-09-09 00:00:00&#x27;</span>),(<span class="number">116</span>,<span class="string">&#x27;Shelli&#x27;</span>,<span class="string">&#x27;Baida&#x27;</span>,<span class="string">&#x27;SBAIDA&#x27;</span>,<span class="string">&#x27;515.127.4563&#x27;</span>,<span class="string">&#x27;PU_CLERK&#x27;</span>,<span class="number">2900.00</span>,<span class="keyword">NULL</span>,<span class="number">114</span>,<span class="number">30</span>,<span class="string">&#x27;2000-09-09 00:00:00&#x27;</span>),(<span class="number">117</span>,<span class="string">&#x27;Sigal&#x27;</span>,<span class="string">&#x27;Tobias&#x27;</span>,<span class="string">&#x27;STOBIAS&#x27;</span>,<span class="string">&#x27;515.127.4564&#x27;</span>,<span class="string">&#x27;PU_CLERK&#x27;</span>,<span class="number">2800.00</span>,<span class="keyword">NULL</span>,<span class="number">114</span>,<span class="number">30</span>,<span class="string">&#x27;2000-09-09 00:00:00&#x27;</span>),(<span class="number">118</span>,<span class="string">&#x27;Guy&#x27;</span>,<span class="string">&#x27;Himuro&#x27;</span>,<span class="string">&#x27;GHIMURO&#x27;</span>,<span class="string">&#x27;515.127.4565&#x27;</span>,<span class="string">&#x27;PU_CLERK&#x27;</span>,<span class="number">2600.00</span>,<span class="keyword">NULL</span>,<span class="number">114</span>,<span class="number">30</span>,<span class="string">&#x27;2000-09-09 00:00:00&#x27;</span>),(<span class="number">119</span>,<span class="string">&#x27;Karen&#x27;</span>,<span class="string">&#x27;Colmenares&#x27;</span>,<span class="string">&#x27;KCOLMENA&#x27;</span>,<span class="string">&#x27;515.127.4566&#x27;</span>,<span class="string">&#x27;PU_CLERK&#x27;</span>,<span class="number">2500.00</span>,<span class="keyword">NULL</span>,<span class="number">114</span>,<span class="number">30</span>,<span class="string">&#x27;2000-09-09 00:00:00&#x27;</span>),(<span class="number">120</span>,<span class="string">&#x27;Matthew&#x27;</span>,<span class="string">&#x27;Weiss&#x27;</span>,<span class="string">&#x27;MWEISS&#x27;</span>,<span class="string">&#x27;650.123.1234&#x27;</span>,<span class="string">&#x27;ST_MAN&#x27;</span>,<span class="number">8000.00</span>,<span class="keyword">NULL</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">121</span>,<span class="string">&#x27;Adam&#x27;</span>,<span class="string">&#x27;Fripp&#x27;</span>,<span class="string">&#x27;AFRIPP&#x27;</span>,<span class="string">&#x27;650.123.2234&#x27;</span>,<span class="string">&#x27;ST_MAN&#x27;</span>,<span class="number">8200.00</span>,<span class="keyword">NULL</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">122</span>,<span class="string">&#x27;Payam&#x27;</span>,<span class="string">&#x27;Kaufling&#x27;</span>,<span class="string">&#x27;PKAUFLIN&#x27;</span>,<span class="string">&#x27;650.123.3234&#x27;</span>,<span class="string">&#x27;ST_MAN&#x27;</span>,<span class="number">7900.00</span>,<span class="keyword">NULL</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">123</span>,<span class="string">&#x27;Shanta&#x27;</span>,<span class="string">&#x27;Vollman&#x27;</span>,<span class="string">&#x27;SVOLLMAN&#x27;</span>,<span class="string">&#x27;650.123.4234&#x27;</span>,<span class="string">&#x27;ST_MAN&#x27;</span>,<span class="number">6500.00</span>,<span class="keyword">NULL</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">124</span>,<span class="string">&#x27;Kevin&#x27;</span>,<span class="string">&#x27;Mourgos&#x27;</span>,<span class="string">&#x27;KMOURGOS&#x27;</span>,<span class="string">&#x27;650.123.5234&#x27;</span>,<span class="string">&#x27;ST_MAN&#x27;</span>,<span class="number">5800.00</span>,<span class="keyword">NULL</span>,<span class="number">100</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">125</span>,<span class="string">&#x27;Julia&#x27;</span>,<span class="string">&#x27;Nayer&#x27;</span>,<span class="string">&#x27;JNAYER&#x27;</span>,<span class="string">&#x27;650.124.1214&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">3200.00</span>,<span class="keyword">NULL</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">126</span>,<span class="string">&#x27;Irene&#x27;</span>,<span class="string">&#x27;Mikkilineni&#x27;</span>,<span class="string">&#x27;IMIKKILI&#x27;</span>,<span class="string">&#x27;650.124.1224&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2700.00</span>,<span class="keyword">NULL</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">127</span>,<span class="string">&#x27;James&#x27;</span>,<span class="string">&#x27;Landry&#x27;</span>,<span class="string">&#x27;JLANDRY&#x27;</span>,<span class="string">&#x27;650.124.1334&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2400.00</span>,<span class="keyword">NULL</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">128</span>,<span class="string">&#x27;Steven&#x27;</span>,<span class="string">&#x27;Markle&#x27;</span>,<span class="string">&#x27;SMARKLE&#x27;</span>,<span class="string">&#x27;650.124.1434&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2200.00</span>,<span class="keyword">NULL</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">129</span>,<span class="string">&#x27;Laura&#x27;</span>,<span class="string">&#x27;Bissot&#x27;</span>,<span class="string">&#x27;LBISSOT&#x27;</span>,<span class="string">&#x27;650.124.5234&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">3300.00</span>,<span class="keyword">NULL</span>,<span class="number">121</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">130</span>,<span class="string">&#x27;Mozhe&#x27;</span>,<span class="string">&#x27;Atkinson&#x27;</span>,<span class="string">&#x27;MATKINSO&#x27;</span>,<span class="string">&#x27;650.124.6234&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2800.00</span>,<span class="keyword">NULL</span>,<span class="number">121</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">131</span>,<span class="string">&#x27;James&#x27;</span>,<span class="string">&#x27;Marlow&#x27;</span>,<span class="string">&#x27;JAMRLOW&#x27;</span>,<span class="string">&#x27;650.124.7234&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2500.00</span>,<span class="keyword">NULL</span>,<span class="number">121</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">132</span>,<span class="string">&#x27;TJ&#x27;</span>,<span class="string">&#x27;Olson&#x27;</span>,<span class="string">&#x27;TJOLSON&#x27;</span>,<span class="string">&#x27;650.124.8234&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2100.00</span>,<span class="keyword">NULL</span>,<span class="number">121</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">133</span>,<span class="string">&#x27;Jason&#x27;</span>,<span class="string">&#x27;Mallin&#x27;</span>,<span class="string">&#x27;JMALLIN&#x27;</span>,<span class="string">&#x27;650.127.1934&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">3300.00</span>,<span class="keyword">NULL</span>,<span class="number">122</span>,<span class="number">50</span>,<span class="string">&#x27;2004-02-06 00:00:00&#x27;</span>),(<span class="number">134</span>,<span class="string">&#x27;Michael&#x27;</span>,<span class="string">&#x27;Rogers&#x27;</span>,<span class="string">&#x27;MROGERS&#x27;</span>,<span class="string">&#x27;650.127.1834&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2900.00</span>,<span class="keyword">NULL</span>,<span class="number">122</span>,<span class="number">50</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">135</span>,<span class="string">&#x27;Ki&#x27;</span>,<span class="string">&#x27;Gee&#x27;</span>,<span class="string">&#x27;KGEE&#x27;</span>,<span class="string">&#x27;650.127.1734&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2400.00</span>,<span class="keyword">NULL</span>,<span class="number">122</span>,<span class="number">50</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">136</span>,<span class="string">&#x27;Hazel&#x27;</span>,<span class="string">&#x27;Philtanker&#x27;</span>,<span class="string">&#x27;HPHILTAN&#x27;</span>,<span class="string">&#x27;650.127.1634&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2200.00</span>,<span class="keyword">NULL</span>,<span class="number">122</span>,<span class="number">50</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">137</span>,<span class="string">&#x27;Renske&#x27;</span>,<span class="string">&#x27;Ladwig&#x27;</span>,<span class="string">&#x27;RLADWIG&#x27;</span>,<span class="string">&#x27;650.121.1234&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">3600.00</span>,<span class="keyword">NULL</span>,<span class="number">123</span>,<span class="number">50</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">138</span>,<span class="string">&#x27;Stephen&#x27;</span>,<span class="string">&#x27;Stiles&#x27;</span>,<span class="string">&#x27;SSTILES&#x27;</span>,<span class="string">&#x27;650.121.2034&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">3200.00</span>,<span class="keyword">NULL</span>,<span class="number">123</span>,<span class="number">50</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">139</span>,<span class="string">&#x27;John&#x27;</span>,<span class="string">&#x27;Seo&#x27;</span>,<span class="string">&#x27;JSEO&#x27;</span>,<span class="string">&#x27;650.121.2019&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2700.00</span>,<span class="keyword">NULL</span>,<span class="number">123</span>,<span class="number">50</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">140</span>,<span class="string">&#x27;Joshua&#x27;</span>,<span class="string">&#x27;Patel&#x27;</span>,<span class="string">&#x27;JPATEL&#x27;</span>,<span class="string">&#x27;650.121.1834&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2500.00</span>,<span class="keyword">NULL</span>,<span class="number">123</span>,<span class="number">50</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">141</span>,<span class="string">&#x27;Trenna&#x27;</span>,<span class="string">&#x27;Rajs&#x27;</span>,<span class="string">&#x27;TRAJS&#x27;</span>,<span class="string">&#x27;650.121.8009&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">3500.00</span>,<span class="keyword">NULL</span>,<span class="number">124</span>,<span class="number">50</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">142</span>,<span class="string">&#x27;Curtis&#x27;</span>,<span class="string">&#x27;Davies&#x27;</span>,<span class="string">&#x27;CDAVIES&#x27;</span>,<span class="string">&#x27;650.121.2994&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">3100.00</span>,<span class="keyword">NULL</span>,<span class="number">124</span>,<span class="number">50</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">143</span>,<span class="string">&#x27;Randall&#x27;</span>,<span class="string">&#x27;Matos&#x27;</span>,<span class="string">&#x27;RMATOS&#x27;</span>,<span class="string">&#x27;650.121.2874&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2600.00</span>,<span class="keyword">NULL</span>,<span class="number">124</span>,<span class="number">50</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">144</span>,<span class="string">&#x27;Peter&#x27;</span>,<span class="string">&#x27;Vargas&#x27;</span>,<span class="string">&#x27;PVARGAS&#x27;</span>,<span class="string">&#x27;650.121.2004&#x27;</span>,<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="number">2500.00</span>,<span class="keyword">NULL</span>,<span class="number">124</span>,<span class="number">50</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">145</span>,<span class="string">&#x27;John&#x27;</span>,<span class="string">&#x27;Russell&#x27;</span>,<span class="string">&#x27;JRUSSEL&#x27;</span>,<span class="string">&#x27;011.44.1344.429268&#x27;</span>,<span class="string">&#x27;SA_MAN&#x27;</span>,<span class="number">14000.00</span>,<span class="number">0.40</span>,<span class="number">100</span>,<span class="number">80</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">146</span>,<span class="string">&#x27;Karen&#x27;</span>,<span class="string">&#x27;Partners&#x27;</span>,<span class="string">&#x27;KPARTNER&#x27;</span>,<span class="string">&#x27;011.44.1344.467268&#x27;</span>,<span class="string">&#x27;SA_MAN&#x27;</span>,<span class="number">13500.00</span>,<span class="number">0.30</span>,<span class="number">100</span>,<span class="number">80</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">147</span>,<span class="string">&#x27;Alberto&#x27;</span>,<span class="string">&#x27;Errazuriz&#x27;</span>,<span class="string">&#x27;AERRAZUR&#x27;</span>,<span class="string">&#x27;011.44.1344.429278&#x27;</span>,<span class="string">&#x27;SA_MAN&#x27;</span>,<span class="number">12000.00</span>,<span class="number">0.30</span>,<span class="number">100</span>,<span class="number">80</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">148</span>,<span class="string">&#x27;Gerald&#x27;</span>,<span class="string">&#x27;Cambrault&#x27;</span>,<span class="string">&#x27;GCAMBRAU&#x27;</span>,<span class="string">&#x27;011.44.1344.619268&#x27;</span>,<span class="string">&#x27;SA_MAN&#x27;</span>,<span class="number">11000.00</span>,<span class="number">0.30</span>,<span class="number">100</span>,<span class="number">80</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">149</span>,<span class="string">&#x27;Eleni&#x27;</span>,<span class="string">&#x27;Zlotkey&#x27;</span>,<span class="string">&#x27;EZLOTKEY&#x27;</span>,<span class="string">&#x27;011.44.1344.429018&#x27;</span>,<span class="string">&#x27;SA_MAN&#x27;</span>,<span class="number">10500.00</span>,<span class="number">0.20</span>,<span class="number">100</span>,<span class="number">80</span>,<span class="string">&#x27;2002-12-23 00:00:00&#x27;</span>),(<span class="number">150</span>,<span class="string">&#x27;Peter&#x27;</span>,<span class="string">&#x27;Tucker&#x27;</span>,<span class="string">&#x27;PTUCKER&#x27;</span>,<span class="string">&#x27;011.44.1344.129268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">10000.00</span>,<span class="number">0.30</span>,<span class="number">145</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">151</span>,<span class="string">&#x27;David&#x27;</span>,<span class="string">&#x27;Bernstein&#x27;</span>,<span class="string">&#x27;DBERNSTE&#x27;</span>,<span class="string">&#x27;011.44.1344.345268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">9500.00</span>,<span class="number">0.25</span>,<span class="number">145</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">152</span>,<span class="string">&#x27;Peter&#x27;</span>,<span class="string">&#x27;Hall&#x27;</span>,<span class="string">&#x27;PHALL&#x27;</span>,<span class="string">&#x27;011.44.1344.478968&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">9000.00</span>,<span class="number">0.25</span>,<span class="number">145</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">153</span>,<span class="string">&#x27;Christopher&#x27;</span>,<span class="string">&#x27;Olsen&#x27;</span>,<span class="string">&#x27;COLSEN&#x27;</span>,<span class="string">&#x27;011.44.1344.498718&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">8000.00</span>,<span class="number">0.20</span>,<span class="number">145</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">154</span>,<span class="string">&#x27;Nanette&#x27;</span>,<span class="string">&#x27;Cambrault&#x27;</span>,<span class="string">&#x27;NCAMBRAU&#x27;</span>,<span class="string">&#x27;011.44.1344.987668&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">7500.00</span>,<span class="number">0.20</span>,<span class="number">145</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">155</span>,<span class="string">&#x27;Oliver&#x27;</span>,<span class="string">&#x27;Tuvault&#x27;</span>,<span class="string">&#x27;OTUVAULT&#x27;</span>,<span class="string">&#x27;011.44.1344.486508&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">7000.00</span>,<span class="number">0.15</span>,<span class="number">145</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">156</span>,<span class="string">&#x27;Janette&#x27;</span>,<span class="string">&#x27;K_ing&#x27;</span>,<span class="string">&#x27;JKING&#x27;</span>,<span class="string">&#x27;011.44.1345.429268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">10000.00</span>,<span class="number">0.35</span>,<span class="number">146</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">157</span>,<span class="string">&#x27;Patrick&#x27;</span>,<span class="string">&#x27;Sully&#x27;</span>,<span class="string">&#x27;PSULLY&#x27;</span>,<span class="string">&#x27;011.44.1345.929268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">9500.00</span>,<span class="number">0.35</span>,<span class="number">146</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">158</span>,<span class="string">&#x27;Allan&#x27;</span>,<span class="string">&#x27;McEwen&#x27;</span>,<span class="string">&#x27;AMCEWEN&#x27;</span>,<span class="string">&#x27;011.44.1345.829268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">9000.00</span>,<span class="number">0.35</span>,<span class="number">146</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">159</span>,<span class="string">&#x27;Lindsey&#x27;</span>,<span class="string">&#x27;Smith&#x27;</span>,<span class="string">&#x27;LSMITH&#x27;</span>,<span class="string">&#x27;011.44.1345.729268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">8000.00</span>,<span class="number">0.30</span>,<span class="number">146</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">160</span>,<span class="string">&#x27;Louise&#x27;</span>,<span class="string">&#x27;Doran&#x27;</span>,<span class="string">&#x27;LDORAN&#x27;</span>,<span class="string">&#x27;011.44.1345.629268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">7500.00</span>,<span class="number">0.30</span>,<span class="number">146</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">161</span>,<span class="string">&#x27;Sarath&#x27;</span>,<span class="string">&#x27;Sewall&#x27;</span>,<span class="string">&#x27;SSEWALL&#x27;</span>,<span class="string">&#x27;011.44.1345.529268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">7000.00</span>,<span class="number">0.25</span>,<span class="number">146</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">162</span>,<span class="string">&#x27;Clara&#x27;</span>,<span class="string">&#x27;Vishney&#x27;</span>,<span class="string">&#x27;CVISHNEY&#x27;</span>,<span class="string">&#x27;011.44.1346.129268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">10500.00</span>,<span class="number">0.25</span>,<span class="number">147</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">163</span>,<span class="string">&#x27;Danielle&#x27;</span>,<span class="string">&#x27;Greene&#x27;</span>,<span class="string">&#x27;DGREENE&#x27;</span>,<span class="string">&#x27;011.44.1346.229268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">9500.00</span>,<span class="number">0.15</span>,<span class="number">147</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">164</span>,<span class="string">&#x27;Mattea&#x27;</span>,<span class="string">&#x27;Marvins&#x27;</span>,<span class="string">&#x27;MMARVINS&#x27;</span>,<span class="string">&#x27;011.44.1346.329268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">7200.00</span>,<span class="number">0.10</span>,<span class="number">147</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">165</span>,<span class="string">&#x27;David&#x27;</span>,<span class="string">&#x27;Lee&#x27;</span>,<span class="string">&#x27;DLEE&#x27;</span>,<span class="string">&#x27;011.44.1346.529268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">6800.00</span>,<span class="number">0.10</span>,<span class="number">147</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">166</span>,<span class="string">&#x27;Sundar&#x27;</span>,<span class="string">&#x27;Ande&#x27;</span>,<span class="string">&#x27;SANDE&#x27;</span>,<span class="string">&#x27;011.44.1346.629268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">6400.00</span>,<span class="number">0.10</span>,<span class="number">147</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">167</span>,<span class="string">&#x27;Amit&#x27;</span>,<span class="string">&#x27;Banda&#x27;</span>,<span class="string">&#x27;ABANDA&#x27;</span>,<span class="string">&#x27;011.44.1346.729268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">6200.00</span>,<span class="number">0.10</span>,<span class="number">147</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">168</span>,<span class="string">&#x27;Lisa&#x27;</span>,<span class="string">&#x27;Ozer&#x27;</span>,<span class="string">&#x27;LOZER&#x27;</span>,<span class="string">&#x27;011.44.1343.929268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">11500.00</span>,<span class="number">0.25</span>,<span class="number">148</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">169</span>,<span class="string">&#x27;Harrison&#x27;</span>,<span class="string">&#x27;Bloom&#x27;</span>,<span class="string">&#x27;HBLOOM&#x27;</span>,<span class="string">&#x27;011.44.1343.829268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">10000.00</span>,<span class="number">0.20</span>,<span class="number">148</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">170</span>,<span class="string">&#x27;Tayler&#x27;</span>,<span class="string">&#x27;Fox&#x27;</span>,<span class="string">&#x27;TFOX&#x27;</span>,<span class="string">&#x27;011.44.1343.729268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">9600.00</span>,<span class="number">0.20</span>,<span class="number">148</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">171</span>,<span class="string">&#x27;William&#x27;</span>,<span class="string">&#x27;Smith&#x27;</span>,<span class="string">&#x27;WSMITH&#x27;</span>,<span class="string">&#x27;011.44.1343.629268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">7400.00</span>,<span class="number">0.15</span>,<span class="number">148</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">172</span>,<span class="string">&#x27;Elizabeth&#x27;</span>,<span class="string">&#x27;Bates&#x27;</span>,<span class="string">&#x27;EBATES&#x27;</span>,<span class="string">&#x27;011.44.1343.529268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">7300.00</span>,<span class="number">0.15</span>,<span class="number">148</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">173</span>,<span class="string">&#x27;Sundita&#x27;</span>,<span class="string">&#x27;Kumar&#x27;</span>,<span class="string">&#x27;SKUMAR&#x27;</span>,<span class="string">&#x27;011.44.1343.329268&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">6100.00</span>,<span class="number">0.10</span>,<span class="number">148</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">174</span>,<span class="string">&#x27;Ellen&#x27;</span>,<span class="string">&#x27;Abel&#x27;</span>,<span class="string">&#x27;EABEL&#x27;</span>,<span class="string">&#x27;011.44.1644.429267&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">11000.00</span>,<span class="number">0.30</span>,<span class="number">149</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">175</span>,<span class="string">&#x27;Alyssa&#x27;</span>,<span class="string">&#x27;Hutton&#x27;</span>,<span class="string">&#x27;AHUTTON&#x27;</span>,<span class="string">&#x27;011.44.1644.429266&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">8800.00</span>,<span class="number">0.25</span>,<span class="number">149</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">176</span>,<span class="string">&#x27;Jonathon&#x27;</span>,<span class="string">&#x27;Taylor&#x27;</span>,<span class="string">&#x27;JTAYLOR&#x27;</span>,<span class="string">&#x27;011.44.1644.429265&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">8600.00</span>,<span class="number">0.20</span>,<span class="number">149</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">177</span>,<span class="string">&#x27;Jack&#x27;</span>,<span class="string">&#x27;Livingston&#x27;</span>,<span class="string">&#x27;JLIVINGS&#x27;</span>,<span class="string">&#x27;011.44.1644.429264&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">8400.00</span>,<span class="number">0.20</span>,<span class="number">149</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">178</span>,<span class="string">&#x27;Kimberely&#x27;</span>,<span class="string">&#x27;Grant&#x27;</span>,<span class="string">&#x27;KGRANT&#x27;</span>,<span class="string">&#x27;011.44.1644.429263&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">7000.00</span>,<span class="number">0.15</span>,<span class="number">149</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">179</span>,<span class="string">&#x27;Charles&#x27;</span>,<span class="string">&#x27;Johnson&#x27;</span>,<span class="string">&#x27;CJOHNSON&#x27;</span>,<span class="string">&#x27;011.44.1644.429262&#x27;</span>,<span class="string">&#x27;SA_REP&#x27;</span>,<span class="number">6200.00</span>,<span class="number">0.10</span>,<span class="number">149</span>,<span class="number">80</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">180</span>,<span class="string">&#x27;Winston&#x27;</span>,<span class="string">&#x27;Taylor&#x27;</span>,<span class="string">&#x27;WTAYLOR&#x27;</span>,<span class="string">&#x27;650.507.9876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">3200.00</span>,<span class="keyword">NULL</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">181</span>,<span class="string">&#x27;Jean&#x27;</span>,<span class="string">&#x27;Fleaur&#x27;</span>,<span class="string">&#x27;JFLEAUR&#x27;</span>,<span class="string">&#x27;650.507.9877&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">3100.00</span>,<span class="keyword">NULL</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">182</span>,<span class="string">&#x27;Martha&#x27;</span>,<span class="string">&#x27;Sullivan&#x27;</span>,<span class="string">&#x27;MSULLIVA&#x27;</span>,<span class="string">&#x27;650.507.9878&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">2500.00</span>,<span class="keyword">NULL</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">183</span>,<span class="string">&#x27;Girard&#x27;</span>,<span class="string">&#x27;Geoni&#x27;</span>,<span class="string">&#x27;GGEONI&#x27;</span>,<span class="string">&#x27;650.507.9879&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">2800.00</span>,<span class="keyword">NULL</span>,<span class="number">120</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">184</span>,<span class="string">&#x27;Nandita&#x27;</span>,<span class="string">&#x27;Sarchand&#x27;</span>,<span class="string">&#x27;NSARCHAN&#x27;</span>,<span class="string">&#x27;650.509.1876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">4200.00</span>,<span class="keyword">NULL</span>,<span class="number">121</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">185</span>,<span class="string">&#x27;Alexis&#x27;</span>,<span class="string">&#x27;Bull&#x27;</span>,<span class="string">&#x27;ABULL&#x27;</span>,<span class="string">&#x27;650.509.2876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">4100.00</span>,<span class="keyword">NULL</span>,<span class="number">121</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">186</span>,<span class="string">&#x27;Julia&#x27;</span>,<span class="string">&#x27;Dellinger&#x27;</span>,<span class="string">&#x27;JDELLING&#x27;</span>,<span class="string">&#x27;650.509.3876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">3400.00</span>,<span class="keyword">NULL</span>,<span class="number">121</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">187</span>,<span class="string">&#x27;Anthony&#x27;</span>,<span class="string">&#x27;Cabrio&#x27;</span>,<span class="string">&#x27;ACABRIO&#x27;</span>,<span class="string">&#x27;650.509.4876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">3000.00</span>,<span class="keyword">NULL</span>,<span class="number">121</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">188</span>,<span class="string">&#x27;Kelly&#x27;</span>,<span class="string">&#x27;Chung&#x27;</span>,<span class="string">&#x27;KCHUNG&#x27;</span>,<span class="string">&#x27;650.505.1876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">3800.00</span>,<span class="keyword">NULL</span>,<span class="number">122</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">189</span>,<span class="string">&#x27;Jennifer&#x27;</span>,<span class="string">&#x27;Dilly&#x27;</span>,<span class="string">&#x27;JDILLY&#x27;</span>,<span class="string">&#x27;650.505.2876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">3600.00</span>,<span class="keyword">NULL</span>,<span class="number">122</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">190</span>,<span class="string">&#x27;Timothy&#x27;</span>,<span class="string">&#x27;Gates&#x27;</span>,<span class="string">&#x27;TGATES&#x27;</span>,<span class="string">&#x27;650.505.3876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">2900.00</span>,<span class="keyword">NULL</span>,<span class="number">122</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">191</span>,<span class="string">&#x27;Randall&#x27;</span>,<span class="string">&#x27;Perkins&#x27;</span>,<span class="string">&#x27;RPERKINS&#x27;</span>,<span class="string">&#x27;650.505.4876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">2500.00</span>,<span class="keyword">NULL</span>,<span class="number">122</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">192</span>,<span class="string">&#x27;Sarah&#x27;</span>,<span class="string">&#x27;Bell&#x27;</span>,<span class="string">&#x27;SBELL&#x27;</span>,<span class="string">&#x27;650.501.1876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">4000.00</span>,<span class="keyword">NULL</span>,<span class="number">123</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">193</span>,<span class="string">&#x27;Britney&#x27;</span>,<span class="string">&#x27;Everett&#x27;</span>,<span class="string">&#x27;BEVERETT&#x27;</span>,<span class="string">&#x27;650.501.2876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">3900.00</span>,<span class="keyword">NULL</span>,<span class="number">123</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">194</span>,<span class="string">&#x27;Samuel&#x27;</span>,<span class="string">&#x27;McCain&#x27;</span>,<span class="string">&#x27;SMCCAIN&#x27;</span>,<span class="string">&#x27;650.501.3876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">3200.00</span>,<span class="keyword">NULL</span>,<span class="number">123</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">195</span>,<span class="string">&#x27;Vance&#x27;</span>,<span class="string">&#x27;Jones&#x27;</span>,<span class="string">&#x27;VJONES&#x27;</span>,<span class="string">&#x27;650.501.4876&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">2800.00</span>,<span class="keyword">NULL</span>,<span class="number">123</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">196</span>,<span class="string">&#x27;Alana&#x27;</span>,<span class="string">&#x27;Walsh&#x27;</span>,<span class="string">&#x27;AWALSH&#x27;</span>,<span class="string">&#x27;650.507.9811&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">3100.00</span>,<span class="keyword">NULL</span>,<span class="number">124</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">197</span>,<span class="string">&#x27;Kevin&#x27;</span>,<span class="string">&#x27;Feeney&#x27;</span>,<span class="string">&#x27;KFEENEY&#x27;</span>,<span class="string">&#x27;650.507.9822&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">3000.00</span>,<span class="keyword">NULL</span>,<span class="number">124</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">198</span>,<span class="string">&#x27;Donald&#x27;</span>,<span class="string">&#x27;OConnell&#x27;</span>,<span class="string">&#x27;DOCONNEL&#x27;</span>,<span class="string">&#x27;650.507.9833&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">2600.00</span>,<span class="keyword">NULL</span>,<span class="number">124</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">199</span>,<span class="string">&#x27;Douglas&#x27;</span>,<span class="string">&#x27;Grant&#x27;</span>,<span class="string">&#x27;DGRANT&#x27;</span>,<span class="string">&#x27;650.507.9844&#x27;</span>,<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="number">2600.00</span>,<span class="keyword">NULL</span>,<span class="number">124</span>,<span class="number">50</span>,<span class="string">&#x27;2014-03-05 00:00:00&#x27;</span>),(<span class="number">200</span>,<span class="string">&#x27;Jennifer&#x27;</span>,<span class="string">&#x27;Whalen&#x27;</span>,<span class="string">&#x27;JWHALEN&#x27;</span>,<span class="string">&#x27;515.123.4444&#x27;</span>,<span class="string">&#x27;AD_ASST&#x27;</span>,<span class="number">4400.00</span>,<span class="keyword">NULL</span>,<span class="number">101</span>,<span class="number">10</span>,<span class="string">&#x27;2016-03-03 00:00:00&#x27;</span>),(<span class="number">201</span>,<span class="string">&#x27;Michael&#x27;</span>,<span class="string">&#x27;Hartstein&#x27;</span>,<span class="string">&#x27;MHARTSTE&#x27;</span>,<span class="string">&#x27;515.123.5555&#x27;</span>,<span class="string">&#x27;MK_MAN&#x27;</span>,<span class="number">13000.00</span>,<span class="keyword">NULL</span>,<span class="number">100</span>,<span class="number">20</span>,<span class="string">&#x27;2016-03-03 00:00:00&#x27;</span>),(<span class="number">202</span>,<span class="string">&#x27;Pat&#x27;</span>,<span class="string">&#x27;Fay&#x27;</span>,<span class="string">&#x27;PFAY&#x27;</span>,<span class="string">&#x27;603.123.6666&#x27;</span>,<span class="string">&#x27;MK_REP&#x27;</span>,<span class="number">6000.00</span>,<span class="keyword">NULL</span>,<span class="number">201</span>,<span class="number">20</span>,<span class="string">&#x27;2016-03-03 00:00:00&#x27;</span>),(<span class="number">203</span>,<span class="string">&#x27;Susan&#x27;</span>,<span class="string">&#x27;Mavris&#x27;</span>,<span class="string">&#x27;SMAVRIS&#x27;</span>,<span class="string">&#x27;515.123.7777&#x27;</span>,<span class="string">&#x27;HR_REP&#x27;</span>,<span class="number">6500.00</span>,<span class="keyword">NULL</span>,<span class="number">101</span>,<span class="number">40</span>,<span class="string">&#x27;2016-03-03 00:00:00&#x27;</span>),(<span class="number">204</span>,<span class="string">&#x27;Hermann&#x27;</span>,<span class="string">&#x27;Baer&#x27;</span>,<span class="string">&#x27;HBAER&#x27;</span>,<span class="string">&#x27;515.123.8888&#x27;</span>,<span class="string">&#x27;PR_REP&#x27;</span>,<span class="number">10000.00</span>,<span class="keyword">NULL</span>,<span class="number">101</span>,<span class="number">70</span>,<span class="string">&#x27;2016-03-03 00:00:00&#x27;</span>),(<span class="number">205</span>,<span class="string">&#x27;Shelley&#x27;</span>,<span class="string">&#x27;Higgins&#x27;</span>,<span class="string">&#x27;SHIGGINS&#x27;</span>,<span class="string">&#x27;515.123.8080&#x27;</span>,<span class="string">&#x27;AC_MGR&#x27;</span>,<span class="number">12000.00</span>,<span class="keyword">NULL</span>,<span class="number">101</span>,<span class="number">110</span>,<span class="string">&#x27;2016-03-03 00:00:00&#x27;</span>),(<span class="number">206</span>,<span class="string">&#x27;William&#x27;</span>,<span class="string">&#x27;Gietz&#x27;</span>,<span class="string">&#x27;WGIETZ&#x27;</span>,<span class="string">&#x27;515.123.8181&#x27;</span>,<span class="string">&#x27;AC_ACCOUNT&#x27;</span>,<span class="number">8300.00</span>,<span class="keyword">NULL</span>,<span class="number">205</span>,<span class="number">110</span>,<span class="string">&#x27;2016-03-03 00:00:00&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Table structure for table `jobs` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `jobs`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `jobs` (</span><br><span class="line">  `job_id` <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `job_title` <span class="type">varchar</span>(<span class="number">35</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `min_salary` <span class="type">int</span>(<span class="number">6</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `max_salary` <span class="type">int</span>(<span class="number">6</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`job_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>gb2312;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Data for the table `jobs` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> `jobs`(`job_id`,`job_title`,`min_salary`,`max_salary`) <span class="keyword">values</span> (<span class="string">&#x27;AC_ACCOUNT&#x27;</span>,<span class="string">&#x27;Public Accountant&#x27;</span>,<span class="number">4200</span>,<span class="number">9000</span>),(<span class="string">&#x27;AC_MGR&#x27;</span>,<span class="string">&#x27;Accounting Manager&#x27;</span>,<span class="number">8200</span>,<span class="number">16000</span>),(<span class="string">&#x27;AD_ASST&#x27;</span>,<span class="string">&#x27;Administration Assistant&#x27;</span>,<span class="number">3000</span>,<span class="number">6000</span>),(<span class="string">&#x27;AD_PRES&#x27;</span>,<span class="string">&#x27;President&#x27;</span>,<span class="number">20000</span>,<span class="number">40000</span>),(<span class="string">&#x27;AD_VP&#x27;</span>,<span class="string">&#x27;Administration Vice President&#x27;</span>,<span class="number">15000</span>,<span class="number">30000</span>),(<span class="string">&#x27;FI_ACCOUNT&#x27;</span>,<span class="string">&#x27;Accountant&#x27;</span>,<span class="number">4200</span>,<span class="number">9000</span>),(<span class="string">&#x27;FI_MGR&#x27;</span>,<span class="string">&#x27;Finance Manager&#x27;</span>,<span class="number">8200</span>,<span class="number">16000</span>),(<span class="string">&#x27;HR_REP&#x27;</span>,<span class="string">&#x27;Human Resources Representative&#x27;</span>,<span class="number">4000</span>,<span class="number">9000</span>),(<span class="string">&#x27;IT_PROG&#x27;</span>,<span class="string">&#x27;Programmer&#x27;</span>,<span class="number">4000</span>,<span class="number">10000</span>),(<span class="string">&#x27;MK_MAN&#x27;</span>,<span class="string">&#x27;Marketing Manager&#x27;</span>,<span class="number">9000</span>,<span class="number">15000</span>),(<span class="string">&#x27;MK_REP&#x27;</span>,<span class="string">&#x27;Marketing Representative&#x27;</span>,<span class="number">4000</span>,<span class="number">9000</span>),(<span class="string">&#x27;PR_REP&#x27;</span>,<span class="string">&#x27;Public Relations Representative&#x27;</span>,<span class="number">4500</span>,<span class="number">10500</span>),(<span class="string">&#x27;PU_CLERK&#x27;</span>,<span class="string">&#x27;Purchasing Clerk&#x27;</span>,<span class="number">2500</span>,<span class="number">5500</span>),(<span class="string">&#x27;PU_MAN&#x27;</span>,<span class="string">&#x27;Purchasing Manager&#x27;</span>,<span class="number">8000</span>,<span class="number">15000</span>),(<span class="string">&#x27;SA_MAN&#x27;</span>,<span class="string">&#x27;Sales Manager&#x27;</span>,<span class="number">10000</span>,<span class="number">20000</span>),(<span class="string">&#x27;SA_REP&#x27;</span>,<span class="string">&#x27;Sales Representative&#x27;</span>,<span class="number">6000</span>,<span class="number">12000</span>),(<span class="string">&#x27;SH_CLERK&#x27;</span>,<span class="string">&#x27;Shipping Clerk&#x27;</span>,<span class="number">2500</span>,<span class="number">5500</span>),(<span class="string">&#x27;ST_CLERK&#x27;</span>,<span class="string">&#x27;Stock Clerk&#x27;</span>,<span class="number">2000</span>,<span class="number">5000</span>),(<span class="string">&#x27;ST_MAN&#x27;</span>,<span class="string">&#x27;Stock Manager&#x27;</span>,<span class="number">5500</span>,<span class="number">8500</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Table structure for table `locations` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `locations`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `locations` (</span><br><span class="line">  `location_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `street_address` <span class="type">varchar</span>(<span class="number">40</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `postal_code` <span class="type">varchar</span>(<span class="number">12</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `city` <span class="type">varchar</span>(<span class="number">30</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `state_province` <span class="type">varchar</span>(<span class="number">25</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `country_id` <span class="type">varchar</span>(<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`location_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">3201</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>gb2312;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Data for the table `locations` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> `locations`(`location_id`,`street_address`,`postal_code`,`city`,`state_province`,`country_id`) <span class="keyword">values</span> (<span class="number">1000</span>,<span class="string">&#x27;1297 Via Cola di Rie&#x27;</span>,<span class="string">&#x27;00989&#x27;</span>,<span class="string">&#x27;Roma&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;IT&#x27;</span>),(<span class="number">1100</span>,<span class="string">&#x27;93091 Calle della Testa&#x27;</span>,<span class="string">&#x27;10934&#x27;</span>,<span class="string">&#x27;Venice&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;IT&#x27;</span>),(<span class="number">1200</span>,<span class="string">&#x27;2017 Shinjuku-ku&#x27;</span>,<span class="string">&#x27;1689&#x27;</span>,<span class="string">&#x27;Tokyo&#x27;</span>,<span class="string">&#x27;Tokyo Prefecture&#x27;</span>,<span class="string">&#x27;JP&#x27;</span>),(<span class="number">1300</span>,<span class="string">&#x27;9450 Kamiya-cho&#x27;</span>,<span class="string">&#x27;6823&#x27;</span>,<span class="string">&#x27;Hiroshima&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;JP&#x27;</span>),(<span class="number">1400</span>,<span class="string">&#x27;2014 Jabberwocky Rd&#x27;</span>,<span class="string">&#x27;26192&#x27;</span>,<span class="string">&#x27;Southlake&#x27;</span>,<span class="string">&#x27;Texas&#x27;</span>,<span class="string">&#x27;US&#x27;</span>),(<span class="number">1500</span>,<span class="string">&#x27;2011 Interiors Blvd&#x27;</span>,<span class="string">&#x27;99236&#x27;</span>,<span class="string">&#x27;South San Francisco&#x27;</span>,<span class="string">&#x27;California&#x27;</span>,<span class="string">&#x27;US&#x27;</span>),(<span class="number">1600</span>,<span class="string">&#x27;2007 Zagora St&#x27;</span>,<span class="string">&#x27;50090&#x27;</span>,<span class="string">&#x27;South Brunswick&#x27;</span>,<span class="string">&#x27;New Jersey&#x27;</span>,<span class="string">&#x27;US&#x27;</span>),(<span class="number">1700</span>,<span class="string">&#x27;2004 Charade Rd&#x27;</span>,<span class="string">&#x27;98199&#x27;</span>,<span class="string">&#x27;Seattle&#x27;</span>,<span class="string">&#x27;Washington&#x27;</span>,<span class="string">&#x27;US&#x27;</span>),(<span class="number">1800</span>,<span class="string">&#x27;147 Spadina Ave&#x27;</span>,<span class="string">&#x27;M5V 2L7&#x27;</span>,<span class="string">&#x27;Toronto&#x27;</span>,<span class="string">&#x27;Ontario&#x27;</span>,<span class="string">&#x27;CA&#x27;</span>),(<span class="number">1900</span>,<span class="string">&#x27;6092 Boxwood St&#x27;</span>,<span class="string">&#x27;YSW 9T2&#x27;</span>,<span class="string">&#x27;Whitehorse&#x27;</span>,<span class="string">&#x27;Yukon&#x27;</span>,<span class="string">&#x27;CA&#x27;</span>),(<span class="number">2000</span>,<span class="string">&#x27;40-5-12 Laogianggen&#x27;</span>,<span class="string">&#x27;190518&#x27;</span>,<span class="string">&#x27;Beijing&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;CN&#x27;</span>),(<span class="number">2100</span>,<span class="string">&#x27;1298 Vileparle (E)&#x27;</span>,<span class="string">&#x27;490231&#x27;</span>,<span class="string">&#x27;Bombay&#x27;</span>,<span class="string">&#x27;Maharashtra&#x27;</span>,<span class="string">&#x27;IN&#x27;</span>),(<span class="number">2200</span>,<span class="string">&#x27;12-98 Victoria Street&#x27;</span>,<span class="string">&#x27;2901&#x27;</span>,<span class="string">&#x27;Sydney&#x27;</span>,<span class="string">&#x27;New South Wales&#x27;</span>,<span class="string">&#x27;AU&#x27;</span>),(<span class="number">2300</span>,<span class="string">&#x27;198 Clementi North&#x27;</span>,<span class="string">&#x27;540198&#x27;</span>,<span class="string">&#x27;Singapore&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;SG&#x27;</span>),(<span class="number">2400</span>,<span class="string">&#x27;8204 Arthur St&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;London&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;UK&#x27;</span>),(<span class="number">2500</span>,<span class="string">&#x27;Magdalen Centre, The Oxford Science Park&#x27;</span>,<span class="string">&#x27;OX9 9ZB&#x27;</span>,<span class="string">&#x27;Oxford&#x27;</span>,<span class="string">&#x27;Oxford&#x27;</span>,<span class="string">&#x27;UK&#x27;</span>),(<span class="number">2600</span>,<span class="string">&#x27;9702 Chester Road&#x27;</span>,<span class="string">&#x27;09629850293&#x27;</span>,<span class="string">&#x27;Stretford&#x27;</span>,<span class="string">&#x27;Manchester&#x27;</span>,<span class="string">&#x27;UK&#x27;</span>),(<span class="number">2700</span>,<span class="string">&#x27;Schwanthalerstr. 7031&#x27;</span>,<span class="string">&#x27;80925&#x27;</span>,<span class="string">&#x27;Munich&#x27;</span>,<span class="string">&#x27;Bavaria&#x27;</span>,<span class="string">&#x27;DE&#x27;</span>),(<span class="number">2800</span>,<span class="string">&#x27;Rua Frei Caneca 1360 &#x27;</span>,<span class="string">&#x27;01307-002&#x27;</span>,<span class="string">&#x27;Sao Paulo&#x27;</span>,<span class="string">&#x27;Sao Paulo&#x27;</span>,<span class="string">&#x27;BR&#x27;</span>),(<span class="number">2900</span>,<span class="string">&#x27;20 Rue des Corps-Saints&#x27;</span>,<span class="string">&#x27;1730&#x27;</span>,<span class="string">&#x27;Geneva&#x27;</span>,<span class="string">&#x27;Geneve&#x27;</span>,<span class="string">&#x27;CH&#x27;</span>),(<span class="number">3000</span>,<span class="string">&#x27;Murtenstrasse 921&#x27;</span>,<span class="string">&#x27;3095&#x27;</span>,<span class="string">&#x27;Bern&#x27;</span>,<span class="string">&#x27;BE&#x27;</span>,<span class="string">&#x27;CH&#x27;</span>),(<span class="number">3100</span>,<span class="string">&#x27;Pieter Breughelstraat 837&#x27;</span>,<span class="string">&#x27;3029SK&#x27;</span>,<span class="string">&#x27;Utrecht&#x27;</span>,<span class="string">&#x27;Utrecht&#x27;</span>,<span class="string">&#x27;NL&#x27;</span>),(<span class="number">3200</span>,<span class="string">&#x27;Mariano Escobedo 9991&#x27;</span>,<span class="string">&#x27;11932&#x27;</span>,<span class="string">&#x27;Mexico City&#x27;</span>,<span class="string">&#x27;Distrito Federal,&#x27;</span>,<span class="string">&#x27;MX&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */</span>;</span><br><span class="line"><span class="comment">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">select 查询列表 from 表名;</span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment">1、查询列表可以是：表中的字段、常量值、表达式、函数</span></span><br><span class="line"><span class="comment">2、查询的结果是一个虚拟的表格</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">USE myemployees;</span><br><span class="line"></span><br><span class="line">#<span class="number">1.</span>查询表中的单个字段</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>查询表中的多个字段</span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,email <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>查询表中的所有字段</span><br><span class="line"></span><br><span class="line">#方式一：</span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    `employee_id`,</span><br><span class="line">    `first_name`,</span><br><span class="line">    `last_name`,</span><br><span class="line">    `phone_number`,</span><br><span class="line">    `last_name`,</span><br><span class="line">    `job_id`,</span><br><span class="line">    `phone_number`,</span><br><span class="line">    `job_id`,</span><br><span class="line">    `salary`,</span><br><span class="line">    `commission_pct`,</span><br><span class="line">    `manager_id`,</span><br><span class="line">    `department_id`,</span><br><span class="line">    `hiredate` </span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    employees ;</span><br><span class="line">#方式二：  </span><br><span class="line"> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees;</span><br><span class="line"> </span><br><span class="line"> #<span class="number">4.</span>查询常量值</span><br><span class="line"> <span class="keyword">SELECT</span> <span class="number">100</span>;</span><br><span class="line"> <span class="keyword">SELECT</span> <span class="string">&#x27;john&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"> #<span class="number">5.</span>查询表达式</span><br><span class="line"> <span class="keyword">SELECT</span> <span class="number">100</span><span class="operator">%</span><span class="number">98</span>;</span><br><span class="line"> </span><br><span class="line"> #<span class="number">6.</span>查询函数</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">SELECT</span> VERSION();</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> #<span class="number">7.</span>起别名</span><br><span class="line"> <span class="comment">/*</span></span><br><span class="line"><span class="comment"> ①便于理解</span></span><br><span class="line"><span class="comment"> ②如果要查询的字段有重名的情况，使用别名可以区分开来</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> #方式一：使用<span class="keyword">as</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">100</span><span class="operator">%</span><span class="number">98</span> <span class="keyword">AS</span> 结果;</span><br><span class="line"><span class="keyword">SELECT</span> last_name <span class="keyword">AS</span> 姓,first_name <span class="keyword">AS</span> 名 <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">#方式二：使用空格</span><br><span class="line"><span class="keyword">SELECT</span> last_name 姓,first_name 名 <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例：查询salary，显示结果为 <span class="keyword">out</span> put</span><br><span class="line"><span class="keyword">SELECT</span> salary <span class="keyword">AS</span> &quot;out put&quot; <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">8.</span>去重</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例：查询员工表中涉及到的所有的部门编号</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> department_id <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">9.</span><span class="operator">+</span>号的作用</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">java中的+号：</span></span><br><span class="line"><span class="comment">①运算符，两个操作数都为数值型</span></span><br><span class="line"><span class="comment">②连接符，只要有一个操作数为字符串</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">mysql中的+号：</span></span><br><span class="line"><span class="comment">仅仅只有一个功能：运算符</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">select 100+90; 两个操作数都为数值型，则做加法运算</span></span><br><span class="line"><span class="comment">select &#x27;123&#x27;+90;只要其中一方为字符型，试图将字符型数值转换成数值型</span></span><br><span class="line"><span class="comment">			如果转换成功，则继续做加法运算</span></span><br><span class="line"><span class="comment">select &#x27;john&#x27;+90;	如果转换失败，则将字符型数值转换成0</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">select null+10; 只要其中一方为null，则结果肯定为null</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#案例：查询员工名和姓连接成一个字段，并显示为 姓名</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>) <span class="keyword">AS</span> 结果;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">	CONCAT(last_name,first_name) <span class="keyword">AS</span> 姓名</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees;</span><br><span class="line"></span><br><span class="line">显示出表employees的全部列，各个列之间用逗号连接，列头显示成OUT_PUT</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">	IFNULL(commission_pct,<span class="number">0</span>) <span class="keyword">AS</span> 奖金率,</span><br><span class="line">	commission_pct</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">	employees;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">#<span class="comment">-------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	CONCAT(`first_name`,<span class="string">&#x27;,&#x27;</span>,`last_name`,<span class="string">&#x27;,&#x27;</span>,`job_id`,<span class="string">&#x27;,&#x27;</span>,IFNULL(commission_pct,<span class="number">0</span>)) <span class="keyword">AS</span> out_put</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees;</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121</span></span><br></pre></td></tr></table></figure>

<h5 id="1-5-1-基础查询案例"><a href="#1-5-1-基础查询案例" class="headerlink" title="1.5.1 基础查询案例"></a>1.5.1 基础查询案例</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1.</span>	下面的语句是否可以执行成功  </span><br><span class="line"><span class="keyword">SELECT</span> last_name , job_id , salary <span class="keyword">AS</span> sal</span><br><span class="line"><span class="keyword">FROM</span> employees; </span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>下面的语句是否可以执行成功  </span><br><span class="line"><span class="keyword">SELECT</span>  <span class="operator">*</span>  <span class="keyword">FROM</span> employees; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>找出下面语句中的错误 </span><br><span class="line"><span class="keyword">SELECT</span> employee_id , last_name,</span><br><span class="line">salary <span class="operator">*</span> <span class="number">12</span> <span class="keyword">AS</span> &quot;ANNUAL  SALARY&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>显示表departments的结构，并查询其中的全部数据</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> departments;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> `departments`;</span><br><span class="line"></span><br><span class="line">#<span class="number">5.</span>显示出表employees中的全部job_id（不能重复）</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> job_id <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">#<span class="number">6.</span>显示出表employees的全部列，各个列之间用逗号连接，列头显示成OUT_PUT</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">	IFNULL(commission_pct,<span class="number">0</span>) <span class="keyword">AS</span> 奖金率,</span><br><span class="line">	commission_pct</span><br><span class="line"><span class="keyword">FROM</span> </span><br><span class="line">	employees;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">#<span class="comment">-------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	CONCAT(`first_name`,<span class="string">&#x27;,&#x27;</span>,`last_name`,<span class="string">&#x27;,&#x27;</span>,`job_id`,<span class="string">&#x27;,&#x27;</span>,IFNULL(commission_pct,<span class="number">0</span>)) <span class="keyword">AS</span> out_put</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees;```</span><br><span class="line"><span class="number">1234567891011121314151617181920212223242526272829303132333435363738</span></span><br></pre></td></tr></table></figure>

<h4 id="1-6-条件查询"><a href="#1-6-条件查询" class="headerlink" title="1.6 条件查询"></a>1.6 条件查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">	select </span></span><br><span class="line"><span class="comment">		查询列表</span></span><br><span class="line"><span class="comment">	from</span></span><br><span class="line"><span class="comment">		表名</span></span><br><span class="line"><span class="comment">	where</span></span><br><span class="line"><span class="comment">		筛选条件;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">分类：</span></span><br><span class="line"><span class="comment">	一、按条件表达式筛选</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	简单条件运算符：&gt; &lt; = != &lt;&gt; &gt;= &lt;=</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	二、按逻辑表达式筛选</span></span><br><span class="line"><span class="comment">	逻辑运算符：</span></span><br><span class="line"><span class="comment">	作用：用于连接条件表达式</span></span><br><span class="line"><span class="comment">		&amp;&amp; || !</span></span><br><span class="line"><span class="comment">		and or not</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">	&amp;&amp;和and：两个条件都为true，结果为true，反之为false</span></span><br><span class="line"><span class="comment">	||或or： 只要有一个条件为true，结果为true，反之为false</span></span><br><span class="line"><span class="comment">	!或not： 如果连接的条件本身为false，结果为true，反之为false</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	三、模糊查询</span></span><br><span class="line"><span class="comment">		like</span></span><br><span class="line"><span class="comment">		between and</span></span><br><span class="line"><span class="comment">		in</span></span><br><span class="line"><span class="comment">		is null</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#一、按条件表达式筛选</span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：查询工资<span class="operator">&gt;</span><span class="number">12000</span>的员工信息</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">	<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	salary<span class="operator">&gt;</span><span class="number">12000</span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">#案例<span class="number">2</span>：查询部门编号不等于<span class="number">90</span>号的员工名和部门编号</span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">	last_name,</span><br><span class="line">	department_id</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	department_id<span class="operator">&lt;&gt;</span><span class="number">90</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#二、按逻辑表达式筛选</span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：查询工资z在<span class="number">10000</span>到<span class="number">20000</span>之间的员工名、工资以及奖金</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	last_name,</span><br><span class="line">	salary,</span><br><span class="line">	commission_pct</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	salary<span class="operator">&gt;=</span><span class="number">10000</span> <span class="keyword">AND</span> salary<span class="operator">&lt;=</span><span class="number">20000</span>;</span><br><span class="line">#案例<span class="number">2</span>：查询部门编号不是在<span class="number">90</span>到<span class="number">110</span>之间，或者工资高于<span class="number">15000</span>的员工信息</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	<span class="keyword">NOT</span>(department_id<span class="operator">&gt;=</span><span class="number">90</span> <span class="keyword">AND</span>  department_id<span class="operator">&lt;=</span><span class="number">110</span>) <span class="keyword">OR</span> salary<span class="operator">&gt;</span><span class="number">15000</span>;</span><br><span class="line">#三、模糊查询</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">like	</span></span><br><span class="line"><span class="comment">between and</span></span><br><span class="line"><span class="comment">in</span></span><br><span class="line"><span class="comment">is null|is not null</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#<span class="number">1.</span><span class="keyword">like</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment">①一般和通配符搭配使用</span></span><br><span class="line"><span class="comment">	通配符：</span></span><br><span class="line"><span class="comment">	% 任意多个字符,包含0个字符</span></span><br><span class="line"><span class="comment">	_ 任意单个字符</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#案例1：查询员工名中包含字符a的员工信息</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">select </span></span><br><span class="line"><span class="comment">	*</span></span><br><span class="line"><span class="comment">from</span></span><br><span class="line"><span class="comment">	employees</span></span><br><span class="line"><span class="comment">where</span></span><br><span class="line"><span class="comment">	last_name like &#x27;%a%&#x27;;</span></span><br><span class="line"><span class="comment">#案例2：查询员工名中第三个字符为e，第五个字符为a的员工名和工资</span></span><br><span class="line"><span class="comment">select</span></span><br><span class="line"><span class="comment">	last_name,</span></span><br><span class="line"><span class="comment">	salary</span></span><br><span class="line"><span class="comment">FROM</span></span><br><span class="line"><span class="comment">	employees</span></span><br><span class="line"><span class="comment">WHERE</span></span><br><span class="line"><span class="comment">	last_name LIKE &#x27;__e_a%&#x27;;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">#案例3：查询员工名中第二个字符为_的员工名</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">SELECT</span></span><br><span class="line"><span class="comment">	last_name</span></span><br><span class="line"><span class="comment">FROM</span></span><br><span class="line"><span class="comment">	employees</span></span><br><span class="line"><span class="comment">WHERE</span></span><br><span class="line"><span class="comment">	last_name LIKE &#x27;_$_%&#x27; ESCAPE &#x27;$&#x27;;</span></span><br><span class="line"><span class="comment">#2.between and</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">①使用between and 可以提高语句的简洁度</span></span><br><span class="line"><span class="comment">②包含临界值</span></span><br><span class="line"><span class="comment">③两个临界值不要调换顺序</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：查询员工编号在<span class="number">100</span>到<span class="number">120</span>之间的员工信息</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	employee_id <span class="operator">&gt;=</span> <span class="number">120</span> <span class="keyword">AND</span> employee_id<span class="operator">&lt;=</span><span class="number">100</span>;</span><br><span class="line">#<span class="comment">----------------------</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	employee_id <span class="keyword">BETWEEN</span> <span class="number">120</span> <span class="keyword">AND</span> <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span><span class="keyword">in</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">含义：判断某字段的值是否属于in列表中的某一项</span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment">	①使用in提高语句简洁度</span></span><br><span class="line"><span class="comment">	②in列表的值类型必须一致或兼容</span></span><br><span class="line"><span class="comment">	③in列表中不支持通配符</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#案例：查询员工的工种编号是 IT_PROG、AD_VP、AD_PRES中的一个员工名和工种编号</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	last_name,</span><br><span class="line">	job_id</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	job_id <span class="operator">=</span> <span class="string">&#x27;IT_PROT&#x27;</span> <span class="keyword">OR</span> job_id <span class="operator">=</span> <span class="string">&#x27;AD_VP&#x27;</span> <span class="keyword">OR</span> job_id  <span class="operator">=</span><span class="string">&#x27;AD_PRES&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="comment">------------------</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	last_name,</span><br><span class="line">	job_id</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	job_id <span class="keyword">IN</span>( <span class="string">&#x27;IT_PROT&#x27;</span> ,<span class="string">&#x27;AD_VP&#x27;</span>,<span class="string">&#x27;AD_PRES&#x27;</span>);</span><br><span class="line"></span><br><span class="line">#<span class="number">4</span>、<span class="keyword">is</span> <span class="keyword">null</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">=或&lt;&gt;不能用于判断null值</span></span><br><span class="line"><span class="comment">is null或is not null 可以判断null值</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：查询没有奖金的员工名和奖金率</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	last_name,</span><br><span class="line">	commission_pct</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	commission_pct <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：查询有奖金的员工名和奖金率</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	last_name,</span><br><span class="line">	commission_pct</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">#<span class="comment">----------以下为×</span></span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	last_name,</span><br><span class="line">	commission_pct</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"></span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">	salary <span class="keyword">IS</span> <span class="number">12000</span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">#安全等于  <span class="operator">&lt;=&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：查询没有奖金的员工名和奖金率</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	last_name,</span><br><span class="line">	commission_pct</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"><span class="keyword">WHERE</span></span><br><span class="line">	commission_pct <span class="operator">&lt;=&gt;</span><span class="keyword">NULL</span>;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">#案例<span class="number">2</span>：查询工资为<span class="number">12000</span>的员工信息</span><br><span class="line"><span class="keyword">SELECT</span></span><br><span class="line">	last_name,</span><br><span class="line">	salary</span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">	employees</span><br><span class="line"></span><br><span class="line"><span class="keyword">WHERE</span> </span><br><span class="line">	salary <span class="operator">&lt;=&gt;</span> <span class="number">12000</span>;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">#<span class="keyword">is</span> <span class="keyword">null</span> pk <span class="operator">&lt;=&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">IS</span> <span class="keyword">NULL</span>:仅仅可以判断<span class="keyword">NULL</span>值，可读性较高，建议使用</span><br><span class="line"><span class="operator">&lt;=&gt;</span>    :既可以判断<span class="keyword">NULL</span>值，又可以判断普通的数值，可读性较低</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240</span></span><br></pre></td></tr></table></figure>

<h4 id="1-7-排序查询"><a href="#1-7-排序查询" class="headerlink" title="1.7 排序查询"></a>1.7 排序查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">select 查询列表</span></span><br><span class="line"><span class="comment">from 表名</span></span><br><span class="line"><span class="comment">【where  筛选条件】</span></span><br><span class="line"><span class="comment">order by 排序的字段或表达式;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment">1、asc代表的是升序，可以省略(ascend)</span></span><br><span class="line"><span class="comment">desc代表的是降序(descend)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2、order by子句可以支持 单个字段、别名、表达式、函数、多个字段</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">3、order by子句在查询语句的最后面，除了limit子句</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#<span class="number">1</span>、按单个字段排序</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">2</span>、添加筛选条件再排序</span><br><span class="line"></span><br><span class="line">#案例：查询部门编号<span class="operator">&gt;=</span><span class="number">90</span>的员工信息，并按员工编号降序</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id<span class="operator">&gt;=</span><span class="number">90</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> employee_id <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3</span>、按表达式排序</span><br><span class="line">#案例：查询员工信息 按年薪降序</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>,salary<span class="operator">*</span><span class="number">12</span><span class="operator">*</span>(<span class="number">1</span><span class="operator">+</span>IFNULL(commission_pct,<span class="number">0</span>))</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary<span class="operator">*</span><span class="number">12</span><span class="operator">*</span>(<span class="number">1</span><span class="operator">+</span>IFNULL(commission_pct,<span class="number">0</span>)) <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4</span>、按别名排序</span><br><span class="line">#案例：查询员工信息 按年薪升序</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>,salary<span class="operator">*</span><span class="number">12</span><span class="operator">*</span>(<span class="number">1</span><span class="operator">+</span>IFNULL(commission_pct,<span class="number">0</span>)) 年薪</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 年薪 <span class="keyword">ASC</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">5</span>、按函数排序</span><br><span class="line">#案例：查询员工名，并且按名字的长度降序</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> LENGTH(last_name),last_name </span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> LENGTH(last_name) <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">6</span>、按多个字段排序</span><br><span class="line"></span><br><span class="line">#案例：查询员工信息，要求先按工资降序，再按employee_id升序</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>,employee_id <span class="keyword">ASC</span>;</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960</span></span><br></pre></td></tr></table></figure>

<h5 id="1-7-1-案例排序查询"><a href="#1-7-1-案例排序查询" class="headerlink" title="1.7.1 案例排序查询"></a>1.7.1 案例排序查询</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1.</span>查询员工的姓名和部门号和年薪，按年薪降序 按姓名升序</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_id,salary<span class="operator">*</span><span class="number">12</span><span class="operator">*</span>(<span class="number">1</span><span class="operator">+</span>IFNULL(commission_pct,<span class="number">0</span>)) 年薪</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 年薪 <span class="keyword">DESC</span>,last_name <span class="keyword">ASC</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>选择工资不在<span class="number">8000</span>到<span class="number">17000</span>的员工的姓名和工资，按工资降序</span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="keyword">NOT</span> <span class="keyword">BETWEEN</span> <span class="number">8000</span> <span class="keyword">AND</span> <span class="number">17000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>查询邮箱中包含e的员工信息，并先按邮箱的字节数降序，再按部门号升序</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span>,LENGTH(email)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> email <span class="keyword">LIKE</span> <span class="string">&#x27;%e%&#x27;</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> LENGTH(email) <span class="keyword">DESC</span>,department_id <span class="keyword">ASC</span>;</span><br><span class="line">	</span><br><span class="line"><span class="number">123456789101112131415161718192021</span></span><br></pre></td></tr></table></figure>

<h4 id="1-8-常见函数"><a href="#1-8-常见函数" class="headerlink" title="1.8 常见函数"></a>1.8 常见函数</h4><h5 id="1-8-1-单行函数"><a href="#1-8-1-单行函数" class="headerlink" title="1.8.1 单行函数"></a>1.8.1 单行函数</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">概念：类似于java的方法，将一组逻辑语句封装在方法体中，对外暴露方法名</span></span><br><span class="line"><span class="comment">好处：1、隐藏了实现细节  2、提高代码的重用性</span></span><br><span class="line"><span class="comment">调用：select 函数名(实参列表) 【from 表】;</span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment">	①叫什么（函数名）</span></span><br><span class="line"><span class="comment">	②干什么（函数功能）</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">分类：</span></span><br><span class="line"><span class="comment">	1、单行函数</span></span><br><span class="line"><span class="comment">	如 concat、length、ifnull等</span></span><br><span class="line"><span class="comment">	2、分组函数</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	功能：做统计使用，又称为统计函数、聚合函数、组函数</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">常见函数：</span></span><br><span class="line"><span class="comment">	一、单行函数</span></span><br><span class="line"><span class="comment">	字符函数：</span></span><br><span class="line"><span class="comment">	length:获取字节个数(utf-8一个汉字代表3个字节,gbk为2个字节)</span></span><br><span class="line"><span class="comment">	concat</span></span><br><span class="line"><span class="comment">	substr</span></span><br><span class="line"><span class="comment">	instr</span></span><br><span class="line"><span class="comment">	trim</span></span><br><span class="line"><span class="comment">	upper</span></span><br><span class="line"><span class="comment">	lower</span></span><br><span class="line"><span class="comment">	lpad</span></span><br><span class="line"><span class="comment">	rpad</span></span><br><span class="line"><span class="comment">	replace</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	数学函数：</span></span><br><span class="line"><span class="comment">	round</span></span><br><span class="line"><span class="comment">	ceil</span></span><br><span class="line"><span class="comment">	floor</span></span><br><span class="line"><span class="comment">	truncate</span></span><br><span class="line"><span class="comment">	mod</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	日期函数：</span></span><br><span class="line"><span class="comment">	now</span></span><br><span class="line"><span class="comment">	curdate</span></span><br><span class="line"><span class="comment">	curtime</span></span><br><span class="line"><span class="comment">	year</span></span><br><span class="line"><span class="comment">	month</span></span><br><span class="line"><span class="comment">	monthname</span></span><br><span class="line"><span class="comment">	day</span></span><br><span class="line"><span class="comment">	hour</span></span><br><span class="line"><span class="comment">	minute</span></span><br><span class="line"><span class="comment">	second</span></span><br><span class="line"><span class="comment">	str_to_date</span></span><br><span class="line"><span class="comment">	date_format</span></span><br><span class="line"><span class="comment">	其他函数：</span></span><br><span class="line"><span class="comment">	version</span></span><br><span class="line"><span class="comment">	database</span></span><br><span class="line"><span class="comment">	user</span></span><br><span class="line"><span class="comment">	控制函数</span></span><br><span class="line"><span class="comment">	if</span></span><br><span class="line"><span class="comment">	case</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#一、字符函数</span><br><span class="line"></span><br><span class="line">#<span class="number">1.</span>length 获取参数值的字节个数</span><br><span class="line"><span class="keyword">SELECT</span> LENGTH(<span class="string">&#x27;john&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> LENGTH(<span class="string">&#x27;张三丰hahaha&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;%char%&#x27;</span></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>concat 拼接字符串</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(last_name,<span class="string">&#x27;_&#x27;</span>,first_name) 姓名 <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>upper、lower</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">UPPER</span>(<span class="string">&#x27;john&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">LOWER</span>(<span class="string">&#x27;joHn&#x27;</span>);</span><br><span class="line">#示例：将姓变大写，名变小写，然后拼接</span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="built_in">UPPER</span>(last_name),<span class="built_in">LOWER</span>(first_name))  姓名 <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>substr、substring</span><br><span class="line">注意：索引从<span class="number">1</span>开始</span><br><span class="line">#截取从指定索引处后面所有字符</span><br><span class="line"><span class="keyword">SELECT</span> SUBSTR(<span class="string">&#x27;李莫愁爱上了陆展元&#x27;</span>,<span class="number">7</span>)  out_put;</span><br><span class="line"></span><br><span class="line">#截取从指定索引处指定字符长度的字符</span><br><span class="line"><span class="keyword">SELECT</span> SUBSTR(<span class="string">&#x27;李莫愁爱上了陆展元&#x27;</span>,<span class="number">1</span>,<span class="number">3</span>) out_put;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例：姓名中首字符大写，其他字符小写然后用_拼接，显示出来</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(<span class="built_in">UPPER</span>(SUBSTR(last_name,<span class="number">1</span>,<span class="number">1</span>)),<span class="string">&#x27;_&#x27;</span>,<span class="built_in">LOWER</span>(SUBSTR(last_name,<span class="number">2</span>)))  out_put</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">#<span class="number">5.</span>instr 返回子串第一次出现的索引，如果找不到返回<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> INSTR(<span class="string">&#x27;杨不殷六侠悔爱上了殷六侠&#x27;</span>,<span class="string">&#x27;殷八侠&#x27;</span>) <span class="keyword">AS</span> out_put;</span><br><span class="line"></span><br><span class="line">#<span class="number">6.</span>trim</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> LENGTH(<span class="built_in">TRIM</span>(<span class="string">&#x27;    张翠山    &#x27;</span>)) <span class="keyword">AS</span> out_put;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">TRIM</span>(<span class="string">&#x27;aa&#x27;</span> <span class="keyword">FROM</span> <span class="string">&#x27;aaaaaaaaa张aaaaaaaaaaaa翠山aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&#x27;</span>)  <span class="keyword">AS</span> out_put;</span><br><span class="line"></span><br><span class="line">#<span class="number">7.</span>lpad 用指定的字符实现左填充指定长度</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> LPAD(<span class="string">&#x27;殷素素&#x27;</span>,<span class="number">2</span>,<span class="string">&#x27;*&#x27;</span>) <span class="keyword">AS</span> out_put;</span><br><span class="line"></span><br><span class="line">#<span class="number">8.</span>rpad 用指定的字符实现右填充指定长度</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> RPAD(<span class="string">&#x27;殷素素&#x27;</span>,<span class="number">12</span>,<span class="string">&#x27;ab&#x27;</span>) <span class="keyword">AS</span> out_put;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">9.</span>replace 替换</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> REPLACE(<span class="string">&#x27;周芷若周芷若周芷若周芷若张无忌爱上了周芷若&#x27;</span>,<span class="string">&#x27;周芷若&#x27;</span>,<span class="string">&#x27;赵敏&#x27;</span>) <span class="keyword">AS</span> out_put;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#二、数学函数</span><br><span class="line"></span><br><span class="line">#round 四舍五入</span><br><span class="line"><span class="keyword">SELECT</span> ROUND(<span class="number">-1.55</span>);</span><br><span class="line"><span class="keyword">SELECT</span> ROUND(<span class="number">1.567</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#ceil 向上取整,返回<span class="operator">&gt;=</span>该参数的最小整数</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">CEIL</span>(<span class="number">-1.02</span>);</span><br><span class="line"></span><br><span class="line">#floor 向下取整，返回<span class="operator">&lt;=</span>该参数的最大整数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">FLOOR</span>(<span class="number">-9.99</span>);</span><br><span class="line"></span><br><span class="line">#<span class="keyword">truncate</span> 截断</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">TRUNCATE</span>(<span class="number">1.69999</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">#mod取余</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">mod(a,b) ：  a-a/b*b</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">mod(-10,-3):-10- (-10)/(-3)*（-3）=-1</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MOD</span>(<span class="number">10</span>,<span class="number">-3</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">10</span><span class="operator">%</span><span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#三、日期函数</span><br><span class="line"></span><br><span class="line">#now 返回当前系统日期<span class="operator">+</span>时间</span><br><span class="line"><span class="keyword">SELECT</span> NOW();</span><br><span class="line"></span><br><span class="line">#curdate 返回当前系统日期，不包含时间</span><br><span class="line"><span class="keyword">SELECT</span> CURDATE();</span><br><span class="line"></span><br><span class="line">#curtime 返回当前时间，不包含日期</span><br><span class="line"><span class="keyword">SELECT</span> CURTIME();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#可以获取指定的部分，年、月、日、小时、分钟、秒</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">YEAR</span>(NOW()) 年;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">YEAR</span>(<span class="string">&#x27;1998-1-1&#x27;</span>) 年;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span>  <span class="keyword">YEAR</span>(hiredate) 年 <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MONTH</span>(NOW()) 月;</span><br><span class="line"><span class="keyword">SELECT</span> MONTHNAME(NOW()) 月;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#str_to_date 将字符通过指定的格式转换成日期</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> STR_TO_DATE(<span class="string">&#x27;1998-3-2&#x27;</span>,<span class="string">&#x27;%Y-%c-%d&#x27;</span>) <span class="keyword">AS</span> out_put;</span><br><span class="line"></span><br><span class="line">#查询入职日期为<span class="number">1992</span><span class="comment">--4-3的员工信息</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> hiredate <span class="operator">=</span> <span class="string">&#x27;1992-4-3&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> hiredate <span class="operator">=</span> STR_TO_DATE(<span class="string">&#x27;4-3 1992&#x27;</span>,<span class="string">&#x27;%c-%d %Y&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#date_format 将日期转换成字符</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> DATE_FORMAT(NOW(),<span class="string">&#x27;%y年%m月%d日&#x27;</span>) <span class="keyword">AS</span> out_put;</span><br><span class="line"></span><br><span class="line">#查询有奖金的员工名和入职日期(xx月<span class="operator">/</span>xx日 xx年)</span><br><span class="line"><span class="keyword">SELECT</span> last_name,DATE_FORMAT(hiredate,<span class="string">&#x27;%m月/%d日 %y年&#x27;</span>) 入职日期</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#四、其他函数</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> VERSION();</span><br><span class="line"><span class="keyword">SELECT</span> DATABASE();</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">USER</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#五、流程控制函数</span><br><span class="line">#<span class="number">1.</span>if函数： if <span class="keyword">else</span> 的效果</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> IF(<span class="number">10</span><span class="operator">&lt;</span><span class="number">5</span>,<span class="string">&#x27;大&#x27;</span>,<span class="string">&#x27;小&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,commission_pct,IF(commission_pct <span class="keyword">IS</span> <span class="keyword">NULL</span>,<span class="string">&#x27;没奖金，呵呵&#x27;</span>,<span class="string">&#x27;有奖金，嘻嘻&#x27;</span>) 备注</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span><span class="keyword">case</span>函数的使用一： switch <span class="keyword">case</span> 的效果</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">java中</span></span><br><span class="line"><span class="comment">switch(变量或表达式)&#123;</span></span><br><span class="line"><span class="comment">	case 常量1：语句1;break;</span></span><br><span class="line"><span class="comment">	...</span></span><br><span class="line"><span class="comment">	default:语句n;break;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">mysql中</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">case 要判断的字段或表达式</span></span><br><span class="line"><span class="comment">when 常量1 then 要显示的值1或语句1;</span></span><br><span class="line"><span class="comment">when 常量2 then 要显示的值2或语句2;</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">else 要显示的值n或语句n;</span></span><br><span class="line"><span class="comment">end</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*案例：查询员工的工资，要求</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">部门号=30，显示的工资为1.1倍</span></span><br><span class="line"><span class="comment">部门号=40，显示的工资为1.2倍</span></span><br><span class="line"><span class="comment">部门号=50，显示的工资为1.3倍</span></span><br><span class="line"><span class="comment">其他部门，显示的工资为原工资</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> salary 原始工资,department_id,</span><br><span class="line"><span class="keyword">CASE</span> department_id</span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">30</span> <span class="keyword">THEN</span> salary<span class="operator">*</span><span class="number">1.1</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">40</span> <span class="keyword">THEN</span> salary<span class="operator">*</span><span class="number">1.2</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="number">50</span> <span class="keyword">THEN</span> salary<span class="operator">*</span><span class="number">1.3</span></span><br><span class="line"><span class="keyword">ELSE</span> salary</span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span> 新工资</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span><span class="keyword">case</span> 函数的使用二：类似于 多重if</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">java中：</span></span><br><span class="line"><span class="comment">if(条件1)&#123;</span></span><br><span class="line"><span class="comment">	语句1；</span></span><br><span class="line"><span class="comment">&#125;else if(条件2)&#123;</span></span><br><span class="line"><span class="comment">	语句2；</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">else&#123;</span></span><br><span class="line"><span class="comment">	语句n;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">mysql中：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">case </span></span><br><span class="line"><span class="comment">when 条件1 then 要显示的值1或语句1</span></span><br><span class="line"><span class="comment">when 条件2 then 要显示的值2或语句2</span></span><br><span class="line"><span class="comment">。。。</span></span><br><span class="line"><span class="comment">else 要显示的值n或语句n</span></span><br><span class="line"><span class="comment">end</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#案例：查询员工的工资的情况</span><br><span class="line">如果工资<span class="operator">&gt;</span><span class="number">20000</span>,显示A级别</span><br><span class="line">如果工资<span class="operator">&gt;</span><span class="number">15000</span>,显示B级别</span><br><span class="line">如果工资<span class="operator">&gt;</span><span class="number">10000</span>，显示C级别</span><br><span class="line">否则，显示D级别</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> salary,</span><br><span class="line"><span class="keyword">CASE</span> </span><br><span class="line"><span class="keyword">WHEN</span> salary<span class="operator">&gt;</span><span class="number">20000</span> <span class="keyword">THEN</span> <span class="string">&#x27;A&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> salary<span class="operator">&gt;</span><span class="number">15000</span> <span class="keyword">THEN</span> <span class="string">&#x27;B&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> salary<span class="operator">&gt;</span><span class="number">10000</span> <span class="keyword">THEN</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line"><span class="keyword">ELSE</span> <span class="string">&#x27;D&#x27;</span></span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span> 工资级别</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290</span></span><br></pre></td></tr></table></figure>

<h6 id="1-8-1-1-案例单行函数"><a href="#1-8-1-1-案例单行函数" class="headerlink" title="1.8.1.1 案例单行函数"></a>1.8.1.1 案例单行函数</h6><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1.</span>	显示系统时间(注：日期<span class="operator">+</span>时间)</span><br><span class="line"><span class="keyword">SELECT</span> NOW();</span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>	查询员工号，姓名，工资，以及工资提高百分之<span class="number">20</span><span class="operator">%</span>后的结果（<span class="keyword">new</span> salary）</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary,salary<span class="operator">*</span><span class="number">1.2</span> &quot;new salary&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line">#<span class="number">3.</span>	将员工的姓名按首字母排序，并写出姓名的长度（length）</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> LENGTH(last_name) 长度,SUBSTR(last_name,<span class="number">1</span>,<span class="number">1</span>) 首字符,last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> 首字符;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>	做一个查询，产生下面的结果</span><br><span class="line"><span class="operator">&lt;</span>last_name<span class="operator">&gt;</span> earns <span class="operator">&lt;</span>salary<span class="operator">&gt;</span> monthly but wants <span class="operator">&lt;</span>salary<span class="operator">*</span><span class="number">3</span><span class="operator">&gt;</span></span><br><span class="line">Dream Salary</span><br><span class="line">King earns <span class="number">24000</span> monthly but wants <span class="number">72000</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(last_name,<span class="string">&#x27; earns &#x27;</span>,salary,<span class="string">&#x27; monthly but wants &#x27;</span>,salary<span class="operator">*</span><span class="number">3</span>) <span class="keyword">AS</span> &quot;Dream Salary&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">=</span><span class="number">24000</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">5.</span>	使用<span class="keyword">case</span><span class="operator">-</span><span class="keyword">when</span>，按照下面的条件：</span><br><span class="line">job                  grade</span><br><span class="line">AD_PRES            A</span><br><span class="line">ST_MAN             B</span><br><span class="line">IT_PROG             C</span><br><span class="line">SA_REP              D</span><br><span class="line">ST_CLERK           E</span><br><span class="line">产生下面的结果</span><br><span class="line">Last_name	Job_id	Grade</span><br><span class="line">king	AD_PRES	A</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,job_id <span class="keyword">AS</span>  job,</span><br><span class="line"><span class="keyword">CASE</span> job_id</span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">&#x27;AD_PRES&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;A&#x27;</span> </span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">&#x27;ST_MAN&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;B&#x27;</span> </span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">&#x27;IT_PROG&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;C&#x27;</span> </span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">&#x27;SA_PRE&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;D&#x27;</span></span><br><span class="line"><span class="keyword">WHEN</span> <span class="string">&#x27;ST_CLERK&#x27;</span> <span class="keyword">THEN</span> <span class="string">&#x27;E&#x27;</span></span><br><span class="line"><span class="keyword">END</span> <span class="keyword">AS</span> Grade</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> job_id <span class="operator">=</span> <span class="string">&#x27;AD_PRES&#x27;</span>;</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657</span></span><br></pre></td></tr></table></figure>

<h5 id="1-8-2-分组函数"><a href="#1-8-2-分组函数" class="headerlink" title="1.8.2 分组函数"></a>1.8.2 分组函数</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">功能：用作统计使用，又称为聚合函数或统计函数或组函数</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">分类：</span></span><br><span class="line"><span class="comment">sum 求和、avg 平均值、max 最大值 、min 最小值 、count 计算个数</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment">1、sum、avg一般用于处理数值型</span></span><br><span class="line"><span class="comment">   max、min、count可以处理任何类型</span></span><br><span class="line"><span class="comment">2、以上分组函数都忽略null值</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">3、可以和distinct搭配实现去重的运算</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">4、count函数的单独介绍</span></span><br><span class="line"><span class="comment">一般使用count(*)用作统计行数</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">5、和分组函数一同查询的字段要求是group by后的字段</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">1</span>、简单 的使用</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(salary) 和,<span class="built_in">AVG</span>(salary) 平均,<span class="built_in">MAX</span>(salary) 最高,<span class="built_in">MIN</span>(salary) 最低,<span class="built_in">COUNT</span>(salary) 个数</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(salary) 和,ROUND(<span class="built_in">AVG</span>(salary),<span class="number">2</span>) 平均,<span class="built_in">MAX</span>(salary) 最高,<span class="built_in">MIN</span>(salary) 最低,<span class="built_in">COUNT</span>(salary) 个数</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">#<span class="number">2</span>、参数支持哪些类型</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(last_name) ,<span class="built_in">AVG</span>(last_name) <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(hiredate) ,<span class="built_in">AVG</span>(hiredate) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(last_name),<span class="built_in">MIN</span>(last_name) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(hiredate),<span class="built_in">MIN</span>(hiredate) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(commission_pct) <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(last_name) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">#<span class="number">3</span>、是否忽略<span class="keyword">null</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(commission_pct) ,<span class="built_in">AVG</span>(commission_pct),<span class="built_in">SUM</span>(commission_pct)<span class="operator">/</span><span class="number">35</span>,<span class="built_in">SUM</span>(commission_pct)<span class="operator">/</span><span class="number">107</span> <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(commission_pct) ,<span class="built_in">MIN</span>(commission_pct) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(commission_pct) <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="keyword">SELECT</span> commission_pct <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4</span>、和<span class="keyword">distinct</span>搭配</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">SUM</span>(<span class="keyword">DISTINCT</span> salary),<span class="built_in">SUM</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="keyword">DISTINCT</span> salary),<span class="built_in">COUNT</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">5</span>、count函数的详细介绍</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(salary) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="number">1</span>) <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">效率：</span><br><span class="line">MYISAM存储引擎下  ，<span class="built_in">COUNT</span>(<span class="operator">*</span>)的效率高</span><br><span class="line">INNODB存储引擎下，<span class="built_in">COUNT</span>(<span class="operator">*</span>)和<span class="built_in">COUNT</span>(<span class="number">1</span>)的效率差不多，比<span class="built_in">COUNT</span>(字段)要高一些</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">6</span>、和分组函数一同查询的字段有限制</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),employee_id  <span class="keyword">FROM</span> employees;</span><br><span class="line"><span class="number">12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182</span></span><br></pre></td></tr></table></figure>

<h6 id="1-8-2-1-案例分组函数"><a href="#1-8-2-1-案例分组函数" class="headerlink" title="1.8.2.1 案例分组函数"></a>1.8.2.1 案例分组函数</h6><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1.</span>查询公司员工工资的最大值，最小值，平均值，总和</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) 最大值,<span class="built_in">MIN</span>(salary) 最小值,<span class="built_in">AVG</span>(salary) 平均值,<span class="built_in">SUM</span>(salary) 和</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line">#<span class="number">2.</span>查询员工表中的最大入职时间和最小入职时间的相差天数 （DIFFRENCE）</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(hiredate) 最大,<span class="built_in">MIN</span>(hiredate) 最小,(<span class="built_in">MAX</span>(hiredate)<span class="operator">-</span><span class="built_in">MIN</span>(hiredate))<span class="operator">/</span><span class="number">1000</span><span class="operator">/</span><span class="number">3600</span><span class="operator">/</span><span class="number">24</span> DIFFRENCE</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> DATEDIFF(<span class="built_in">MAX</span>(hiredate),<span class="built_in">MIN</span>(hiredate)) DIFFRENCE</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> DATEDIFF(<span class="string">&#x27;1995-2-7&#x27;</span>,<span class="string">&#x27;1995-2-6&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>查询部门编号为<span class="number">90</span>的员工个数</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> department_id <span class="operator">=</span> <span class="number">90</span>;</span><br><span class="line"><span class="number">123456789101112131415161718</span></span><br></pre></td></tr></table></figure>

<h4 id="1-9-分组查询"><a href="#1-9-分组查询" class="headerlink" title="1.9 分组查询"></a>1.9 分组查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">select 查询列表</span></span><br><span class="line"><span class="comment">from 表</span></span><br><span class="line"><span class="comment">【where 筛选条件】</span></span><br><span class="line"><span class="comment">group by 分组的字段</span></span><br><span class="line"><span class="comment">【order by 排序的字段】;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment">1、和分组函数一同查询的字段必须是group by后出现的字段</span></span><br><span class="line"><span class="comment">2、筛选分为两类：分组前筛选和分组后筛选</span></span><br><span class="line"><span class="comment">		针对的表			位置		连接的关键字</span></span><br><span class="line"><span class="comment">分组前筛选	原始表				group by前	where</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">分组后筛选	group by后的结果集    		group by后	having</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">问题1：分组函数做筛选能不能放在where后面</span></span><br><span class="line"><span class="comment">答：不能</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">问题2：where——group by——having</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">一般来讲，能用分组前筛选的，尽量使用分组前筛选，提高效率</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">3、分组可以按单个字段也可以按多个字段</span></span><br><span class="line"><span class="comment">4、可以搭配着排序使用</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#引入：查询每个部门的员工个数</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> department_id<span class="operator">=</span><span class="number">90</span>;</span><br><span class="line">#<span class="number">1.</span>简单的分组</span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：查询每个工种的员工平均工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),job_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id;</span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：查询每个位置的部门个数</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>),location_id</span><br><span class="line"><span class="keyword">FROM</span> departments</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> location_id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2</span>、可以实现分组前的筛选</span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：查询邮箱中包含a字符的 每个部门的最高工资</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> email <span class="keyword">LIKE</span> <span class="string">&#x27;%a%&#x27;</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：查询有奖金的每个领导手下员工的平均工资</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),manager_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> manager_id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3</span>、分组后筛选</span><br><span class="line"></span><br><span class="line">#案例：查询哪个部门的员工个数<span class="operator">&gt;</span><span class="number">5</span></span><br><span class="line"></span><br><span class="line">#①查询每个部门的员工个数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id;</span><br><span class="line"></span><br><span class="line">#② 筛选刚才①结果</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"></span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：每个工种有奖金的员工的最高工资<span class="operator">&gt;</span><span class="number">12000</span>的工种编号和最高工资</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> job_id,<span class="built_in">MAX</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">MAX</span>(salary)<span class="operator">&gt;</span><span class="number">12000</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">3</span>：领导编号<span class="operator">&gt;</span><span class="number">102</span>的每个领导手下的最低工资大于<span class="number">5000</span>的领导编号和最低工资</span><br><span class="line"></span><br><span class="line">manager_id<span class="operator">&gt;</span><span class="number">102</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> manager_id,<span class="built_in">MIN</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> manager_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">MIN</span>(salary)<span class="operator">&gt;</span><span class="number">5000</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>添加排序</span><br><span class="line"></span><br><span class="line">#案例：每个工种有奖金的员工的最高工资<span class="operator">&gt;</span><span class="number">6000</span>的工种编号和最高工资,按最高工资升序</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> job_id,<span class="built_in">MAX</span>(salary) m</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line"><span class="keyword">HAVING</span> m<span class="operator">&gt;</span><span class="number">6000</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> m ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">5.</span>按多个字段分组</span><br><span class="line"></span><br><span class="line">#案例：查询每个工种每个部门的最低工资,并按最低工资降序</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary),job_id,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id,job_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">MIN</span>(salary) <span class="keyword">DESC</span>;</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126</span></span><br></pre></td></tr></table></figure>

<h5 id="1-9-1-案例分组查询"><a href="#1-9-1-案例分组查询" class="headerlink" title="1.9.1 案例分组查询"></a>1.9.1 案例分组查询</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1.</span>查询各job_id的员工工资的最大值，最小值，平均值，总和，并按job_id升序</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary),<span class="built_in">MIN</span>(salary),<span class="built_in">AVG</span>(salary),<span class="built_in">SUM</span>(salary),job_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> job_id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>查询员工最高工资和最低工资的差距（DIFFERENCE）</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary)<span class="operator">-</span><span class="built_in">MIN</span>(salary) DIFFRENCE</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line">#<span class="number">3.</span>查询各个管理者手下员工的最低工资，其中最低工资不能低于<span class="number">6000</span>，没有管理者的员工不计算在内</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary),manager_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> manager_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> manager_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">MIN</span>(salary)<span class="operator">&gt;=</span><span class="number">6000</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>查询所有部门的编号，员工数量和工资平均值,并按平均工资降序</span><br><span class="line"><span class="keyword">SELECT</span> department_id,<span class="built_in">COUNT</span>(<span class="operator">*</span>),<span class="built_in">AVG</span>(salary) a</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> a <span class="keyword">DESC</span>;</span><br><span class="line">#<span class="number">5.</span>选择具有各个job_id的员工人数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) 个数,job_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id;</span><br><span class="line"><span class="number">1234567891011121314151617181920212223242526272829</span></span><br></pre></td></tr></table></figure>

<h4 id="2-1-连接查询"><a href="#2-1-连接查询" class="headerlink" title="2.1 连接查询"></a>2.1 连接查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">SQLyog Ultimate v10.00 Beta1</span></span><br><span class="line"><span class="comment">MySQL - 5.7.18-log : Database - girls</span></span><br><span class="line"><span class="comment">*********************************************************************</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET NAMES utf8 */</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET SQL_MODE=&#x27;&#x27;*/</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */</span>;</span><br><span class="line"><span class="comment">/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE=&#x27;NO_AUTO_VALUE_ON_ZERO&#x27; */</span>;</span><br><span class="line"><span class="comment">/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */</span>;</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE <span class="comment">/*!32312 IF NOT EXISTS*/</span>`girls` <span class="comment">/*!40100 DEFAULT CHARACTER SET  gb2312 */</span>;</span><br><span class="line"></span><br><span class="line">USE `girls`;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Table structure for table `admin` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `admin`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `admin` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `username` <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `password` <span class="type">varchar</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">3</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Data for the table `admin` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> `admin`(`id`,`username`,`password`) <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;john&#x27;</span>,<span class="string">&#x27;8888&#x27;</span>),(<span class="number">2</span>,<span class="string">&#x27;lyt&#x27;</span>,<span class="string">&#x27;6666&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Table structure for table `beauty` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `beauty`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `beauty` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `name` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `sex` <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;女&#x27;</span>,</span><br><span class="line">  `borndate` datetime <span class="keyword">DEFAULT</span> <span class="string">&#x27;1987-01-01 00:00:00&#x27;</span>,</span><br><span class="line">  `phone` <span class="type">varchar</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `photo` <span class="type">blob</span>,</span><br><span class="line">  `boyfriend_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">13</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Data for the table `beauty` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> `beauty`(`id`,`name`,`sex`,`borndate`,`phone`,`photo`,`boyfriend_id`) <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;柳岩&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1988-02-03 00:00:00&#x27;</span>,<span class="string">&#x27;18209876577&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">8</span>),(<span class="number">2</span>,<span class="string">&#x27;苍老师&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1987-12-30 00:00:00&#x27;</span>,<span class="string">&#x27;18219876577&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">9</span>),(<span class="number">3</span>,<span class="string">&#x27;Angelababy&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1989-02-03 00:00:00&#x27;</span>,<span class="string">&#x27;18209876567&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">3</span>),(<span class="number">4</span>,<span class="string">&#x27;热巴&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1993-02-03 00:00:00&#x27;</span>,<span class="string">&#x27;18209876579&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">2</span>),(<span class="number">5</span>,<span class="string">&#x27;周冬雨&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1992-02-03 00:00:00&#x27;</span>,<span class="string">&#x27;18209179577&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">9</span>),(<span class="number">6</span>,<span class="string">&#x27;周芷若&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1988-02-03 00:00:00&#x27;</span>,<span class="string">&#x27;18209876577&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1</span>),(<span class="number">7</span>,<span class="string">&#x27;岳灵珊&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1987-12-30 00:00:00&#x27;</span>,<span class="string">&#x27;18219876577&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">9</span>),(<span class="number">8</span>,<span class="string">&#x27;小昭&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1989-02-03 00:00:00&#x27;</span>,<span class="string">&#x27;18209876567&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1</span>),(<span class="number">9</span>,<span class="string">&#x27;双儿&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1993-02-03 00:00:00&#x27;</span>,<span class="string">&#x27;18209876579&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">9</span>),(<span class="number">10</span>,<span class="string">&#x27;王语嫣&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1992-02-03 00:00:00&#x27;</span>,<span class="string">&#x27;18209179577&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">4</span>),(<span class="number">11</span>,<span class="string">&#x27;夏雪&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1993-02-03 00:00:00&#x27;</span>,<span class="string">&#x27;18209876579&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">9</span>),(<span class="number">12</span>,<span class="string">&#x27;赵敏&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1992-02-03 00:00:00&#x27;</span>,<span class="string">&#x27;18209179577&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Table structure for table `boys` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `boys`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `boys` (</span><br><span class="line">  `id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `boyName` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `userCP` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">5</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*Data for the table `boys` */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span>  <span class="keyword">into</span> `boys`(`id`,`boyName`,`userCP`) <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;张无忌&#x27;</span>,<span class="number">100</span>),(<span class="number">2</span>,<span class="string">&#x27;鹿晗&#x27;</span>,<span class="number">800</span>),(<span class="number">3</span>,<span class="string">&#x27;黄晓明&#x27;</span>,<span class="number">50</span>),(<span class="number">4</span>,<span class="string">&#x27;段誉&#x27;</span>,<span class="number">300</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*!40101 SET SQL_MODE=@OLD_SQL_MODE */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */</span>;</span><br><span class="line"><span class="comment">/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */</span>;</span><br><span class="line"><span class="comment">/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */</span>;</span><br><span class="line"></span><br><span class="line"><span class="number">12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">含义：又称多表查询，当查询的字段来自于多个表时，就会用到连接查询</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">笛卡尔乘积现象：表1 有m行，表2有n行，结果=m*n行</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">发生原因：没有有效的连接条件</span></span><br><span class="line"><span class="comment">如何避免：添加有效的连接条件</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">分类：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	按年代分类：</span></span><br><span class="line"><span class="comment">	sql92标准:仅仅支持内连接</span></span><br><span class="line"><span class="comment">	sql99标准【推荐】：支持内连接+外连接（左外和右外）+交叉连接</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	按功能分类：</span></span><br><span class="line"><span class="comment">		内连接：</span></span><br><span class="line"><span class="comment">			等值连接</span></span><br><span class="line"><span class="comment">			非等值连接</span></span><br><span class="line"><span class="comment">			自连接</span></span><br><span class="line"><span class="comment">		外连接：</span></span><br><span class="line"><span class="comment">			左外连接</span></span><br><span class="line"><span class="comment">			右外连接</span></span><br><span class="line"><span class="comment">			全外连接</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		交叉连接</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> beauty;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> boys;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> NAME,boyName <span class="keyword">FROM</span> boys,beauty</span><br><span class="line"><span class="keyword">WHERE</span> beauty.boyfriend_id<span class="operator">=</span> boys.id;</span><br><span class="line"></span><br><span class="line">#一、sql92标准</span><br><span class="line">#<span class="number">1</span>、等值连接</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">① 多表等值连接的结果为多表的交集部分</span></span><br><span class="line"><span class="comment">②n表连接，至少需要n-1个连接条件</span></span><br><span class="line"><span class="comment">③ 多表的顺序没有要求</span></span><br><span class="line"><span class="comment">④一般需要为表起别名</span></span><br><span class="line"><span class="comment">⑤可以搭配前面介绍的所有子句使用，比如排序、分组、筛选</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：查询女神名和对应的男神名</span><br><span class="line"><span class="keyword">SELECT</span> NAME,boyName </span><br><span class="line"><span class="keyword">FROM</span> boys,beauty</span><br><span class="line"><span class="keyword">WHERE</span> beauty.boyfriend_id<span class="operator">=</span> boys.id;</span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：查询员工名和对应的部门名</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees,departments</span><br><span class="line"><span class="keyword">WHERE</span> employees.`department_id`<span class="operator">=</span>departments.`department_id`;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2</span>、为表起别名</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">①提高语句的简洁度</span></span><br><span class="line"><span class="comment">②区分多个重名的字段</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">注意：如果为表起了别名，则查询的字段就不能使用原来的表名去限定</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#查询员工名、工种号、工种名</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> e.last_name,e.job_id,j.job_title</span><br><span class="line"><span class="keyword">FROM</span> employees  e,jobs j</span><br><span class="line"><span class="keyword">WHERE</span> e.`job_id`<span class="operator">=</span>j.`job_id`;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3</span>、两个表的顺序是否可以调换</span><br><span class="line"></span><br><span class="line">#查询员工名、工种号、工种名</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> e.last_name,e.job_id,j.job_title</span><br><span class="line"><span class="keyword">FROM</span> jobs j,employees e</span><br><span class="line"><span class="keyword">WHERE</span> e.`job_id`<span class="operator">=</span>j.`job_id`;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4</span>、可以加筛选</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例：查询有奖金的员工名、部门名</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name,commission_pct</span><br><span class="line"></span><br><span class="line"><span class="keyword">FROM</span> employees e,departments d</span><br><span class="line"><span class="keyword">WHERE</span> e.`department_id`<span class="operator">=</span>d.`department_id`</span><br><span class="line"><span class="keyword">AND</span> e.`commission_pct` <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：查询城市名中第二个字符为o的部门名和城市名</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> department_name,city</span><br><span class="line"><span class="keyword">FROM</span> departments d,locations l</span><br><span class="line"><span class="keyword">WHERE</span> d.`location_id` <span class="operator">=</span> l.`location_id`</span><br><span class="line"><span class="keyword">AND</span> city <span class="keyword">LIKE</span> <span class="string">&#x27;_o%&#x27;</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">5</span>、可以加分组</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：查询每个城市的部门个数</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) 个数,city</span><br><span class="line"><span class="keyword">FROM</span> departments d,locations l</span><br><span class="line"><span class="keyword">WHERE</span> d.`location_id`<span class="operator">=</span>l.`location_id`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> city;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：查询有奖金的每个部门的部门名和部门的领导编号和该部门的最低工资</span><br><span class="line"><span class="keyword">SELECT</span> department_name,d.`manager_id`,<span class="built_in">MIN</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> departments d,employees e</span><br><span class="line"><span class="keyword">WHERE</span> d.`department_id`<span class="operator">=</span>e.`department_id`</span><br><span class="line"><span class="keyword">AND</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_name,d.`manager_id`;</span><br><span class="line">#<span class="number">6</span>、可以加排序</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例：查询每个工种的工种名和员工的个数，并且按员工个数降序</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> job_title,<span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line"><span class="keyword">FROM</span> employees e,jobs j</span><br><span class="line"><span class="keyword">WHERE</span> e.`job_id`<span class="operator">=</span>j.`job_id`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_title</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">7</span>、可以实现三表连接？</span><br><span class="line"></span><br><span class="line">#案例：查询员工名、部门名和所在的城市</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name,city</span><br><span class="line"><span class="keyword">FROM</span> employees e,departments d,locations l</span><br><span class="line"><span class="keyword">WHERE</span> e.`department_id`<span class="operator">=</span>d.`department_id`</span><br><span class="line"><span class="keyword">AND</span> d.`location_id`<span class="operator">=</span>l.`location_id`</span><br><span class="line"><span class="keyword">AND</span> city <span class="keyword">LIKE</span> <span class="string">&#x27;s%&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> department_name <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2</span>、非等值连接</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：查询员工的工资和工资级别</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> salary,grade_level</span><br><span class="line"><span class="keyword">FROM</span> employees e,job_grades g</span><br><span class="line"><span class="keyword">WHERE</span> salary <span class="keyword">BETWEEN</span> g.`lowest_sal` <span class="keyword">AND</span> g.`highest_sal`</span><br><span class="line"><span class="keyword">AND</span> g.`grade_level`<span class="operator">=</span><span class="string">&#x27;A&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">select salary,employee_id from employees;</span></span><br><span class="line"><span class="comment">select * from job_grades;</span></span><br><span class="line"><span class="comment">CREATE TABLE job_grades</span></span><br><span class="line"><span class="comment">(grade_level VARCHAR(3),</span></span><br><span class="line"><span class="comment"> lowest_sal  int,</span></span><br><span class="line"><span class="comment"> highest_sal int);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">INSERT INTO job_grades</span></span><br><span class="line"><span class="comment">VALUES (&#x27;A&#x27;, 1000, 2999);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">INSERT INTO job_grades</span></span><br><span class="line"><span class="comment">VALUES (&#x27;B&#x27;, 3000, 5999);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">INSERT INTO job_grades</span></span><br><span class="line"><span class="comment">VALUES(&#x27;C&#x27;, 6000, 9999);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">INSERT INTO job_grades</span></span><br><span class="line"><span class="comment">VALUES(&#x27;D&#x27;, 10000, 14999);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">INSERT INTO job_grades</span></span><br><span class="line"><span class="comment">VALUES(&#x27;E&#x27;, 15000, 24999);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">INSERT INTO job_grades</span></span><br><span class="line"><span class="comment">VALUES(&#x27;F&#x27;, 25000, 40000);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3</span>、自连接</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例：查询 员工名和上级的名称</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> e.employee_id,e.last_name,m.employee_id,m.last_name</span><br><span class="line"><span class="keyword">FROM</span> employees e,employees m</span><br><span class="line"><span class="keyword">WHERE</span> e.`manager_id`<span class="operator">=</span>m.`employee_id`;</span><br><span class="line"></span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204</span></span><br></pre></td></tr></table></figure>

<h5 id="2-1-1-案例连接查询"><a href="#2-1-1-案例连接查询" class="headerlink" title="2.1.1 案例连接查询"></a>2.1.1 案例连接查询</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1.</span>显示所有员工的姓名，部门号和部门名称。</span><br><span class="line">USE myemployees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,d.department_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e,departments d</span><br><span class="line"><span class="keyword">WHERE</span> e.`department_id` <span class="operator">=</span> d.`department_id`;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>查询<span class="number">90</span>号部门员工的job_id和<span class="number">90</span>号部门的location_id</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> job_id,location_id</span><br><span class="line"><span class="keyword">FROM</span> employees e,departments d</span><br><span class="line"><span class="keyword">WHERE</span> e.`department_id`<span class="operator">=</span>d.`department_id`</span><br><span class="line"><span class="keyword">AND</span> e.`department_id`<span class="operator">=</span><span class="number">90</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>	选择所有有奖金的员工的</span><br><span class="line">last_name , department_name , location_id , city</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name , department_name , l.location_id , city</span><br><span class="line"><span class="keyword">FROM</span> employees e,departments d,locations l</span><br><span class="line"><span class="keyword">WHERE</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">AND</span> d.location_id<span class="operator">=</span>l.location_id</span><br><span class="line"><span class="keyword">AND</span> e.commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>选择city在Toronto工作的员工的</span><br><span class="line">last_name , job_id , department_id , department_name </span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name , job_id , d.department_id , department_name </span><br><span class="line"><span class="keyword">FROM</span> employees e,departments d ,locations l</span><br><span class="line"><span class="keyword">WHERE</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">AND</span> d.location_id<span class="operator">=</span>l.location_id</span><br><span class="line"><span class="keyword">AND</span> city <span class="operator">=</span> <span class="string">&#x27;Toronto&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">5.</span>查询每个工种、每个部门的部门名、工种名和最低工资</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> department_name,job_title,<span class="built_in">MIN</span>(salary) 最低工资</span><br><span class="line"><span class="keyword">FROM</span> employees e,departments d,jobs j</span><br><span class="line"><span class="keyword">WHERE</span> e.`department_id`<span class="operator">=</span>d.`department_id`</span><br><span class="line"><span class="keyword">AND</span> e.`job_id`<span class="operator">=</span>j.`job_id`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_name,job_title;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">6.</span>查询每个国家下的部门个数大于<span class="number">2</span>的国家编号</span><br><span class="line">bcc</span><br><span class="line"><span class="keyword">SELECT</span> country_id,<span class="built_in">COUNT</span>(<span class="operator">*</span>) 部门个数</span><br><span class="line"><span class="keyword">FROM</span> departments d,locations l</span><br><span class="line"><span class="keyword">WHERE</span> d.`location_id`<span class="operator">=</span>l.`location_id`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> country_id</span><br><span class="line"><span class="keyword">HAVING</span> 部门个数<span class="operator">&gt;</span><span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">7</span>、选择指定员工的姓名，员工号，以及他的管理者的姓名和员工号，结果类似于下面的格式</span><br><span class="line">employees	Emp#	manager	Mgr#</span><br><span class="line">kochhar		<span class="number">101</span>	king	<span class="number">100</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> e.last_name employees,e.employee_id &quot;Emp#&quot;,m.last_name manager,m.employee_id &quot;Mgr#&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees e,employees m</span><br><span class="line"><span class="keyword">WHERE</span> e.manager_id <span class="operator">=</span> m.employee_id</span><br><span class="line"><span class="keyword">AND</span> e.last_name<span class="operator">=</span><span class="string">&#x27;kochhar&#x27;</span>;c</span><br><span class="line"><span class="number">1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071</span></span><br></pre></td></tr></table></figure>

<h5 id="2-1-2-sql99语法的连接查询"><a href="#2-1-2-sql99语法的连接查询" class="headerlink" title="2.1.2 sql99语法的连接查询"></a>2.1.2 sql99语法的连接查询</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">	select 查询列表</span></span><br><span class="line"><span class="comment">	from 表1 别名 【连接类型】</span></span><br><span class="line"><span class="comment">	join 表2 别名 </span></span><br><span class="line"><span class="comment">	on 连接条件</span></span><br><span class="line"><span class="comment">	【where 筛选条件】</span></span><br><span class="line"><span class="comment">	【group by 分组】</span></span><br><span class="line"><span class="comment">	【having 筛选条件】</span></span><br><span class="line"><span class="comment">	【order by 排序列表】</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">分类：</span></span><br><span class="line"><span class="comment">内连接（★）：inner</span></span><br><span class="line"><span class="comment">外连接</span></span><br><span class="line"><span class="comment">	左外(★):left 【outer】</span></span><br><span class="line"><span class="comment">	右外(★)：right 【outer】</span></span><br><span class="line"><span class="comment">	全外：full【outer】</span></span><br><span class="line"><span class="comment">交叉连接：cross </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#一）内连接</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">select 查询列表</span></span><br><span class="line"><span class="comment">from 表1 别名</span></span><br><span class="line"><span class="comment">inner join 表2 别名</span></span><br><span class="line"><span class="comment">on 连接条件;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">分类：</span></span><br><span class="line"><span class="comment">等值</span></span><br><span class="line"><span class="comment">非等值</span></span><br><span class="line"><span class="comment">自连接</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment">①添加排序、分组、筛选</span></span><br><span class="line"><span class="comment">②inner可以省略</span></span><br><span class="line"><span class="comment">③ 筛选条件放在where后面，连接条件放在on后面，提高分离性，便于阅读</span></span><br><span class="line"><span class="comment">④inner join连接和sql92语法中的等值连接效果是一样的，都是查询多表的交集</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">1</span>、等值连接</span><br><span class="line">#案例<span class="number">1.</span>查询员工名、部门名</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"> <span class="keyword">JOIN</span>  employees e</span><br><span class="line"><span class="keyword">ON</span> e.`department_id` <span class="operator">=</span> d.`department_id`;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">2.</span>查询名字中包含e的员工名和工种名（添加筛选）</span><br><span class="line"><span class="keyword">SELECT</span> last_name,job_title</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> jobs j</span><br><span class="line"><span class="keyword">ON</span> e.`job_id`<span class="operator">=</span>  j.`job_id`</span><br><span class="line"><span class="keyword">WHERE</span> e.`last_name` <span class="keyword">LIKE</span> <span class="string">&#x27;%e%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span> 查询部门个数<span class="operator">&gt;</span><span class="number">3</span>的城市名和部门个数，（添加分组<span class="operator">+</span>筛选）</span><br><span class="line"></span><br><span class="line">#①查询每个城市的部门个数</span><br><span class="line">#②在①结果上筛选满足条件的</span><br><span class="line"><span class="keyword">SELECT</span> city,<span class="built_in">COUNT</span>(<span class="operator">*</span>) 部门个数</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> locations l</span><br><span class="line"><span class="keyword">ON</span> d.`location_id`<span class="operator">=</span>l.`location_id`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> city</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">4.</span>查询哪个部门的员工个数<span class="operator">&gt;</span><span class="number">3</span>的部门名和员工个数，并按个数降序（添加排序）</span><br><span class="line"></span><br><span class="line">#①查询每个部门的员工个数</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>),department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.`department_id`<span class="operator">=</span>d.`department_id`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_name</span><br><span class="line"></span><br><span class="line">#② 在①结果上筛选员工个数<span class="operator">&gt;</span><span class="number">3</span>的记录，并排序</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) 个数,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.`department_id`<span class="operator">=</span>d.`department_id`</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_name</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">3</span></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">5.</span>查询员工名、部门名、工种名，并按部门名降序（添加三表连接）</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name,job_title</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> departments d <span class="keyword">ON</span> e.`department_id`<span class="operator">=</span>d.`department_id`</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> jobs j <span class="keyword">ON</span> e.`job_id` <span class="operator">=</span> j.`job_id`</span><br><span class="line"></span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> department_name <span class="keyword">DESC</span>;</span><br><span class="line"></span><br><span class="line">#二）非等值连接</span><br><span class="line"></span><br><span class="line">#查询员工的工资级别</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> salary,grade_level</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"> <span class="keyword">JOIN</span> job_grades g</span><br><span class="line"> <span class="keyword">ON</span> e.`salary` <span class="keyword">BETWEEN</span> g.`lowest_sal` <span class="keyword">AND</span> g.`highest_sal`;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> #查询工资级别的个数<span class="operator">&gt;</span><span class="number">20</span>的个数，并且按工资级别降序</span><br><span class="line"> <span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>),grade_level</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"> <span class="keyword">JOIN</span> job_grades g</span><br><span class="line"> <span class="keyword">ON</span> e.`salary` <span class="keyword">BETWEEN</span> g.`lowest_sal` <span class="keyword">AND</span> g.`highest_sal`</span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> grade_level</span><br><span class="line"> <span class="keyword">HAVING</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)<span class="operator">&gt;</span><span class="number">20</span></span><br><span class="line"> <span class="keyword">ORDER</span> <span class="keyword">BY</span> grade_level <span class="keyword">DESC</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> #三）自连接</span><br><span class="line"> </span><br><span class="line"> #查询员工的名字、上级的名字</span><br><span class="line"> <span class="keyword">SELECT</span> e.last_name,m.last_name</span><br><span class="line"> <span class="keyword">FROM</span> employees e</span><br><span class="line"> <span class="keyword">JOIN</span> employees m</span><br><span class="line"> <span class="keyword">ON</span> e.`manager_id`<span class="operator">=</span> m.`employee_id`;</span><br><span class="line"> </span><br><span class="line">  #查询姓名中包含字符k的员工的名字、上级的名字</span><br><span class="line"> <span class="keyword">SELECT</span> e.last_name,m.last_name</span><br><span class="line"> <span class="keyword">FROM</span> employees e</span><br><span class="line"> <span class="keyword">JOIN</span> employees m</span><br><span class="line"> <span class="keyword">ON</span> e.`manager_id`<span class="operator">=</span> m.`employee_id`</span><br><span class="line"> <span class="keyword">WHERE</span> e.`last_name` <span class="keyword">LIKE</span> <span class="string">&#x27;%k%&#x27;</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> #二、外连接</span><br><span class="line"> </span><br><span class="line"> <span class="comment">/*</span></span><br><span class="line"><span class="comment"> 应用场景：用于查询一个表中有，另一个表没有的记录</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> 特点：</span></span><br><span class="line"><span class="comment"> 1、外连接的查询结果为主表中的所有记录</span></span><br><span class="line"><span class="comment">	如果从表中有和它匹配的，则显示匹配的值</span></span><br><span class="line"><span class="comment">	如果从表中没有和它匹配的，则显示null</span></span><br><span class="line"><span class="comment">	外连接查询结果=内连接结果+主表中有而从表没有的记录</span></span><br><span class="line"><span class="comment"> 2、左外连接，left join左边的是主表</span></span><br><span class="line"><span class="comment">    右外连接，right join右边的是主表</span></span><br><span class="line"><span class="comment"> 3、左外和右外交换两个表的顺序，可以实现同样的效果 </span></span><br><span class="line"><span class="comment"> 4、全外连接=内连接的结果+表1中有但表2没有的+表2中有但表1没有的</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> #引入：查询男朋友 不在男神表的的女神名</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> beauty;</span><br><span class="line"> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> boys;</span><br><span class="line"> </span><br><span class="line"> #左外连接</span><br><span class="line"> <span class="keyword">SELECT</span> b.<span class="operator">*</span>,bo.<span class="operator">*</span></span><br><span class="line"> <span class="keyword">FROM</span> boys bo</span><br><span class="line"> <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> beauty b</span><br><span class="line"> <span class="keyword">ON</span> b.`boyfriend_id` <span class="operator">=</span> bo.`id`</span><br><span class="line"> <span class="keyword">WHERE</span> b.`id` <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> #案例<span class="number">1</span>：查询哪个部门没有员工</span><br><span class="line"> #左外</span><br><span class="line"> <span class="keyword">SELECT</span> d.<span class="operator">*</span>,e.employee_id</span><br><span class="line"> <span class="keyword">FROM</span> departments d</span><br><span class="line"> <span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> employees e</span><br><span class="line"> <span class="keyword">ON</span> d.`department_id` <span class="operator">=</span> e.`department_id`</span><br><span class="line"> <span class="keyword">WHERE</span> e.`employee_id` <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> #右外</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">SELECT</span> d.<span class="operator">*</span>,e.employee_id</span><br><span class="line"> <span class="keyword">FROM</span> employees e</span><br><span class="line"> <span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> departments d</span><br><span class="line"> <span class="keyword">ON</span> d.`department_id` <span class="operator">=</span> e.`department_id`</span><br><span class="line"> <span class="keyword">WHERE</span> e.`employee_id` <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> #全外</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> USE girls;</span><br><span class="line"> <span class="keyword">SELECT</span> b.<span class="operator">*</span>,bo.<span class="operator">*</span></span><br><span class="line"> <span class="keyword">FROM</span> beauty b</span><br><span class="line"> <span class="keyword">FULL</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> boys bo</span><br><span class="line"> <span class="keyword">ON</span> b.`boyfriend_id` <span class="operator">=</span> bo.id;</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> #交叉连接相当于<span class="number">92</span>语法的笛卡尔乘积</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">SELECT</span> b.<span class="operator">*</span>,bo.<span class="operator">*</span></span><br><span class="line"> <span class="keyword">FROM</span> beauty b</span><br><span class="line"> <span class="keyword">CROSS</span> <span class="keyword">JOIN</span> boys bo;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> #sql92和 sql99pk</span><br><span class="line"> <span class="comment">/*</span></span><br><span class="line"><span class="comment"> 功能：sql99支持的较多</span></span><br><span class="line"><span class="comment"> 可读性：sql99实现连接条件和筛选条件的分离，可读性较高</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217</span></span><br></pre></td></tr></table></figure>

<h6 id="2-1-2-1-多表连接"><a href="#2-1-2-1-多表连接" class="headerlink" title="2.1.2.1 多表连接"></a>2.1.2.1 多表连接</h6><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">#一、查询编号<span class="operator">&gt;</span><span class="number">3</span>的女神的男朋友信息，如果有则列出详细，如果没有，用<span class="keyword">null</span>填充</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> b.id,b.name,bo.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> beauty b</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> boys bo</span><br><span class="line"><span class="keyword">ON</span> b.`boyfriend_id` <span class="operator">=</span> bo.`id`</span><br><span class="line"><span class="keyword">WHERE</span> b.`id`<span class="operator">&gt;</span><span class="number">3</span>;</span><br><span class="line">#二、查询哪个城市没有部门</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> city</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">OUTER</span> <span class="keyword">JOIN</span> locations l </span><br><span class="line"><span class="keyword">ON</span> d.`location_id`<span class="operator">=</span>l.`location_id`</span><br><span class="line"><span class="keyword">WHERE</span>  d.`department_id` <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">#三、查询部门名为SAL或IT的员工信息</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> e.<span class="operator">*</span>,d.department_name,d.`department_id`</span><br><span class="line"><span class="keyword">FROM</span> departments  d</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> employees e</span><br><span class="line"><span class="keyword">ON</span> d.`department_id` <span class="operator">=</span> e.`department_id`</span><br><span class="line"><span class="keyword">WHERE</span> d.`department_name` <span class="keyword">IN</span>(<span class="string">&#x27;SAL&#x27;</span>,<span class="string">&#x27;IT&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> departments</span><br><span class="line"><span class="keyword">WHERE</span> `department_name` <span class="keyword">IN</span>(<span class="string">&#x27;SAL&#x27;</span>,<span class="string">&#x27;IT&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="number">12345678910111213141516171819202122232425262728</span></span><br></pre></td></tr></table></figure>

<h6 id="2-1-2-2-join连接总结"><a href="#2-1-2-2-join连接总结" class="headerlink" title="2.1.2.2 join连接总结"></a>2.1.2.2 join连接总结</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20200730102829640.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20200730103243988.png" alt="在这里插入图片描述"></p>
<h4 id="2-2-子查询"><a href="#2-2-子查询" class="headerlink" title="2.2 子查询"></a>2.2 子查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br></pre></td><td class="code"><pre><span class="line">#进阶<span class="number">7</span>：子查询</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">含义：</span></span><br><span class="line"><span class="comment">出现在其他语句中的select语句，称为子查询或内查询</span></span><br><span class="line"><span class="comment">外部的查询语句，称为主查询或外查询</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">分类：</span></span><br><span class="line"><span class="comment">按子查询出现的位置：</span></span><br><span class="line"><span class="comment">	select后面：</span></span><br><span class="line"><span class="comment">		仅仅支持标量子查询</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	from后面：</span></span><br><span class="line"><span class="comment">		支持表子查询</span></span><br><span class="line"><span class="comment">	where或having后面：★</span></span><br><span class="line"><span class="comment">		标量子查询（单行） √</span></span><br><span class="line"><span class="comment">		列子查询  （多行） √</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		行子查询</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">	exists后面（相关子查询）</span></span><br><span class="line"><span class="comment">		表子查询</span></span><br><span class="line"><span class="comment">按结果集的行列数不同：</span></span><br><span class="line"><span class="comment">	标量子查询（结果集只有一行一列）</span></span><br><span class="line"><span class="comment">	列子查询（结果集只有一列多行）</span></span><br><span class="line"><span class="comment">	行子查询（结果集有一行多列）</span></span><br><span class="line"><span class="comment">	表子查询（结果集一般为多行多列）</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#一、<span class="keyword">where</span>或<span class="keyword">having</span>后面</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1、标量子查询（单行子查询）</span></span><br><span class="line"><span class="comment">2、列子查询（多行子查询）</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">3、行子查询（多列多行）</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment">①子查询放在小括号内</span></span><br><span class="line"><span class="comment">②子查询一般放在条件的右侧</span></span><br><span class="line"><span class="comment">③标量子查询，一般搭配着单行操作符使用</span></span><br><span class="line"><span class="comment">&gt; &lt; &gt;= &lt;= = &lt;&gt;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">列子查询，一般搭配着多行操作符使用</span></span><br><span class="line"><span class="comment">in、any/some、all</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">④子查询的执行优先于主查询执行，主查询的条件用到了子查询的结果</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#<span class="number">1.</span>标量子查询★</span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：谁的工资比 Abel 高?</span><br><span class="line"></span><br><span class="line">#①查询Abel的工资</span><br><span class="line"><span class="keyword">SELECT</span> salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="operator">=</span> <span class="string">&#x27;Abel&#x27;</span></span><br><span class="line"></span><br><span class="line">#②查询员工的信息，满足 salary<span class="operator">&gt;</span>①结果</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">&gt;</span>(</span><br><span class="line"></span><br><span class="line">	<span class="keyword">SELECT</span> salary</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> last_name <span class="operator">=</span> <span class="string">&#x27;Abel&#x27;</span></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：返回job_id与<span class="number">141</span>号员工相同，salary比<span class="number">143</span>号员工多的员工 姓名，job_id 和工资</span><br><span class="line"></span><br><span class="line">#①查询<span class="number">141</span>号员工的job_id</span><br><span class="line"><span class="keyword">SELECT</span> job_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> employee_id <span class="operator">=</span> <span class="number">141</span></span><br><span class="line"></span><br><span class="line">#②查询<span class="number">143</span>号员工的salary</span><br><span class="line"><span class="keyword">SELECT</span> salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> employee_id <span class="operator">=</span> <span class="number">143</span></span><br><span class="line"></span><br><span class="line">#③查询员工的姓名，job_id 和工资，要求job_id<span class="operator">=</span>①并且salary<span class="operator">&gt;</span>②</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,job_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> job_id <span class="operator">=</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> job_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> <span class="number">141</span></span><br><span class="line">) <span class="keyword">AND</span> salary<span class="operator">&gt;</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> salary</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> employee_id <span class="operator">=</span> <span class="number">143</span></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">3</span>：返回公司工资最少的员工的last_name,job_id和salary</span><br><span class="line"></span><br><span class="line">#①查询公司的 最低工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line">#②查询last_name,job_id和salary，要求salary<span class="operator">=</span>①</span><br><span class="line"><span class="keyword">SELECT</span> last_name,job_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">=</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">4</span>：查询最低工资大于<span class="number">50</span>号部门最低工资的部门id和其最低工资</span><br><span class="line"></span><br><span class="line">#①查询<span class="number">50</span>号部门的最低工资</span><br><span class="line"><span class="keyword">SELECT</span>  <span class="built_in">MIN</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="operator">=</span> <span class="number">50</span></span><br><span class="line"></span><br><span class="line">#②查询每个部门的最低工资</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"></span><br><span class="line">#③ 在②基础上筛选，满足<span class="built_in">min</span>(salary)<span class="operator">&gt;</span>①</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">MIN</span>(salary)<span class="operator">&gt;</span>(</span><br><span class="line">	<span class="keyword">SELECT</span>  <span class="built_in">MIN</span>(salary)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> department_id <span class="operator">=</span> <span class="number">50</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#非法使用标量子查询</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">MIN</span>(salary)<span class="operator">&gt;</span>(</span><br><span class="line">	<span class="keyword">SELECT</span>  salary</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> department_id <span class="operator">=</span> <span class="number">250</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>列子查询（多行子查询）★</span><br><span class="line">#案例<span class="number">1</span>：返回location_id是<span class="number">1400</span>或<span class="number">1700</span>的部门中的所有员工姓名</span><br><span class="line"></span><br><span class="line">#①查询location_id是<span class="number">1400</span>或<span class="number">1700</span>的部门编号</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> department_id</span><br><span class="line"><span class="keyword">FROM</span> departments</span><br><span class="line"><span class="keyword">WHERE</span> location_id <span class="keyword">IN</span>(<span class="number">1400</span>,<span class="number">1700</span>)</span><br><span class="line"></span><br><span class="line">#②查询员工姓名，要求部门号是①列表中的某一个</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id  <span class="operator">&lt;&gt;</span><span class="keyword">ALL</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> department_id</span><br><span class="line">	<span class="keyword">FROM</span> departments</span><br><span class="line">	<span class="keyword">WHERE</span> location_id <span class="keyword">IN</span>(<span class="number">1400</span>,<span class="number">1700</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：返回其它工种中比job_id为‘IT_PROG’工种任一工资低的员工的员工号、姓名、job_id 以及salary</span><br><span class="line"></span><br><span class="line">#①查询job_id为‘IT_PROG’部门任一工资</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> job_id <span class="operator">=</span> <span class="string">&#x27;IT_PROG&#x27;</span></span><br><span class="line"></span><br><span class="line">#②查询员工号、姓名、job_id 以及salary，salary<span class="operator">&lt;</span>(①)的任意一个</span><br><span class="line"><span class="keyword">SELECT</span> last_name,employee_id,job_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">&lt;</span><span class="keyword">ANY</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> salary</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> job_id <span class="operator">=</span> <span class="string">&#x27;IT_PROG&#x27;</span></span><br><span class="line"></span><br><span class="line">) <span class="keyword">AND</span> job_id<span class="operator">&lt;&gt;</span><span class="string">&#x27;IT_PROG&#x27;</span>;</span><br><span class="line"></span><br><span class="line">#或</span><br><span class="line"><span class="keyword">SELECT</span> last_name,employee_id,job_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">&lt;</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> job_id <span class="operator">=</span> <span class="string">&#x27;IT_PROG&#x27;</span></span><br><span class="line"></span><br><span class="line">) <span class="keyword">AND</span> job_id<span class="operator">&lt;&gt;</span><span class="string">&#x27;IT_PROG&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">3</span>：返回其它部门中比job_id为‘IT_PROG’部门所有工资都低的员工   的员工号、姓名、job_id 以及salary</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,employee_id,job_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">&lt;</span><span class="keyword">ALL</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> salary</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> job_id <span class="operator">=</span> <span class="string">&#x27;IT_PROG&#x27;</span></span><br><span class="line"></span><br><span class="line">) <span class="keyword">AND</span> job_id<span class="operator">&lt;&gt;</span><span class="string">&#x27;IT_PROG&#x27;</span>;</span><br><span class="line"></span><br><span class="line">#或</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,employee_id,job_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">&lt;</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MIN</span>( salary)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> job_id <span class="operator">=</span> <span class="string">&#x27;IT_PROG&#x27;</span></span><br><span class="line"></span><br><span class="line">) <span class="keyword">AND</span> job_id<span class="operator">&lt;&gt;</span><span class="string">&#x27;IT_PROG&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3</span>、行子查询（结果集一行多列或多行多列）</span><br><span class="line"></span><br><span class="line">#案例：查询员工编号最小并且工资最高的员工信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> (employee_id,salary)<span class="operator">=</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(employee_id),<span class="built_in">MAX</span>(salary)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#①查询最小的员工编号</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(employee_id)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#②查询最高工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#③查询员工信息</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> employee_id<span class="operator">=</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(employee_id)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">)<span class="keyword">AND</span> salary<span class="operator">=</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#二、<span class="keyword">select</span>后面</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">仅仅支持标量子查询</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#案例：查询每个部门的员工个数</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> d.<span class="operator">*</span>,(</span><br><span class="line"></span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>)</span><br><span class="line">	<span class="keyword">FROM</span> employees e</span><br><span class="line">	<span class="keyword">WHERE</span> e.department_id <span class="operator">=</span> d.`department_id`</span><br><span class="line"> ) 个数</span><br><span class="line"> <span class="keyword">FROM</span> departments d;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> #案例<span class="number">2</span>：查询员工号<span class="operator">=</span><span class="number">102</span>的部门名</span><br><span class="line"> </span><br><span class="line"><span class="keyword">SELECT</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> department_name,e.department_id</span><br><span class="line">	<span class="keyword">FROM</span> departments d</span><br><span class="line">	<span class="keyword">INNER</span> <span class="keyword">JOIN</span> employees e</span><br><span class="line">	<span class="keyword">ON</span> d.department_id<span class="operator">=</span>e.department_id</span><br><span class="line">	<span class="keyword">WHERE</span> e.employee_id<span class="operator">=</span><span class="number">102</span></span><br><span class="line">	</span><br><span class="line">) 部门名;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#三、<span class="keyword">from</span>后面</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">将子查询结果充当一张表，要求必须起别名</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#案例：查询每个部门的平均工资的工资等级</span><br><span class="line">#①查询每个部门的平均工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> job_grades;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#②连接①的结果集和job_grades表，筛选条件平均工资 <span class="keyword">between</span> lowest_sal <span class="keyword">and</span> highest_sal</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span>  ag_dep.<span class="operator">*</span>,g.`grade_level`</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) ag,department_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line">) ag_dep</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> job_grades g</span><br><span class="line"><span class="keyword">ON</span> ag_dep.ag <span class="keyword">BETWEEN</span> lowest_sal <span class="keyword">AND</span> highest_sal;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#四、<span class="keyword">exists</span>后面（相关子查询）</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">exists(完整的查询语句)</span></span><br><span class="line"><span class="comment">结果：</span></span><br><span class="line"><span class="comment">1或0</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">EXISTS</span>(<span class="keyword">SELECT</span> employee_id <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> salary<span class="operator">=</span><span class="number">300000</span>);</span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：查询有员工的部门名</span><br><span class="line"></span><br><span class="line">#<span class="keyword">in</span></span><br><span class="line"><span class="keyword">SELECT</span> department_name</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">WHERE</span> d.`department_id` <span class="keyword">IN</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> department_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">#<span class="keyword">exists</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> department_name</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line">	<span class="keyword">FROM</span> employees e</span><br><span class="line">	<span class="keyword">WHERE</span> d.`department_id`<span class="operator">=</span>e.`department_id`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：查询没有女朋友的男神信息</span><br><span class="line"></span><br><span class="line">#<span class="keyword">in</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> bo.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> boys bo</span><br><span class="line"><span class="keyword">WHERE</span> bo.id <span class="keyword">NOT</span> <span class="keyword">IN</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> boyfriend_id</span><br><span class="line">	<span class="keyword">FROM</span> beauty</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">#<span class="keyword">exists</span></span><br><span class="line"><span class="keyword">SELECT</span> bo.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> boys bo</span><br><span class="line"><span class="keyword">WHERE</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> boyfriend_id</span><br><span class="line">	<span class="keyword">FROM</span> beauty b</span><br><span class="line">	<span class="keyword">WHERE</span> bo.`id`<span class="operator">=</span>b.`boyfriend_id`</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384</span></span><br></pre></td></tr></table></figure>

<h5 id="2-2-1-案例子查询"><a href="#2-2-1-案例子查询" class="headerlink" title="2.2.1 案例子查询"></a>2.2.1 案例子查询</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1.</span>	查询和Zlotkey相同部门的员工姓名和工资</span><br><span class="line"></span><br><span class="line">#①查询Zlotkey的部门</span><br><span class="line"><span class="keyword">SELECT</span> department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="operator">=</span> <span class="string">&#x27;Zlotkey&#x27;</span></span><br><span class="line"></span><br><span class="line">#②查询部门号<span class="operator">=</span>①的姓名和工资</span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="operator">=</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> department_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> last_name <span class="operator">=</span> <span class="string">&#x27;Zlotkey&#x27;</span></span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>查询工资比公司平均工资高的员工的员工号，姓名和工资。</span><br><span class="line"></span><br><span class="line">#①查询平均工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line">#②查询工资<span class="operator">&gt;</span>①的员工号，姓名和工资。</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,employee_id,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">&gt;</span>(</span><br><span class="line"></span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>查询各部门中工资比本部门平均工资高的员工的员工号, 姓名和工资</span><br><span class="line">#①查询各部门的平均工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"></span><br><span class="line">#②连接①结果集和employees表，进行筛选</span><br><span class="line"><span class="keyword">SELECT</span> employee_id,last_name,salary,e.department_id</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) ag,department_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">) ag_dep</span><br><span class="line"><span class="keyword">ON</span> e.department_id <span class="operator">=</span> ag_dep.department_id</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">&gt;</span>ag_dep.ag ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>	查询和姓名中包含字母u的员工在相同部门的员工的员工号和姓名</span><br><span class="line">#①查询姓名中包含字母u的员工的部门</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span>  <span class="keyword">DISTINCT</span> department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%u%&#x27;</span></span><br><span class="line"></span><br><span class="line">#②查询部门号<span class="operator">=</span>①中的任意一个的员工号和姓名</span><br><span class="line"><span class="keyword">SELECT</span> last_name,employee_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="keyword">IN</span>(</span><br><span class="line">	<span class="keyword">SELECT</span>  <span class="keyword">DISTINCT</span> department_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%u%&#x27;</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">5.</span> 查询在部门的location_id为<span class="number">1700</span>的部门工作的员工的员工号</span><br><span class="line"></span><br><span class="line">#①查询location_id为<span class="number">1700</span>的部门</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> department_id</span><br><span class="line"><span class="keyword">FROM</span> departments </span><br><span class="line"><span class="keyword">WHERE</span> location_id  <span class="operator">=</span> <span class="number">1700</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#②查询部门号<span class="operator">=</span>①中的任意一个的员工号</span><br><span class="line"><span class="keyword">SELECT</span> employee_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id <span class="operator">=</span><span class="keyword">ANY</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> department_id</span><br><span class="line">	<span class="keyword">FROM</span> departments </span><br><span class="line">	<span class="keyword">WHERE</span> location_id  <span class="operator">=</span> <span class="number">1700</span></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line">#<span class="number">6.</span>查询管理者是King的员工姓名和工资</span><br><span class="line"></span><br><span class="line">#①查询姓名为king的员工编号</span><br><span class="line"><span class="keyword">SELECT</span> employee_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> last_name  <span class="operator">=</span> <span class="string">&#x27;K_ing&#x27;</span></span><br><span class="line"></span><br><span class="line">#②查询哪个员工的manager_id <span class="operator">=</span> ①</span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> manager_id <span class="keyword">IN</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> employee_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> last_name  <span class="operator">=</span> <span class="string">&#x27;K_ing&#x27;</span></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#<span class="number">7.</span>查询工资最高的员工的姓名，要求first_name和last_name显示为一列，列名为 姓.名</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#①查询最高工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line">#②查询工资<span class="operator">=</span>①的姓.名</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> CONCAT(first_name,last_name) &quot;姓.名&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">=</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124</span></span><br></pre></td></tr></table></figure>

<h5 id="2-2-2-子查询经典案例"><a href="#2-2-2-子查询经典案例" class="headerlink" title="2.2.2 子查询经典案例"></a>2.2.2 子查询经典案例</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">1.</span> 查询工资最低的员工信息: last_name, salary</span><br><span class="line"></span><br><span class="line">#①查询最低的工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line">#②查询last_name,salary，要求salary<span class="operator">=</span>①</span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> salary<span class="operator">=</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"># <span class="number">2.</span> 查询平均工资最低的部门信息</span><br><span class="line"></span><br><span class="line">#方式一：</span><br><span class="line">#①各部门的平均工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line">#②查询①结果上的最低平均工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(ag)</span><br><span class="line"><span class="keyword">FROM</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) ag,department_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line">) ag_dep</span><br><span class="line"></span><br><span class="line">#③查询哪个部门的平均工资<span class="operator">=</span>②</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">AVG</span>(salary)<span class="operator">=</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(ag)</span><br><span class="line">	<span class="keyword">FROM</span> (</span><br><span class="line">		<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) ag,department_id</span><br><span class="line">		<span class="keyword">FROM</span> employees</span><br><span class="line">		<span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line">	) ag_dep</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#④查询部门信息</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> d.<span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">WHERE</span> d.`department_id`<span class="operator">=</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> department_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line">	<span class="keyword">HAVING</span> <span class="built_in">AVG</span>(salary)<span class="operator">=</span>(</span><br><span class="line">		<span class="keyword">SELECT</span> <span class="built_in">MIN</span>(ag)</span><br><span class="line">		<span class="keyword">FROM</span> (</span><br><span class="line">			<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) ag,department_id</span><br><span class="line">			<span class="keyword">FROM</span> employees</span><br><span class="line">			<span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line">		) ag_dep</span><br><span class="line"></span><br><span class="line">	)</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#方式二：</span><br><span class="line">#①各部门的平均工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"></span><br><span class="line">#②求出最低平均工资的部门编号</span><br><span class="line"><span class="keyword">SELECT</span> department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">AVG</span>(salary) </span><br><span class="line">LIMIT <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">#③查询部门信息</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> departments</span><br><span class="line"><span class="keyword">WHERE</span> department_id<span class="operator">=</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> department_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">AVG</span>(salary) </span><br><span class="line">	LIMIT <span class="number">1</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># <span class="number">3.</span> 查询平均工资最低的部门信息和该部门的平均工资</span><br><span class="line">#①各部门的平均工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line">#②求出最低平均工资的部门编号</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">AVG</span>(salary) </span><br><span class="line">LIMIT <span class="number">1</span>;</span><br><span class="line">#③查询部门信息</span><br><span class="line"><span class="keyword">SELECT</span> d.<span class="operator">*</span>,ag</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">JOIN</span> (</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) ag,department_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">AVG</span>(salary) </span><br><span class="line">	LIMIT <span class="number">1</span></span><br><span class="line"></span><br><span class="line">) ag_dep</span><br><span class="line"><span class="keyword">ON</span> d.`department_id`<span class="operator">=</span>ag_dep.department_id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># <span class="number">4.</span> 查询平均工资最高的 job 信息</span><br><span class="line">#①查询最高的job的平均工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),job_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">AVG</span>(salary) <span class="keyword">DESC</span></span><br><span class="line">LIMIT <span class="number">1</span></span><br><span class="line"></span><br><span class="line">#②查询job信息</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span> jobs</span><br><span class="line"><span class="keyword">WHERE</span> job_id<span class="operator">=</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> job_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">AVG</span>(salary) <span class="keyword">DESC</span></span><br><span class="line">	LIMIT <span class="number">1</span></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"># <span class="number">5.</span> 查询平均工资高于公司平均工资的部门有哪些?</span><br><span class="line"></span><br><span class="line">#①查询平均工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary)</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line">#②查询每个部门的平均工资</span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"></span><br><span class="line">#③筛选②结果集，满足平均工资<span class="operator">&gt;</span>①</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">AVG</span>(salary)<span class="operator">&gt;</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary)</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"># <span class="number">6.</span> 查询出公司中所有 manager 的详细信息.</span><br><span class="line">#①查询所有manager的员工编号</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> manager_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line">#②查询详细信息，满足employee_id<span class="operator">=</span>①</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span></span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> employee_id <span class="operator">=</span><span class="keyword">ANY</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> manager_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"># <span class="number">7.</span> 各个部门中 最高工资中最低的那个部门的 最低工资是多少</span><br><span class="line"></span><br><span class="line">#①查询各部门的最高工资中最低的部门编号</span><br><span class="line"><span class="keyword">SELECT</span> department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">MAX</span>(salary)</span><br><span class="line">LIMIT <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#②查询①结果的那个部门的最低工资</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MIN</span>(salary) ,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> department_id<span class="operator">=</span>(</span><br><span class="line">	<span class="keyword">SELECT</span> department_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line">	<span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">MAX</span>(salary)</span><br><span class="line">	LIMIT <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"># <span class="number">8.</span> 查询平均工资最高的部门的 manager 的详细信息: last_name, department_id, email, salary</span><br><span class="line">#①查询平均工资最高的部门编号</span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    department_id </span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    employees </span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">AVG</span>(salary) <span class="keyword">DESC</span> </span><br><span class="line">LIMIT <span class="number">1</span> </span><br><span class="line"></span><br><span class="line">#②将employees和departments连接查询，筛选条件是①</span><br><span class="line">    <span class="keyword">SELECT</span> </span><br><span class="line">        last_name, d.department_id, email, salary </span><br><span class="line">    <span class="keyword">FROM</span></span><br><span class="line">        employees e </span><br><span class="line">        <span class="keyword">INNER</span> <span class="keyword">JOIN</span> departments d </span><br><span class="line">            <span class="keyword">ON</span> d.manager_id <span class="operator">=</span> e.employee_id </span><br><span class="line">    <span class="keyword">WHERE</span> d.department_id <span class="operator">=</span> </span><br><span class="line">        (<span class="keyword">SELECT</span> </span><br><span class="line">            department_id </span><br><span class="line">        <span class="keyword">FROM</span></span><br><span class="line">            employees </span><br><span class="line">        <span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id </span><br><span class="line">        <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="built_in">AVG</span>(salary) <span class="keyword">DESC</span> </span><br><span class="line">        LIMIT <span class="number">1</span>) ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222</span></span><br></pre></td></tr></table></figure>

<h4 id="2-3-分页查询"><a href="#2-3-分页查询" class="headerlink" title="2.3 分页查询"></a>2.3 分页查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">#进阶<span class="number">8</span>：分页查询 ★</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">应用场景：当要显示的数据，一页显示不全，需要分页提交sql请求</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">	select 查询列表</span></span><br><span class="line"><span class="comment">	from 表</span></span><br><span class="line"><span class="comment">	【join type join 表2</span></span><br><span class="line"><span class="comment">	on 连接条件</span></span><br><span class="line"><span class="comment">	where 筛选条件</span></span><br><span class="line"><span class="comment">	group by 分组字段</span></span><br><span class="line"><span class="comment">	having 分组后的筛选</span></span><br><span class="line"><span class="comment">	order by 排序的字段】</span></span><br><span class="line"><span class="comment">	limit 【offset,】size;</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	offset要显示条目的起始索引（起始索引从0开始）</span></span><br><span class="line"><span class="comment">	size 要显示的条目个数</span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment">	①limit语句放在查询语句的最后</span></span><br><span class="line"><span class="comment">	②公式</span></span><br><span class="line"><span class="comment">	要显示的页数 page，每页的条目数size</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	select 查询列表</span></span><br><span class="line"><span class="comment">	from 表</span></span><br><span class="line"><span class="comment">	limit (page-1)*size,size;</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	size=10</span></span><br><span class="line"><span class="comment">	page  </span></span><br><span class="line"><span class="comment">	1	0</span></span><br><span class="line"><span class="comment">	2  	10</span></span><br><span class="line"><span class="comment">	3	20</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#案例<span class="number">1</span>：查询前五条员工信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span>  employees LIMIT <span class="number">0</span>,<span class="number">5</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span>  employees LIMIT <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：查询第<span class="number">11</span>条——第<span class="number">25</span>条</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span>  employees LIMIT <span class="number">10</span>,<span class="number">15</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">3</span>：有奖金的员工信息，并且工资较高的前<span class="number">10</span>名显示出来</span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    <span class="operator">*</span> </span><br><span class="line"><span class="keyword">FROM</span></span><br><span class="line">    employees </span><br><span class="line"><span class="keyword">WHERE</span> commission_pct <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> </span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> salary <span class="keyword">DESC</span> </span><br><span class="line">LIMIT <span class="number">10</span> ;</span><br><span class="line"><span class="number">12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152</span></span><br></pre></td></tr></table></figure>

<h4 id="2-4-联合查询"><a href="#2-4-联合查询" class="headerlink" title="2.4 联合查询"></a>2.4 联合查询</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">#进阶<span class="number">9</span>：联合查询</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">union 联合 合并：将多条查询语句的结果合并成一个结果</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">查询语句1</span></span><br><span class="line"><span class="comment">union</span></span><br><span class="line"><span class="comment">查询语句2</span></span><br><span class="line"><span class="comment">union</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">应用场景：</span></span><br><span class="line"><span class="comment">要查询的结果来自于多个表，且多个表没有直接的连接关系，但查询的信息一致时</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">特点：★</span></span><br><span class="line"><span class="comment">1、要求多条查询语句的查询列数是一致的！</span></span><br><span class="line"><span class="comment">2、要求多条查询语句的查询的每一列的类型和顺序最好一致</span></span><br><span class="line"><span class="comment">3、union关键字默认去重，如果使用union all 可以包含重复项</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#引入的案例：查询部门编号<span class="operator">&gt;</span><span class="number">90</span>或邮箱包含a的员工信息</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> email <span class="keyword">LIKE</span> <span class="string">&#x27;%a%&#x27;</span> <span class="keyword">OR</span> department_id<span class="operator">&gt;</span><span class="number">90</span>;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees  <span class="keyword">WHERE</span> email <span class="keyword">LIKE</span> <span class="string">&#x27;%a%&#x27;</span></span><br><span class="line"><span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees  <span class="keyword">WHERE</span> department_id<span class="operator">&gt;</span><span class="number">90</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例：查询中国用户中男性的信息以及外国用户中年男性的用户信息</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> id,cname <span class="keyword">FROM</span> t_ca <span class="keyword">WHERE</span> csex<span class="operator">=</span><span class="string">&#x27;男&#x27;</span></span><br><span class="line"><span class="keyword">UNION</span> <span class="keyword">ALL</span></span><br><span class="line"><span class="keyword">SELECT</span> t_id,tname <span class="keyword">FROM</span> t_ua <span class="keyword">WHERE</span> tGender<span class="operator">=</span><span class="string">&#x27;male&#x27;</span>;</span><br><span class="line"><span class="number">12345678910111213141516171819202122232425262728293031323334353637</span></span><br></pre></td></tr></table></figure>

<h4 id="2-5-select语句总结"><a href="#2-5-select语句总结" class="headerlink" title="2.5 select语句总结"></a>2.5 select语句总结</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">select 字段</span><br><span class="line">from 表名</span><br><span class="line">where …….</span><br><span class="line">group by ……..</span><br><span class="line">having …….(就是为了过滤分组后的数据而存在的—不可以单独的出现)</span><br><span class="line">order by ……..</span><br><span class="line">以上语句的执行顺序</span><br><span class="line">1.首先执行where语句过滤原始数据</span><br><span class="line">2.执行group by进行分组</span><br><span class="line">3.执行having对分组数据进行操作</span><br><span class="line">4.执行select选出数据</span><br><span class="line">5.执行order by排序</span><br><span class="line">注意:原则：能在where中过滤的数据，尽量在where中过滤,效率较高.</span><br><span class="line">having的过滤是专门对分组之后的数据进行过滤的。</span><br><span class="line">1234567891011121314</span><br></pre></td></tr></table></figure>

<h4 id="2-6-数据的增删改"><a href="#2-6-数据的增删改" class="headerlink" title="2.6 数据的增删改"></a>2.6 数据的增删改</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br></pre></td><td class="code"><pre><span class="line">#DML语言</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">数据操作语言：</span></span><br><span class="line"><span class="comment">插入：insert</span></span><br><span class="line"><span class="comment">修改：update</span></span><br><span class="line"><span class="comment">删除：delete</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#一、插入语句</span><br><span class="line">#方式一：经典的插入</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">insert into 表名(列名,...) values(值1,...);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> beauty;</span><br><span class="line">#<span class="number">1.</span>插入的值的类型要与列的类型一致或兼容</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty(id,NAME,sex,borndate,phone,photo,boyfriend_id)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">13</span>,<span class="string">&#x27;唐艺昕&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1990-4-23&#x27;</span>,<span class="string">&#x27;1898888888&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>不可以为<span class="keyword">null</span>的列必须插入值。可以为<span class="keyword">null</span>的列如何插入值？</span><br><span class="line">#方式一：</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty(id,NAME,sex,borndate,phone,photo,boyfriend_id)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">13</span>,<span class="string">&#x27;唐艺昕&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1990-4-23&#x27;</span>,<span class="string">&#x27;1898888888&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">#方式二：</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty(id,NAME,sex,phone)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">15</span>,<span class="string">&#x27;娜扎&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1388888888&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>列的顺序是否可以调换</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty(NAME,sex,id,phone)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;蒋欣&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">16</span>,<span class="string">&#x27;110&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>列数和值的个数必须一致</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty(NAME,sex,id,phone)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;关晓彤&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="number">17</span>,<span class="string">&#x27;110&#x27;</span>);</span><br><span class="line"></span><br><span class="line">#<span class="number">5.</span>可以省略列名，默认所有列，而且列的顺序和表中列的顺序一致</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">18</span>,<span class="string">&#x27;张飞&#x27;</span>,<span class="string">&#x27;男&#x27;</span>,<span class="keyword">NULL</span>,<span class="string">&#x27;119&#x27;</span>,<span class="keyword">NULL</span>,<span class="keyword">NULL</span>);</span><br><span class="line"></span><br><span class="line">#方式二：</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">insert into 表名</span></span><br><span class="line"><span class="comment">set 列名=值,列名=值,...</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty</span><br><span class="line"><span class="keyword">SET</span> id<span class="operator">=</span><span class="number">19</span>,NAME<span class="operator">=</span><span class="string">&#x27;刘涛&#x27;</span>,phone<span class="operator">=</span><span class="string">&#x27;999&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#两种方式大pk ★</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">1</span>、方式一支持插入多行,方式二不支持</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">23</span>,<span class="string">&#x27;唐艺昕1&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1990-4-23&#x27;</span>,<span class="string">&#x27;1898888888&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">2</span>)</span><br><span class="line">,(<span class="number">24</span>,<span class="string">&#x27;唐艺昕2&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1990-4-23&#x27;</span>,<span class="string">&#x27;1898888888&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">2</span>)</span><br><span class="line">,(<span class="number">25</span>,<span class="string">&#x27;唐艺昕3&#x27;</span>,<span class="string">&#x27;女&#x27;</span>,<span class="string">&#x27;1990-4-23&#x27;</span>,<span class="string">&#x27;1898888888&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">#<span class="number">2</span>、方式一支持子查询，方式二不支持</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty(id,NAME,phone)</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">26</span>,<span class="string">&#x27;宋茜&#x27;</span>,<span class="string">&#x27;11809866&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> beauty(id,NAME,phone)</span><br><span class="line"><span class="keyword">SELECT</span> id,boyname,<span class="string">&#x27;1234567&#x27;</span></span><br><span class="line"><span class="keyword">FROM</span> boys <span class="keyword">WHERE</span> id<span class="operator">&lt;</span><span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">#二、修改语句</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1.修改单表的记录★</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">update 表名</span></span><br><span class="line"><span class="comment">set 列=新值,列=新值,...</span></span><br><span class="line"><span class="comment">where 筛选条件;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2.修改多表的记录【补充】</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">sql92语法：</span></span><br><span class="line"><span class="comment">update 表1 别名,表2 别名</span></span><br><span class="line"><span class="comment">set 列=值,...</span></span><br><span class="line"><span class="comment">where 连接条件</span></span><br><span class="line"><span class="comment">and 筛选条件;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">sql99语法：</span></span><br><span class="line"><span class="comment">update 表1 别名</span></span><br><span class="line"><span class="comment">inner|left|right join 表2 别名</span></span><br><span class="line"><span class="comment">on 连接条件</span></span><br><span class="line"><span class="comment">set 列=值,...</span></span><br><span class="line"><span class="comment">where 筛选条件;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">1.</span>修改单表的记录</span><br><span class="line">#案例<span class="number">1</span>：修改beauty表中姓唐的女神的电话为<span class="number">13899888899</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> beauty <span class="keyword">SET</span> phone <span class="operator">=</span> <span class="string">&#x27;13899888899&#x27;</span></span><br><span class="line"><span class="keyword">WHERE</span> NAME <span class="keyword">LIKE</span> <span class="string">&#x27;唐%&#x27;</span>;</span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：修改boys表中id好为<span class="number">2</span>的名称为张飞，魅力值 <span class="number">10</span></span><br><span class="line"><span class="keyword">UPDATE</span> boys <span class="keyword">SET</span> boyname<span class="operator">=</span><span class="string">&#x27;张飞&#x27;</span>,usercp<span class="operator">=</span><span class="number">10</span></span><br><span class="line"><span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">2</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>修改多表的记录</span><br><span class="line"></span><br><span class="line">#案例 <span class="number">1</span>：修改张无忌的女朋友的手机号为<span class="number">114</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> boys bo</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> beauty b <span class="keyword">ON</span> bo.`id`<span class="operator">=</span>b.`boyfriend_id`</span><br><span class="line"><span class="keyword">SET</span> b.`phone`<span class="operator">=</span><span class="string">&#x27;119&#x27;</span>,bo.`userCP`<span class="operator">=</span><span class="number">1000</span></span><br><span class="line"><span class="keyword">WHERE</span> bo.`boyName`<span class="operator">=</span><span class="string">&#x27;张无忌&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：修改没有男朋友的女神的男朋友编号都为<span class="number">2</span>号</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> boys bo</span><br><span class="line"><span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> beauty b <span class="keyword">ON</span> bo.`id`<span class="operator">=</span>b.`boyfriend_id`</span><br><span class="line"><span class="keyword">SET</span> b.`boyfriend_id`<span class="operator">=</span><span class="number">2</span></span><br><span class="line"><span class="keyword">WHERE</span> bo.`id` <span class="keyword">IS</span> <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> boys;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#三、删除语句</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">方式一：delete</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1、单表的删除【★】</span></span><br><span class="line"><span class="comment">delete from 表名 where 筛选条件</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2、多表的删除【补充】</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">sql92语法：</span></span><br><span class="line"><span class="comment">delete 表1的别名,表2的别名</span></span><br><span class="line"><span class="comment">from 表1 别名,表2 别名</span></span><br><span class="line"><span class="comment">where 连接条件</span></span><br><span class="line"><span class="comment">and 筛选条件;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">sql99语法：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">delete 表1的别名,表2的别名</span></span><br><span class="line"><span class="comment">from 表1 别名</span></span><br><span class="line"><span class="comment">inner|left|right join 表2 别名 on 连接条件</span></span><br><span class="line"><span class="comment">where 筛选条件;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">方式二：truncate</span></span><br><span class="line"><span class="comment">语法：truncate table 表名;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#方式一：<span class="keyword">delete</span></span><br><span class="line">#<span class="number">1.</span>单表的删除</span><br><span class="line">#案例：删除手机号以<span class="number">9</span>结尾的女神信息</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> beauty <span class="keyword">WHERE</span> phone <span class="keyword">LIKE</span> <span class="string">&#x27;%9&#x27;</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> beauty;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>多表的删除</span><br><span class="line"></span><br><span class="line">#案例：删除张无忌的女朋友的信息</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> b</span><br><span class="line"><span class="keyword">FROM</span> beauty b</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> boys bo <span class="keyword">ON</span> b.`boyfriend_id` <span class="operator">=</span> bo.`id`</span><br><span class="line"><span class="keyword">WHERE</span> bo.`boyName`<span class="operator">=</span><span class="string">&#x27;张无忌&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例：删除黄晓明的信息以及他女朋友的信息</span><br><span class="line"><span class="keyword">DELETE</span> b,bo</span><br><span class="line"><span class="keyword">FROM</span> beauty b</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> boys bo <span class="keyword">ON</span> b.`boyfriend_id`<span class="operator">=</span>bo.`id`</span><br><span class="line"><span class="keyword">WHERE</span> bo.`boyName`<span class="operator">=</span><span class="string">&#x27;黄晓明&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#方式二：<span class="keyword">truncate</span>语句</span><br><span class="line"></span><br><span class="line">#案例：将魅力值<span class="operator">&gt;</span><span class="number">100</span>的男神信息删除</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> boys ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="keyword">delete</span> pk <span class="keyword">truncate</span>【面试题★】</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">1.delete 可以加where 条件，truncate不能加</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2.truncate删除，效率高一丢丢</span></span><br><span class="line"><span class="comment">3.假如要删除的表中有自增长列，</span></span><br><span class="line"><span class="comment">如果用delete删除后，再插入数据，自增长列的值从断点开始，</span></span><br><span class="line"><span class="comment">而truncate删除后，再插入数据，自增长列的值从1开始。</span></span><br><span class="line"><span class="comment">4.truncate删除没有返回值，delete删除有返回值</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">5.truncate删除不能回滚，delete删除可以回滚.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> boys;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> boys;</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> boys;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> boys (boyname,usercp)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">&#x27;张飞&#x27;</span>,<span class="number">100</span>),(<span class="string">&#x27;刘备&#x27;</span>,<span class="number">100</span>),(<span class="string">&#x27;关云长&#x27;</span>,<span class="number">100</span>);</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229</span></span><br></pre></td></tr></table></figure>

<h5 id="2-6-1-案例数据的增删改"><a href="#2-6-1-案例数据的增删改" class="headerlink" title="2.6.1 案例数据的增删改"></a>2.6.1 案例数据的增删改</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1.</span>	运行以下脚本创建表my_employees</span><br><span class="line"></span><br><span class="line">USE myemployees;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> my_employees(</span><br><span class="line">	Id <span class="type">INT</span>(<span class="number">10</span>),</span><br><span class="line">	First_name <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	Last_name <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	Userid <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	Salary <span class="keyword">DOUBLE</span>(<span class="number">10</span>,<span class="number">2</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users(</span><br><span class="line">	id <span class="type">INT</span>,</span><br><span class="line">	userid <span class="type">VARCHAR</span>(<span class="number">10</span>),</span><br><span class="line">	department_id <span class="type">INT</span></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line">#<span class="number">2.</span>	显示表my_employees的结构</span><br><span class="line"><span class="keyword">DESC</span> my_employees;</span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>	向my_employees表中插入下列数据</span><br><span class="line">ID	FIRST_NAME	LAST_NAME	USERID	SALARY</span><br><span class="line"><span class="number">1</span>	patel		Ralph		Rpatel	<span class="number">895</span></span><br><span class="line"><span class="number">2</span>	Dancs		Betty		Bdancs	<span class="number">860</span></span><br><span class="line"><span class="number">3</span>	Biri		Ben		Bbiri	<span class="number">1100</span></span><br><span class="line"><span class="number">4</span>	Newman		Chad		Cnewman	<span class="number">750</span></span><br><span class="line"><span class="number">5</span>	Ropeburn	Audrey		Aropebur	<span class="number">1550</span></span><br><span class="line"></span><br><span class="line">#方式一：</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_employees</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">&#x27;patel&#x27;</span>,<span class="string">&#x27;Ralph&#x27;</span>,<span class="string">&#x27;Rpatel&#x27;</span>,<span class="number">895</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">&#x27;Dancs&#x27;</span>,<span class="string">&#x27;Betty&#x27;</span>,<span class="string">&#x27;Bdancs&#x27;</span>,<span class="number">860</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="string">&#x27;Biri&#x27;</span>,<span class="string">&#x27;Ben&#x27;</span>,<span class="string">&#x27;Bbiri&#x27;</span>,<span class="number">1100</span>),</span><br><span class="line">(<span class="number">4</span>,<span class="string">&#x27;Newman&#x27;</span>,<span class="string">&#x27;Chad&#x27;</span>,<span class="string">&#x27;Cnewman&#x27;</span>,<span class="number">750</span>),</span><br><span class="line">(<span class="number">5</span>,<span class="string">&#x27;Ropeburn&#x27;</span>,<span class="string">&#x27;Audrey&#x27;</span>,<span class="string">&#x27;Aropebur&#x27;</span>,<span class="number">1550</span>);</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> my_employees;</span><br><span class="line">#方式二：</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> my_employees</span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span>,<span class="string">&#x27;patel&#x27;</span>,<span class="string">&#x27;Ralph&#x27;</span>,<span class="string">&#x27;Rpatel&#x27;</span>,<span class="number">895</span> <span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">2</span>,<span class="string">&#x27;Dancs&#x27;</span>,<span class="string">&#x27;Betty&#x27;</span>,<span class="string">&#x27;Bdancs&#x27;</span>,<span class="number">860</span> <span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">3</span>,<span class="string">&#x27;Biri&#x27;</span>,<span class="string">&#x27;Ben&#x27;</span>,<span class="string">&#x27;Bbiri&#x27;</span>,<span class="number">1100</span> <span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">4</span>,<span class="string">&#x27;Newman&#x27;</span>,<span class="string">&#x27;Chad&#x27;</span>,<span class="string">&#x27;Cnewman&#x27;</span>,<span class="number">750</span> <span class="keyword">UNION</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="number">5</span>,<span class="string">&#x27;Ropeburn&#x27;</span>,<span class="string">&#x27;Audrey&#x27;</span>,<span class="string">&#x27;Aropebur&#x27;</span>,<span class="number">1550</span>;</span><br><span class="line"></span><br><span class="line">				</span><br><span class="line">#<span class="number">4.</span>	 向users表中插入数据</span><br><span class="line"><span class="number">1</span>	Rpatel	<span class="number">10</span></span><br><span class="line"><span class="number">2</span>	Bdancs	<span class="number">10</span></span><br><span class="line"><span class="number">3</span>	Bbiri	<span class="number">20</span></span><br><span class="line"><span class="number">4</span>	Cnewman	<span class="number">30</span></span><br><span class="line"><span class="number">5</span>	Aropebur	<span class="number">40</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> users</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">1</span>,<span class="string">&#x27;Rpatel&#x27;</span>,<span class="number">10</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">&#x27;Bdancs&#x27;</span>,<span class="number">10</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="string">&#x27;Bbiri&#x27;</span>,<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">5.</span>将<span class="number">3</span>号员工的last_name修改为“drelxer”</span><br><span class="line"><span class="keyword">UPDATE</span> my_employees <span class="keyword">SET</span> last_name<span class="operator">=</span><span class="string">&#x27;drelxer&#x27;</span> <span class="keyword">WHERE</span> id <span class="operator">=</span> <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">6.</span>将所有工资少于<span class="number">900</span>的员工的工资修改为<span class="number">1000</span></span><br><span class="line"><span class="keyword">UPDATE</span> my_employees <span class="keyword">SET</span> salary<span class="operator">=</span><span class="number">1000</span> <span class="keyword">WHERE</span> salary<span class="operator">&lt;</span><span class="number">900</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">7.</span>将userid 为Bbiri的<span class="keyword">user</span>表和my_employees表的记录全部删除</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> u,e</span><br><span class="line"><span class="keyword">FROM</span> users u</span><br><span class="line"><span class="keyword">JOIN</span> my_employees e <span class="keyword">ON</span> u.`userid`<span class="operator">=</span>e.`Userid`</span><br><span class="line"><span class="keyword">WHERE</span> u.`userid`<span class="operator">=</span><span class="string">&#x27;Bbiri&#x27;</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">8.</span>删除所有数据</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> my_employees;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> users;</span><br><span class="line">#<span class="number">9.</span>检查所作的修正</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> my_employees;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users;</span><br><span class="line"></span><br><span class="line">#<span class="number">10.</span>清空表my_employees</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> my_employees;</span><br><span class="line"><span class="number">1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586</span></span><br></pre></td></tr></table></figure>

<h4 id="2-7-库和表的管理"><a href="#2-7-库和表的管理" class="headerlink" title="2.7 库和表的管理"></a>2.7 库和表的管理</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br></pre></td><td class="code"><pre><span class="line">#DDL</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">数据定义语言</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">库和表的管理</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">一、库的管理</span></span><br><span class="line"><span class="comment">创建、修改、删除</span></span><br><span class="line"><span class="comment">二、表的管理</span></span><br><span class="line"><span class="comment">创建、修改、删除</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">创建： create</span></span><br><span class="line"><span class="comment">修改： alter</span></span><br><span class="line"><span class="comment">删除： drop</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#一、库的管理</span><br><span class="line">#<span class="number">1</span>、库的创建</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">create database  [if not exists]库名;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例：创建库Books</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> books ;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2</span>、库的修改</span><br><span class="line"></span><br><span class="line">RENAME DATABASE books <span class="keyword">TO</span> 新库名;</span><br><span class="line"></span><br><span class="line">#更改库的字符集</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> DATABASE books <span class="type">CHARACTER</span> <span class="keyword">SET</span> gbk;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3</span>、库的删除</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> DATABASE IF <span class="keyword">EXISTS</span> books;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#二、表的管理</span><br><span class="line">#<span class="number">1.</span>表的创建 ★</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">create table 表名(</span></span><br><span class="line"><span class="comment">	列名 列的类型【(长度) 约束】,</span></span><br><span class="line"><span class="comment">	列名 列的类型【(长度) 约束】,</span></span><br><span class="line"><span class="comment">	列名 列的类型【(长度) 约束】,</span></span><br><span class="line"><span class="comment">	...</span></span><br><span class="line"><span class="comment">	列名 列的类型【(长度) 约束】</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#案例：创建表Book</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> book(</span><br><span class="line">	id <span class="type">INT</span>,#编号</span><br><span class="line">	bName <span class="type">VARCHAR</span>(<span class="number">20</span>),#图书名</span><br><span class="line">	price <span class="keyword">DOUBLE</span>,#价格</span><br><span class="line">	authorId  <span class="type">INT</span>,#作者编号</span><br><span class="line">	publishDate DATETIME#出版日期</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> book;</span><br><span class="line"></span><br><span class="line">#案例：创建表author</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> author(</span><br><span class="line">	id <span class="type">INT</span>,</span><br><span class="line">	au_name <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	nation <span class="type">VARCHAR</span>(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"><span class="keyword">DESC</span> author;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>表的修改</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法</span></span><br><span class="line"><span class="comment">alter table 表名 add|drop|modify|change column 列名 【列类型 约束】;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#①修改列名</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> book CHANGE <span class="keyword">COLUMN</span> publishdate pubDate DATETIME;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#②修改列的类型或约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> book MODIFY <span class="keyword">COLUMN</span> pubdate <span class="type">TIMESTAMP</span>;</span><br><span class="line"></span><br><span class="line">#③添加新列</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> author <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> annual <span class="keyword">DOUBLE</span>; </span><br><span class="line"></span><br><span class="line">#④删除列</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> book_author <span class="keyword">DROP</span> <span class="keyword">COLUMN</span>  annual;</span><br><span class="line">#⑤修改表名</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> author RENAME <span class="keyword">TO</span> book_author;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> book;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>表的删除</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> book_author;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> TABLES;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#通用的写法：</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> DATABASE IF <span class="keyword">EXISTS</span> 旧库名;</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE 新库名;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> 旧表名;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span>  表名();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>表的复制</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> author <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>,<span class="string">&#x27;村上春树&#x27;</span>,<span class="string">&#x27;日本&#x27;</span>),</span><br><span class="line">(<span class="number">2</span>,<span class="string">&#x27;莫言&#x27;</span>,<span class="string">&#x27;中国&#x27;</span>),</span><br><span class="line">(<span class="number">3</span>,<span class="string">&#x27;冯唐&#x27;</span>,<span class="string">&#x27;中国&#x27;</span>),</span><br><span class="line">(<span class="number">4</span>,<span class="string">&#x27;金庸&#x27;</span>,<span class="string">&#x27;中国&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> Author;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> copy2;</span><br><span class="line">#<span class="number">1.</span>仅仅复制表的结构</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">copy</span> <span class="keyword">LIKE</span> author;</span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>复制表的结构<span class="operator">+</span>数据</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> copy2 </span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> author;</span><br><span class="line"></span><br><span class="line">#只复制部分数据</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> copy3</span><br><span class="line"><span class="keyword">SELECT</span> id,au_name</span><br><span class="line"><span class="keyword">FROM</span> author </span><br><span class="line"><span class="keyword">WHERE</span> nation<span class="operator">=</span><span class="string">&#x27;中国&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#仅仅复制某些字段</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> copy4 </span><br><span class="line"><span class="keyword">SELECT</span> id,au_name</span><br><span class="line"><span class="keyword">FROM</span> author</span><br><span class="line"><span class="keyword">WHERE</span> <span class="number">0</span>;</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170</span></span><br></pre></td></tr></table></figure>

<h5 id="2-7-1-案例库和表的管理"><a href="#2-7-1-案例库和表的管理" class="headerlink" title="2.7.1 案例库和表的管理"></a>2.7.1 案例库和表的管理</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1.</span>	创建表dept1</span><br><span class="line">NAME	<span class="keyword">NULL</span>?	TYPE</span><br><span class="line">id		<span class="type">INT</span>(<span class="number">7</span>)</span><br><span class="line">NAME		<span class="type">VARCHAR</span>(<span class="number">25</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">USE test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dept1(</span><br><span class="line">	id <span class="type">INT</span>(<span class="number">7</span>),</span><br><span class="line">	NAME <span class="type">VARCHAR</span>(<span class="number">25</span>)</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line">#<span class="number">2.</span>	将表departments中的数据插入新表dept2中</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> dept2</span><br><span class="line"><span class="keyword">SELECT</span> department_id,department_name</span><br><span class="line"><span class="keyword">FROM</span> myemployees.departments;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>	创建表emp5</span><br><span class="line">NAME	<span class="keyword">NULL</span>?	TYPE</span><br><span class="line">id		<span class="type">INT</span>(<span class="number">7</span>)</span><br><span class="line">First_name	<span class="type">VARCHAR</span> (<span class="number">25</span>)</span><br><span class="line">Last_name	<span class="type">VARCHAR</span>(<span class="number">25</span>)</span><br><span class="line">Dept_id		<span class="type">INT</span>(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> emp5(</span><br><span class="line">id <span class="type">INT</span>(<span class="number">7</span>),</span><br><span class="line">first_name <span class="type">VARCHAR</span>(<span class="number">25</span>),</span><br><span class="line">last_name <span class="type">VARCHAR</span>(<span class="number">25</span>),</span><br><span class="line">dept_id <span class="type">INT</span>(<span class="number">7</span>)</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>	将列Last_name的长度增加到<span class="number">50</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp5 MODIFY <span class="keyword">COLUMN</span> last_name <span class="type">VARCHAR</span>(<span class="number">50</span>);</span><br><span class="line">#<span class="number">5.</span>	根据表employees创建employees2</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> employees2 <span class="keyword">LIKE</span> myemployees.employees;</span><br><span class="line"></span><br><span class="line">#<span class="number">6.</span>	删除表emp5</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> emp5;</span><br><span class="line"></span><br><span class="line">#<span class="number">7.</span>	将表employees2重命名为emp5</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> employees2 RENAME <span class="keyword">TO</span> emp5;</span><br><span class="line"></span><br><span class="line">#<span class="number">8.</span>在表dept和emp5中添加新列test_column，并检查所作的操作</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp5 <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> test_column <span class="type">INT</span>;</span><br><span class="line">#<span class="number">9.</span>直接删除表emp5中的列 dept_id</span><br><span class="line"><span class="keyword">DESC</span> emp5;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp5 <span class="keyword">DROP</span> <span class="keyword">COLUMN</span> test_column;</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657</span></span><br></pre></td></tr></table></figure>

<h4 id="2-8-数据类型"><a href="#2-8-数据类型" class="headerlink" title="2.8 数据类型"></a>2.8 数据类型</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br></pre></td><td class="code"><pre><span class="line">#常见的数据类型</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">数值型：</span></span><br><span class="line"><span class="comment">	整型</span></span><br><span class="line"><span class="comment">	小数：</span></span><br><span class="line"><span class="comment">		定点数</span></span><br><span class="line"><span class="comment">		浮点数</span></span><br><span class="line"><span class="comment">字符型：</span></span><br><span class="line"><span class="comment">	较短的文本：char、varchar</span></span><br><span class="line"><span class="comment">	较长的文本：text、blob（较长的二进制数据）</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">日期型：</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#一、整型</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">分类：</span></span><br><span class="line"><span class="comment">tinyint、smallint、mediumint、int/integer、bigint</span></span><br><span class="line"><span class="comment">1	 2		3	4		8</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment">① 如果不设置无符号还是有符号，默认是有符号，如果想设置无符号，需要添加unsigned关键字</span></span><br><span class="line"><span class="comment">② 如果插入的数值超出了整型的范围,会报out of range异常，并且插入临界值</span></span><br><span class="line"><span class="comment">③ 如果不设置长度，会有默认的长度</span></span><br><span class="line"><span class="comment">长度代表了显示的最大宽度，如果不够会用0在左边填充，但必须搭配zerofill使用！</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#<span class="number">1.</span>如何设置无符号和有符号</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> tab_int;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tab_int(</span><br><span class="line">	t1 <span class="type">INT</span>(<span class="number">7</span>) ZEROFILL,</span><br><span class="line">	t2 <span class="type">INT</span>(<span class="number">7</span>) ZEROFILL </span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> tab_int;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_int <span class="keyword">VALUES</span>(<span class="number">-123456</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_int <span class="keyword">VALUES</span>(<span class="number">-123456</span>,<span class="number">-123456</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_int <span class="keyword">VALUES</span>(<span class="number">2147483648</span>,<span class="number">4294967296</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_int <span class="keyword">VALUES</span>(<span class="number">123</span>,<span class="number">123</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tab_int;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#二、小数</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">分类：</span></span><br><span class="line"><span class="comment">1.浮点型</span></span><br><span class="line"><span class="comment">float(M,D)</span></span><br><span class="line"><span class="comment">double(M,D)</span></span><br><span class="line"><span class="comment">2.定点型</span></span><br><span class="line"><span class="comment">dec(M，D)</span></span><br><span class="line"><span class="comment">decimal(M,D)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">①</span></span><br><span class="line"><span class="comment">M：整数部位+小数部位</span></span><br><span class="line"><span class="comment">D：小数部位</span></span><br><span class="line"><span class="comment">如果超过范围，则插入临界值</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">②</span></span><br><span class="line"><span class="comment">M和D都可以省略</span></span><br><span class="line"><span class="comment">如果是decimal，则M默认为10，D默认为0</span></span><br><span class="line"><span class="comment">如果是float和double，则会根据插入的数值的精度来决定精度</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">③定点型的精确度较高，如果要求插入数值的精度较高如货币运算等则考虑使用</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#测试M和D</span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> tab_float;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tab_float(</span><br><span class="line">	f1 <span class="type">FLOAT</span>,</span><br><span class="line">	f2 <span class="keyword">DOUBLE</span>,</span><br><span class="line">	f3 <span class="type">DECIMAL</span></span><br><span class="line">);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tab_float;</span><br><span class="line"><span class="keyword">DESC</span> tab_float;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_float <span class="keyword">VALUES</span>(<span class="number">123.4523</span>,<span class="number">123.4523</span>,<span class="number">123.4523</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_float <span class="keyword">VALUES</span>(<span class="number">123.456</span>,<span class="number">123.456</span>,<span class="number">123.456</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_float <span class="keyword">VALUES</span>(<span class="number">123.4</span>,<span class="number">123.4</span>,<span class="number">123.4</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_float <span class="keyword">VALUES</span>(<span class="number">1523.4</span>,<span class="number">1523.4</span>,<span class="number">1523.4</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#原则：</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">所选择的类型越简单越好，能保存数值的类型越小越好</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#三、字符型</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">较短的文本：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">char</span></span><br><span class="line"><span class="comment">varchar</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">其他：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">binary和varbinary用于保存较短的二进制</span></span><br><span class="line"><span class="comment">enum用于保存枚举</span></span><br><span class="line"><span class="comment">set用于保存集合</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">较长的文本：</span></span><br><span class="line"><span class="comment">text</span></span><br><span class="line"><span class="comment">blob(较大的二进制)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	写法		M的意思					特点			空间的耗费	效率</span></span><br><span class="line"><span class="comment">char	char(M)		最大的字符数，可以省略，默认为1		固定长度的字符		比较耗费	高</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">varchar varchar(M)	最大的字符数，不可以省略		可变长度的字符		比较节省	低</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tab_char(</span><br><span class="line">	c1 ENUM(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_char <span class="keyword">VALUES</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_char <span class="keyword">VALUES</span>(<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_char <span class="keyword">VALUES</span>(<span class="string">&#x27;c&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_char <span class="keyword">VALUES</span>(<span class="string">&#x27;m&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_char <span class="keyword">VALUES</span>(<span class="string">&#x27;A&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tab_set;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tab_set(</span><br><span class="line"></span><br><span class="line">	s1 <span class="keyword">SET</span>(<span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;b&#x27;</span>,<span class="string">&#x27;c&#x27;</span>,<span class="string">&#x27;d&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_set <span class="keyword">VALUES</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_set <span class="keyword">VALUES</span>(<span class="string">&#x27;A,B&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_set <span class="keyword">VALUES</span>(<span class="string">&#x27;a,c,d&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#四、日期型</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">分类：</span></span><br><span class="line"><span class="comment">date只保存日期</span></span><br><span class="line"><span class="comment">time 只保存时间</span></span><br><span class="line"><span class="comment">year只保存年</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">datetime保存日期+时间</span></span><br><span class="line"><span class="comment">timestamp保存日期+时间</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		字节		范围		时区等的影响</span></span><br><span class="line"><span class="comment">datetime	               8		1000——9999	                  不受</span></span><br><span class="line"><span class="comment">timestamp	4	               1970-2038	                    受</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tab_date(</span><br><span class="line">	t1 DATETIME,</span><br><span class="line">	t2 <span class="type">TIMESTAMP</span></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_date <span class="keyword">VALUES</span>(NOW(),NOW());</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tab_date;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;time_zone&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> time_zone<span class="operator">=</span><span class="string">&#x27;+9:00&#x27;</span>;</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200</span></span><br></pre></td></tr></table></figure>

<h4 id="2-9-常见约束"><a href="#2-9-常见约束" class="headerlink" title="2.9 常见约束"></a>2.9 常见约束</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br></pre></td><td class="code"><pre><span class="line">#常见约束</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">含义：一种限制，用于限制表中的数据，为了保证表中的数据的准确和可靠性</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">分类：六大约束</span></span><br><span class="line"><span class="comment">	NOT NULL：非空，用于保证该字段的值不能为空</span></span><br><span class="line"><span class="comment">	比如姓名、学号等</span></span><br><span class="line"><span class="comment">	DEFAULT:默认，用于保证该字段有默认值</span></span><br><span class="line"><span class="comment">	比如性别</span></span><br><span class="line"><span class="comment">	PRIMARY KEY:主键，用于保证该字段的值具有唯一性，并且非空</span></span><br><span class="line"><span class="comment">	比如学号、员工编号等</span></span><br><span class="line"><span class="comment">	UNIQUE:唯一，用于保证该字段的值具有唯一性，可以为空</span></span><br><span class="line"><span class="comment">	比如座位号</span></span><br><span class="line"><span class="comment">	CHECK:检查约束【mysql中不支持】</span></span><br><span class="line"><span class="comment">	比如年龄、性别</span></span><br><span class="line"><span class="comment">	FOREIGN KEY:外键，用于限制两个表的关系，用于保证该字段的值必须来自于主表的关联列的值</span></span><br><span class="line"><span class="comment">		在从表添加外键约束，用于引用主表中某列的值</span></span><br><span class="line"><span class="comment">	比如学生表的专业编号，员工表的部门编号，员工表的工种编号</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">添加约束的时机：</span></span><br><span class="line"><span class="comment">	1.创建表时</span></span><br><span class="line"><span class="comment">	2.修改表时</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">约束的添加分类：</span></span><br><span class="line"><span class="comment">	列级约束：</span></span><br><span class="line"><span class="comment">		六大约束语法上都支持，但外键约束没有效果</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">	表级约束：</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		除了非空、默认，其他的都支持</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">		</span></span><br><span class="line"><span class="comment">主键和唯一的大对比：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">		保证唯一性  是否允许为空    一个表中可以有多少个   是否允许组合</span></span><br><span class="line"><span class="comment">	主键	√		×		至多有1个           √，但不推荐</span></span><br><span class="line"><span class="comment">	唯一	√		√		可以有多个          √，但不推荐</span></span><br><span class="line"><span class="comment">外键：</span></span><br><span class="line"><span class="comment">	1、要求在从表设置外键关系</span></span><br><span class="line"><span class="comment">	2、从表的外键列的类型和主表的关联列的类型要求一致或兼容，名称无要求</span></span><br><span class="line"><span class="comment">	3、主表的关联列必须是一个key（一般是主键或唯一）</span></span><br><span class="line"><span class="comment">	4、插入数据时，先插入主表，再插入从表</span></span><br><span class="line"><span class="comment">	删除数据时，先删除从表，再删除主表</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> 表名(</span><br><span class="line">	字段名 字段类型 列级约束,</span><br><span class="line">	字段名 字段类型,</span><br><span class="line">	表级约束</span><br><span class="line"></span><br><span class="line">)</span><br><span class="line"><span class="keyword">CREATE</span> DATABASE students;</span><br><span class="line">#一、创建表时添加约束</span><br><span class="line"></span><br><span class="line">#<span class="number">1.</span>添加列级约束</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">直接在字段名和类型后面追加 约束类型即可。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">只支持：默认、非空、主键、唯一</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">USE students;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> stuinfo;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> stuinfo(</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,#主键</span><br><span class="line">	stuName <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">UNIQUE</span>,#非空</span><br><span class="line">	gender <span class="type">CHAR</span>(<span class="number">1</span>) <span class="keyword">CHECK</span>(gender<span class="operator">=</span><span class="string">&#x27;男&#x27;</span> <span class="keyword">OR</span> gender <span class="operator">=</span><span class="string">&#x27;女&#x27;</span>),#检查</span><br><span class="line">	seat <span class="type">INT</span> <span class="keyword">UNIQUE</span>,#唯一</span><br><span class="line">	age <span class="type">INT</span> <span class="keyword">DEFAULT</span>  <span class="number">18</span>,#默认约束</span><br><span class="line">	majorId <span class="type">INT</span> <span class="keyword">REFERENCES</span> major(id)#外键</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> major(</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">	majorName <span class="type">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#查看stuinfo中的所有索引，包括主键、外键、唯一</span><br><span class="line"><span class="keyword">SHOW</span> INDEX <span class="keyword">FROM</span> stuinfo;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>添加表级约束</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">语法：在各个字段的最下面</span></span><br><span class="line"><span class="comment"> 【constraint 约束名】 约束类型(字段名) </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> stuinfo;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> stuinfo(</span><br><span class="line">	id <span class="type">INT</span>,</span><br><span class="line">	stuname <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	gender <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">	seat <span class="type">INT</span>,</span><br><span class="line">	age <span class="type">INT</span>,</span><br><span class="line">	majorid <span class="type">INT</span>,</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> pk <span class="keyword">PRIMARY</span> KEY(id),#主键</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> uq <span class="keyword">UNIQUE</span>(seat),#唯一键</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> ck <span class="keyword">CHECK</span>(gender <span class="operator">=</span><span class="string">&#x27;男&#x27;</span> <span class="keyword">OR</span> gender  <span class="operator">=</span> <span class="string">&#x27;女&#x27;</span>),#检查</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> fk_stuinfo_major <span class="keyword">FOREIGN</span> KEY(majorid) <span class="keyword">REFERENCES</span> major(id)#外键</span><br><span class="line">	</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> INDEX <span class="keyword">FROM</span> stuinfo;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#通用的写法：★</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> stuinfo(</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">	stuname <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	sex <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">	age <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">18</span>,</span><br><span class="line">	seat <span class="type">INT</span> <span class="keyword">UNIQUE</span>,</span><br><span class="line">	majorid <span class="type">INT</span>,</span><br><span class="line">	<span class="keyword">CONSTRAINT</span> fk_stuinfo_major <span class="keyword">FOREIGN</span> KEY(majorid) <span class="keyword">REFERENCES</span> major(id)</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#二、修改表时添加约束</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1、添加列级约束</span></span><br><span class="line"><span class="comment">alter table 表名 modify column 字段名 字段类型 新约束;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2、添加表级约束</span></span><br><span class="line"><span class="comment">alter table 表名 add 【constraint 约束名】 约束类型(字段名) 【外键的引用】;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> stuinfo;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> stuinfo(</span><br><span class="line">	id <span class="type">INT</span>,</span><br><span class="line">	stuname <span class="type">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	gender <span class="type">CHAR</span>(<span class="number">1</span>),</span><br><span class="line">	seat <span class="type">INT</span>,</span><br><span class="line">	age <span class="type">INT</span>,</span><br><span class="line">	majorid <span class="type">INT</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">DESC</span> stuinfo;</span><br><span class="line">#<span class="number">1.</span>添加非空约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo MODIFY <span class="keyword">COLUMN</span> stuname <span class="type">VARCHAR</span>(<span class="number">20</span>)  <span class="keyword">NOT</span> <span class="keyword">NULL</span>;</span><br><span class="line">#<span class="number">2.</span>添加默认约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo MODIFY <span class="keyword">COLUMN</span> age <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">18</span>;</span><br><span class="line">#<span class="number">3.</span>添加主键</span><br><span class="line">#①列级约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo MODIFY <span class="keyword">COLUMN</span> id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY;</span><br><span class="line">#②表级约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo <span class="keyword">ADD</span> <span class="keyword">PRIMARY</span> KEY(id);</span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>添加唯一</span><br><span class="line"></span><br><span class="line">#①列级约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo MODIFY <span class="keyword">COLUMN</span> seat <span class="type">INT</span> <span class="keyword">UNIQUE</span>;</span><br><span class="line">#②表级约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo <span class="keyword">ADD</span> <span class="keyword">UNIQUE</span>(seat);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">5.</span>添加外键</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_stuinfo_major <span class="keyword">FOREIGN</span> KEY(majorid) <span class="keyword">REFERENCES</span> major(id); </span><br><span class="line"></span><br><span class="line">#三、修改表时删除约束</span><br><span class="line"></span><br><span class="line">#<span class="number">1.</span>删除非空约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo MODIFY <span class="keyword">COLUMN</span> stuname <span class="type">VARCHAR</span>(<span class="number">20</span>) <span class="keyword">NULL</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>删除默认约束</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo MODIFY <span class="keyword">COLUMN</span> age <span class="type">INT</span> ;</span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>删除主键</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo <span class="keyword">DROP</span> <span class="keyword">PRIMARY</span> KEY;</span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>删除唯一</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo <span class="keyword">DROP</span> INDEX seat;</span><br><span class="line"></span><br><span class="line">#<span class="number">5.</span>删除外键</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo <span class="keyword">DROP</span> <span class="keyword">FOREIGN</span> KEY fk_stuinfo_major;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> INDEX <span class="keyword">FROM</span> stuinfo;</span><br><span class="line"></span><br><span class="line"># 方式一： 级联删除</span><br><span class="line"># 效果: 两个表中的数据都删除掉</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_stu_major <span class="keyword">FOREIGN</span> KEY(majorid) <span class="keyword">REFERENCES</span> major(id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> CASCADE;</span><br><span class="line"></span><br><span class="line"># 方式二: 级联置空</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> stuinfo <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_stu_major <span class="keyword">FOREIGN</span> KEY(majorid) <span class="keyword">REFERENCES</span> major(id) <span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">SET</span> <span class="keyword">NULL</span>;</span><br><span class="line"># 效果: 主表数据删除,外表相关字段置空</span><br><span class="line"></span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211</span></span><br></pre></td></tr></table></figure>

<h5 id="2-9-1-案例常见约束"><a href="#2-9-1-案例常见约束" class="headerlink" title="2.9.1 案例常见约束"></a>2.9.1 案例常见约束</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#<span class="number">1.</span>向表emp2的id列中添加<span class="keyword">PRIMARY</span> KEY约束（my_emp_id_pk）</span><br><span class="line"></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp2 MODIFY <span class="keyword">COLUMN</span> id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp2 <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> my_emp_id_pk <span class="keyword">PRIMARY</span> KEY(id);</span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>	向表dept2的id列中添加<span class="keyword">PRIMARY</span> KEY约束（my_dept_id_pk）</span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>	向表emp2中添加列dept_id，并在其中定义<span class="keyword">FOREIGN</span> KEY约束，与之相关联的列是dept2表中的id列。</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp2 <span class="keyword">ADD</span> <span class="keyword">COLUMN</span> dept_id <span class="type">INT</span>;</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> emp2 <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_emp2_dept2 <span class="keyword">FOREIGN</span> KEY(dept_id) <span class="keyword">REFERENCES</span> dept2(id);</span><br><span class="line"></span><br><span class="line">		位置		支持的约束类型			是否可以起约束名</span><br><span class="line">列级约束：	列的后面	语法都支持，但外键没有效果	不可以</span><br><span class="line">表级约束：	所有列的下面	默认和非空不支持，其他支持	可以（主键没有效果）</span><br><span class="line"><span class="number">1234567891011121314151617</span></span><br></pre></td></tr></table></figure>

<ul>
<li>标识列</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">#标识列</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">又称为自增长列</span></span><br><span class="line"><span class="comment">含义：可以不用手动的插入值，系统提供默认的序列值</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">特点：</span></span><br><span class="line"><span class="comment">1、标识列必须和主键搭配吗？不一定，但要求是一个key</span></span><br><span class="line"><span class="comment">2、一个表可以有几个标识列？至多一个！</span></span><br><span class="line"><span class="comment">3、标识列的类型只能是数值型</span></span><br><span class="line"><span class="comment">4、标识列可以通过 SET auto_increment_increment=3;设置步长</span></span><br><span class="line"><span class="comment">可以通过 手动插入值，设置起始值</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#一、创建表时设置标识列</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> tab_identity;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> tab_identity(</span><br><span class="line">	id <span class="type">INT</span>  ,</span><br><span class="line">	NAME <span class="type">FLOAT</span> <span class="keyword">UNIQUE</span> AUTO_INCREMENT,</span><br><span class="line">	seat <span class="type">INT</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> tab_identity;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_identity(id,NAME) <span class="keyword">VALUES</span>(<span class="keyword">NULL</span>,<span class="string">&#x27;john&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> tab_identity(NAME) <span class="keyword">VALUES</span>(<span class="string">&#x27;lucy&#x27;</span>);</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> tab_identity;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;%auto_increment%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> auto_increment_increment<span class="operator">=</span><span class="number">3</span>;</span><br><span class="line"></span><br><span class="line">#二、修改表时设置标识列</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tab_identity MODIFY <span class="keyword">COLUMN</span> id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT;</span><br><span class="line"></span><br><span class="line"># 三、修改表时删除标识列</span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> tab_identity MODIFY <span class="keyword">COLUMN</span> id <span class="type">INT</span>;</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445</span></span><br></pre></td></tr></table></figure>

<h4 id="3-1-事务"><a href="#3-1-事务" class="headerlink" title="3.1 事务"></a>3.1 事务</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br></pre></td><td class="code"><pre><span class="line">#TCL</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Transaction Control Language 事务控制语言</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">事务：</span></span><br><span class="line"><span class="comment">一个或一组sql语句组成一个执行单元，这个执行单元要么全部执行，要么全部不执行。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">案例：转账</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">张三丰  1000</span></span><br><span class="line"><span class="comment">郭襄	1000</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">update 表 set 张三丰的余额=500 where name=&#x27;张三丰&#x27;</span></span><br><span class="line"><span class="comment">意外</span></span><br><span class="line"><span class="comment">update 表 set 郭襄的余额=1500 where name=&#x27;郭襄&#x27;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">事务的特性：</span></span><br><span class="line"><span class="comment">ACID</span></span><br><span class="line"><span class="comment">原子性：一个事务不可再分割，要么都执行要么都不执行</span></span><br><span class="line"><span class="comment">一致性：一个事务执行会使数据从一个一致状态切换到另外一个一致状态</span></span><br><span class="line"><span class="comment">隔离性：一个事务的执行不受其他事务的干扰</span></span><br><span class="line"><span class="comment">持久性：一个事务一旦提交，则会永久的改变数据库的数据.</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">事务的创建</span></span><br><span class="line"><span class="comment">隐式事务：事务没有明显的开启和结束的标记</span></span><br><span class="line"><span class="comment">比如insert、update、delete语句</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">delete from 表 where id =1;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">显式事务：事务具有明显的开启和结束的标记</span></span><br><span class="line"><span class="comment">前提：必须先设置自动提交功能为禁用</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">set autocommit=0;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">步骤1：开启事务</span></span><br><span class="line"><span class="comment">set autocommit=0;</span></span><br><span class="line"><span class="comment">start transaction;可选的</span></span><br><span class="line"><span class="comment">步骤2：编写事务中的sql语句(select insert update delete)</span></span><br><span class="line"><span class="comment">语句1;</span></span><br><span class="line"><span class="comment">语句2;</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">步骤3：结束事务</span></span><br><span class="line"><span class="comment">commit;提交事务</span></span><br><span class="line"><span class="comment">rollback;回滚事务</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">savepoint 节点名;设置保存点</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">事务的隔离级别：</span></span><br><span class="line"><span class="comment">		        脏读 不可重复读 幻读</span></span><br><span class="line"><span class="comment">read uncommitted：√		√		√</span></span><br><span class="line"><span class="comment">read committed：  ×		√		√</span></span><br><span class="line"><span class="comment">repeatable read： ×		×		√</span></span><br><span class="line"><span class="comment">serializable	  ×             ×               ×</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">mysql中默认 第三个隔离级别 repeatable read</span></span><br><span class="line"><span class="comment">oracle中默认第二个隔离级别 read committed</span></span><br><span class="line"><span class="comment">查看隔离级别</span></span><br><span class="line"><span class="comment">select @@tx_isolation;</span></span><br><span class="line"><span class="comment">设置隔离级别</span></span><br><span class="line"><span class="comment">set session|global transaction isolation level 隔离级别;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">开启事务的语句;</span></span><br><span class="line"><span class="comment">update 表 set 张三丰的余额=500 where name=&#x27;张三丰&#x27;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">update 表 set 郭襄的余额=1500 where name=&#x27;郭襄&#x27; </span></span><br><span class="line"><span class="comment">结束事务的语句;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;autocommit&#x27;</span>;</span><br><span class="line"><span class="keyword">SHOW</span> ENGINES;</span><br><span class="line"></span><br><span class="line">#<span class="number">1.</span>演示事务的使用步骤</span><br><span class="line"></span><br><span class="line">#开启事务</span><br><span class="line"><span class="keyword">SET</span> autocommit<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line">#编写一组事务的语句</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> <span class="number">1000</span> <span class="keyword">WHERE</span> username<span class="operator">=</span><span class="string">&#x27;张无忌&#x27;</span>;</span><br><span class="line"><span class="keyword">UPDATE</span> account <span class="keyword">SET</span> balance <span class="operator">=</span> <span class="number">1000</span> <span class="keyword">WHERE</span> username<span class="operator">=</span><span class="string">&#x27;赵敏&#x27;</span>;</span><br><span class="line"></span><br><span class="line">#结束事务</span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br><span class="line">#<span class="keyword">commit</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> account;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>演示事务对于<span class="keyword">delete</span>和<span class="keyword">truncate</span>的处理的区别</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> autocommit<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"></span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> account;</span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>演示<span class="keyword">savepoint</span> 的使用</span><br><span class="line"><span class="keyword">SET</span> autocommit<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> account <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">25</span>;</span><br><span class="line"><span class="keyword">SAVEPOINT</span> a;#设置保存点</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> account <span class="keyword">WHERE</span> id<span class="operator">=</span><span class="number">28</span>;</span><br><span class="line"><span class="keyword">ROLLBACK</span> <span class="keyword">TO</span> a;#回滚到保存点</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> account;</span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span><span class="keyword">delete</span>和trucate在事务使用时的区别</span><br><span class="line"></span><br><span class="line"># 演示<span class="keyword">delete</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> account;</span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br><span class="line"></span><br><span class="line"># 演示<span class="keyword">truncate</span>,不支持回滚</span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> autocommit <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">START</span> TRANSACTION;</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> account;</span><br><span class="line"><span class="keyword">ROLLBACK</span>;</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136</span></span><br></pre></td></tr></table></figure>

<h4 id="3-2-视图"><a href="#3-2-视图" class="headerlink" title="3.2 视图"></a>3.2 视图</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br></pre></td><td class="code"><pre><span class="line">#视图</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">含义：虚拟表，和普通表一样使用</span></span><br><span class="line"><span class="comment">mysql5.1版本出现的新特性，是通过表动态生成的数据</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">比如：舞蹈班和普通班级的对比</span></span><br><span class="line"><span class="comment">	创建语法的关键字	是否实际占用物理空间	使用</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">视图	create view		只是保存了sql逻辑	增删改查，只是一般不能增删改</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">表	create table		保存了数据		增删改查</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#案例：查询姓张的学生名和专业名</span><br><span class="line"><span class="keyword">SELECT</span> stuname,majorname</span><br><span class="line"><span class="keyword">FROM</span> stuinfo s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> major m <span class="keyword">ON</span> s.`majorid`<span class="operator">=</span> m.`id`</span><br><span class="line"><span class="keyword">WHERE</span> s.`stuname` <span class="keyword">LIKE</span> <span class="string">&#x27;张%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> v1</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> stuname,majorname</span><br><span class="line"><span class="keyword">FROM</span> stuinfo s</span><br><span class="line"><span class="keyword">INNER</span> <span class="keyword">JOIN</span> major m <span class="keyword">ON</span> s.`majorid`<span class="operator">=</span> m.`id`;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> v1 <span class="keyword">WHERE</span> stuname <span class="keyword">LIKE</span> <span class="string">&#x27;张%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#一、创建视图</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">create view 视图名</span></span><br><span class="line"><span class="comment">as</span></span><br><span class="line"><span class="comment">查询语句;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">USE myemployees;</span><br><span class="line"></span><br><span class="line">#<span class="number">1.</span>查询姓名中包含a字符的员工名、部门名和工种信息</span><br><span class="line">#①创建</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> myv1</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name,job_title</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">JOIN</span> departments d <span class="keyword">ON</span> e.department_id  <span class="operator">=</span> d.department_id</span><br><span class="line"><span class="keyword">JOIN</span> jobs j <span class="keyword">ON</span> j.job_id  <span class="operator">=</span> e.job_id;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#②使用</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myv1 <span class="keyword">WHERE</span> last_name <span class="keyword">LIKE</span> <span class="string">&#x27;%a%&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>查询各部门的平均工资级别</span><br><span class="line"></span><br><span class="line">#①创建视图查看每个部门的平均工资</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> myv2</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) ag,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id;</span><br><span class="line"></span><br><span class="line">#②使用</span><br><span class="line"><span class="keyword">SELECT</span> myv2.`ag`,g.grade_level</span><br><span class="line"><span class="keyword">FROM</span> myv2</span><br><span class="line"><span class="keyword">JOIN</span> job_grades g</span><br><span class="line"><span class="keyword">ON</span> myv2.`ag` <span class="keyword">BETWEEN</span> g.`lowest_sal` <span class="keyword">AND</span> g.`highest_sal`;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>查询平均工资最低的部门信息</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myv2 <span class="keyword">ORDER</span> <span class="keyword">BY</span> ag LIMIT <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>查询平均工资最低的部门名和工资</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> myv3</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myv2 <span class="keyword">ORDER</span> <span class="keyword">BY</span> ag LIMIT <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> d.<span class="operator">*</span>,m.ag</span><br><span class="line"><span class="keyword">FROM</span> myv3 m</span><br><span class="line"><span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> m.`department_id`<span class="operator">=</span>d.`department_id`;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#二、视图的修改</span><br><span class="line"></span><br><span class="line">#方式一：</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">create or replace view  视图名</span></span><br><span class="line"><span class="comment">as</span></span><br><span class="line"><span class="comment">查询语句;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myv3 </span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myv3</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary),job_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> job_id;</span><br><span class="line"></span><br><span class="line">#方式二：</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">alter view 视图名</span></span><br><span class="line"><span class="comment">as </span></span><br><span class="line"><span class="comment">查询语句;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">VIEW</span> myv3</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line">#三、删除视图</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">语法：drop view 视图名,视图名,...;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">VIEW</span> emp_v1,emp_v2,myv3;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#四、查看视图</span><br><span class="line"></span><br><span class="line"><span class="keyword">DESC</span> myv3;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">VIEW</span> myv3;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#五、视图的更新</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myv1</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,email,salary<span class="operator">*</span><span class="number">12</span><span class="operator">*</span>(<span class="number">1</span><span class="operator">+</span>IFNULL(commission_pct,<span class="number">0</span>)) &quot;annual salary&quot;</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myv1</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,email</span><br><span class="line"><span class="keyword">FROM</span> employees;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myv1;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> employees;</span><br><span class="line">#<span class="number">1.</span>插入</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> myv1 <span class="keyword">VALUES</span>(<span class="string">&#x27;张飞&#x27;</span>,<span class="string">&#x27;zf@qq.com&#x27;</span>);</span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>修改</span><br><span class="line"><span class="keyword">UPDATE</span> myv1 <span class="keyword">SET</span> last_name <span class="operator">=</span> <span class="string">&#x27;张无忌&#x27;</span> <span class="keyword">WHERE</span> last_name<span class="operator">=</span><span class="string">&#x27;张飞&#x27;</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>删除</span><br><span class="line"><span class="keyword">DELETE</span> <span class="keyword">FROM</span> myv1 <span class="keyword">WHERE</span> last_name <span class="operator">=</span> <span class="string">&#x27;张无忌&#x27;</span>;</span><br><span class="line"></span><br><span class="line">#具备以下特点的视图不允许更新</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#①包含以下关键字的<span class="keyword">sql</span>语句：分组函数、<span class="keyword">distinct</span>、<span class="keyword">group</span>  <span class="keyword">by</span>、<span class="keyword">having</span>、<span class="keyword">union</span>或者<span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myv1</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) m,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myv1;</span><br><span class="line"></span><br><span class="line">#更新</span><br><span class="line"><span class="keyword">UPDATE</span> myv1 <span class="keyword">SET</span> m<span class="operator">=</span><span class="number">9000</span> <span class="keyword">WHERE</span> department_id<span class="operator">=</span><span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">#②常量视图</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myv2</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="string">&#x27;john&#x27;</span> NAME;</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myv2;</span><br><span class="line"></span><br><span class="line">#更新</span><br><span class="line"><span class="keyword">UPDATE</span> myv2 <span class="keyword">SET</span> NAME<span class="operator">=</span><span class="string">&#x27;lucy&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#③<span class="keyword">Select</span>中包含子查询</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myv3</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> department_id,(<span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) <span class="keyword">FROM</span> employees) 最高工资</span><br><span class="line"><span class="keyword">FROM</span> departments;</span><br><span class="line"></span><br><span class="line">#更新</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myv3;</span><br><span class="line"><span class="keyword">UPDATE</span> myv3 <span class="keyword">SET</span> 最高工资<span class="operator">=</span><span class="number">100000</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#④<span class="keyword">join</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myv4</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,department_name</span><br><span class="line"><span class="keyword">FROM</span> employees e</span><br><span class="line"><span class="keyword">JOIN</span> departments d</span><br><span class="line"><span class="keyword">ON</span> e.department_id  <span class="operator">=</span> d.department_id;</span><br><span class="line"></span><br><span class="line">#更新</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myv4;</span><br><span class="line"><span class="keyword">UPDATE</span> myv4 <span class="keyword">SET</span> last_name  <span class="operator">=</span> <span class="string">&#x27;张飞&#x27;</span> <span class="keyword">WHERE</span> last_name<span class="operator">=</span><span class="string">&#x27;Whalen&#x27;</span>;</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> myv4 <span class="keyword">VALUES</span>(<span class="string">&#x27;陈真&#x27;</span>,<span class="string">&#x27;xxxx&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#⑤<span class="keyword">from</span>一个不能更新的视图</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myv5</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myv3;</span><br><span class="line"></span><br><span class="line">#更新</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myv5;</span><br><span class="line"></span><br><span class="line"><span class="keyword">UPDATE</span> myv5 <span class="keyword">SET</span> 最高工资<span class="operator">=</span><span class="number">10000</span> <span class="keyword">WHERE</span> department_id<span class="operator">=</span><span class="number">60</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#⑥<span class="keyword">where</span>子句的子查询引用了<span class="keyword">from</span>子句中的表</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> myv6</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> last_name,email,salary</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> employee_id <span class="keyword">IN</span>(</span><br><span class="line">	<span class="keyword">SELECT</span>  manager_id</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> manager_id <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">#更新</span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> myv6;</span><br><span class="line"><span class="keyword">UPDATE</span> myv6 <span class="keyword">SET</span> salary<span class="operator">=</span><span class="number">10000</span> <span class="keyword">WHERE</span> last_name <span class="operator">=</span> <span class="string">&#x27;k_ing&#x27;</span>;</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257</span></span><br></pre></td></tr></table></figure>

<h5 id="3-2-1-案例视图"><a href="#3-2-1-案例视图" class="headerlink" title="3.2.1 案例视图"></a>3.2.1 案例视图</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">#一、创建视图emp_v1,要求查询电话号码以‘<span class="number">011</span>’开头的员工姓名和工资、邮箱</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> emp_v1</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> last_name,salary,email</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">WHERE</span> phone_number <span class="keyword">LIKE</span> <span class="string">&#x27;011%&#x27;</span>;</span><br><span class="line"></span><br><span class="line">#二、创建视图emp_v2，要求查询部门的最高工资高于<span class="number">12000</span>的部门信息</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">VIEW</span> emp_v2</span><br><span class="line"><span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> <span class="built_in">MAX</span>(salary) mx_dep,department_id</span><br><span class="line"><span class="keyword">FROM</span> employees</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> department_id</span><br><span class="line"><span class="keyword">HAVING</span> <span class="built_in">MAX</span>(salary)<span class="operator">&gt;</span><span class="number">12000</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> d.<span class="operator">*</span>,m.mx_dep</span><br><span class="line"><span class="keyword">FROM</span> departments d</span><br><span class="line"><span class="keyword">JOIN</span> emp_v2 m</span><br><span class="line"><span class="keyword">ON</span> m.department_id <span class="operator">=</span> d.`department_id`;</span><br><span class="line"></span><br><span class="line"><span class="number">1234567891011121314151617181920212223</span></span><br></pre></td></tr></table></figure>

<h4 id="3-3-变量"><a href="#3-3-变量" class="headerlink" title="3.3 变量"></a>3.3 变量</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br></pre></td><td class="code"><pre><span class="line">#变量</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">系统变量：</span></span><br><span class="line"><span class="comment">	全局变量</span></span><br><span class="line"><span class="comment">	会话变量</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">自定义变量：</span></span><br><span class="line"><span class="comment">	用户变量</span></span><br><span class="line"><span class="comment">	局部变量</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#一、系统变量</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">说明：变量由系统定义，不是用户定义，属于服务器层面</span></span><br><span class="line"><span class="comment">注意：全局变量需要添加global关键字，会话变量需要添加session关键字，如果不写，默认会话级别</span></span><br><span class="line"><span class="comment">使用步骤：</span></span><br><span class="line"><span class="comment">1、查看所有系统变量</span></span><br><span class="line"><span class="comment">show global|【session】variables;</span></span><br><span class="line"><span class="comment">2、查看满足条件的部分系统变量</span></span><br><span class="line"><span class="comment">show global|【session】 variables like &#x27;%char%&#x27;;</span></span><br><span class="line"><span class="comment">3、查看指定的系统变量的值</span></span><br><span class="line"><span class="comment">select @@global|【session】系统变量名;</span></span><br><span class="line"><span class="comment">4、为某个系统变量赋值</span></span><br><span class="line"><span class="comment">方式一：</span></span><br><span class="line"><span class="comment">set global|【session】系统变量名=值;</span></span><br><span class="line"><span class="comment">方式二：</span></span><br><span class="line"><span class="comment">set @@global|【session】系统变量名=值;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#<span class="number">1</span>》全局变量</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">作用域：针对于所有会话（连接）有效，但不能跨重启</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#①查看所有全局变量</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span> VARIABLES;</span><br><span class="line">#②查看满足条件的部分系统变量</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">GLOBAL</span> VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;%char%&#x27;</span>;</span><br><span class="line">#③查看指定的系统变量的值</span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@global</span>.autocommit;</span><br><span class="line">#④为某个系统变量赋值</span><br><span class="line"><span class="keyword">SET</span> @<span class="variable">@global</span>.autocommit<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">GLOBAL</span> autocommit<span class="operator">=</span><span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">#<span class="number">2</span>》会话变量</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">作用域：针对于当前会话（连接）有效</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#①查看所有会话变量</span><br><span class="line"><span class="keyword">SHOW</span> SESSION VARIABLES;</span><br><span class="line">#②查看满足条件的部分会话变量</span><br><span class="line"><span class="keyword">SHOW</span> SESSION VARIABLES <span class="keyword">LIKE</span> <span class="string">&#x27;%char%&#x27;</span>;</span><br><span class="line">#③查看指定的会话变量的值</span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@autocommit</span>;</span><br><span class="line"><span class="keyword">SELECT</span> @<span class="variable">@session</span>.tx_isolation;</span><br><span class="line">#④为某个会话变量赋值</span><br><span class="line"><span class="keyword">SET</span> @<span class="variable">@session</span>.tx_isolation<span class="operator">=</span><span class="string">&#x27;read-uncommitted&#x27;</span>;</span><br><span class="line"><span class="keyword">SET</span> SESSION tx_isolation<span class="operator">=</span><span class="string">&#x27;read-committed&#x27;</span>;</span><br><span class="line"></span><br><span class="line">#二、自定义变量</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">说明：变量由用户自定义，而不是系统提供的</span></span><br><span class="line"><span class="comment">使用步骤：</span></span><br><span class="line"><span class="comment">1、声明</span></span><br><span class="line"><span class="comment">2、赋值</span></span><br><span class="line"><span class="comment">3、使用（查看、比较、运算等）</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#<span class="number">1</span>》用户变量</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">作用域：针对于当前会话（连接）有效，作用域同于会话变量</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#赋值操作符：<span class="operator">=</span>或:<span class="operator">=</span></span><br><span class="line">#①声明并初始化</span><br><span class="line"><span class="keyword">SET</span> @变量名<span class="operator">=</span>值;</span><br><span class="line"><span class="keyword">SET</span> @变量名:<span class="operator">=</span>值;</span><br><span class="line"><span class="keyword">SELECT</span> @变量名:<span class="operator">=</span>值;</span><br><span class="line"></span><br><span class="line">#②赋值（更新变量的值）</span><br><span class="line">#方式一：</span><br><span class="line">	<span class="keyword">SET</span> @变量名<span class="operator">=</span>值;</span><br><span class="line">	<span class="keyword">SET</span> @变量名:<span class="operator">=</span>值;</span><br><span class="line">	<span class="keyword">SELECT</span> @变量名:<span class="operator">=</span>值;</span><br><span class="line">#方式二：</span><br><span class="line">	<span class="keyword">SELECT</span> 字段 <span class="keyword">INTO</span> @变量名</span><br><span class="line">	<span class="keyword">FROM</span> 表;</span><br><span class="line">#③使用（查看变量的值）</span><br><span class="line"><span class="keyword">SELECT</span> @变量名;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2</span>》局部变量</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">作用域：仅仅在定义它的begin end块中有效</span></span><br><span class="line"><span class="comment">应用在 begin end中的第一句话</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#①声明</span><br><span class="line"><span class="keyword">DECLARE</span> 变量名 类型;</span><br><span class="line"><span class="keyword">DECLARE</span> 变量名 类型 【<span class="keyword">DEFAULT</span> 值】;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#②赋值（更新变量的值）</span><br><span class="line"></span><br><span class="line">#方式一：</span><br><span class="line">	<span class="keyword">SET</span> 局部变量名<span class="operator">=</span>值;</span><br><span class="line">	<span class="keyword">SET</span> 局部变量名:<span class="operator">=</span>值;</span><br><span class="line">	<span class="keyword">SELECT</span> 局部变量名:<span class="operator">=</span>值;</span><br><span class="line">#方式二：</span><br><span class="line">	<span class="keyword">SELECT</span> 字段 <span class="keyword">INTO</span> 具备变量名</span><br><span class="line">	<span class="keyword">FROM</span> 表;</span><br><span class="line">#③使用（查看变量的值）</span><br><span class="line"><span class="keyword">SELECT</span> 局部变量名;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例：声明两个变量，求和并打印</span><br><span class="line"></span><br><span class="line">#用户变量</span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@m</span><span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@n</span><span class="operator">=</span><span class="number">1</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@sum</span><span class="operator">=</span><span class="variable">@m</span><span class="operator">+</span><span class="variable">@n</span>;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@sum</span>;</span><br><span class="line"></span><br><span class="line">#局部变量</span><br><span class="line"><span class="keyword">DECLARE</span> m <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> n <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">DECLARE</span> SUM <span class="type">INT</span>;</span><br><span class="line"><span class="keyword">SET</span> SUM<span class="operator">=</span>m<span class="operator">+</span>n;</span><br><span class="line"><span class="keyword">SELECT</span> SUM;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#用户变量和局部变量的对比</span><br><span class="line"></span><br><span class="line">		作用域			定义位置		语法</span><br><span class="line">用户变量	当前会话		会话的任何地方		加@符号，不用指定类型</span><br><span class="line">局部变量	定义它的<span class="keyword">BEGIN</span> <span class="keyword">END</span>中 	<span class="keyword">BEGIN</span> <span class="keyword">END</span>的第一句话	一般不用加@,需要指定类型</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135</span></span><br></pre></td></tr></table></figure>

<h4 id="3-4-存储过程"><a href="#3-4-存储过程" class="headerlink" title="3.4 存储过程"></a>3.4 存储过程</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br></pre></td><td class="code"><pre><span class="line">#存储过程和函数</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">存储过程和函数：类似于java中的方法</span></span><br><span class="line"><span class="comment">好处：</span></span><br><span class="line"><span class="comment">1、提高代码的重用性</span></span><br><span class="line"><span class="comment">2、简化操作</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">#存储过程</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">含义：一组预先编译好的SQL语句的集合，理解成批处理语句</span></span><br><span class="line"><span class="comment">1、提高代码的重用性</span></span><br><span class="line"><span class="comment">2、简化操作</span></span><br><span class="line"><span class="comment">3、减少了编译次数并且减少了和数据库服务器的连接次数，提高了效率</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#一、创建语法</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> 存储过程名(参数列表)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">	存储过程体（一组合法的<span class="keyword">SQL</span>语句）</span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"></span><br><span class="line">#注意：</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1、参数列表包含三部分</span></span><br><span class="line"><span class="comment">参数模式  参数名  参数类型</span></span><br><span class="line"><span class="comment">举例：</span></span><br><span class="line"><span class="comment">in stuname varchar(20)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">参数模式：</span></span><br><span class="line"><span class="comment">in：该参数可以作为输入，也就是该参数需要调用方传入值</span></span><br><span class="line"><span class="comment">out：该参数可以作为输出，也就是该参数可以作为返回值</span></span><br><span class="line"><span class="comment">inout：该参数既可以作为输入又可以作为输出，也就是该参数既需要传入值，又可以返回值</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2、如果存储过程体仅仅只有一句话，begin end可以省略</span></span><br><span class="line"><span class="comment">存储过程体中的每条sql语句的结尾要求必须加分号。</span></span><br><span class="line"><span class="comment">存储过程的结尾可以使用 delimiter 重新设置</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">delimiter 结束标记</span></span><br><span class="line"><span class="comment">案例：</span></span><br><span class="line"><span class="comment">delimiter $</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#二、调用语法</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> 存储过程名(实参列表);</span><br><span class="line"></span><br><span class="line">#<span class="comment">--------------------------------案例演示-----------------------------------</span></span><br><span class="line">#<span class="number">1.</span>空参列表</span><br><span class="line">#案例：插入到admin表中五条记录</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> admin;</span><br><span class="line"></span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> myp1()</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">INSERT</span> <span class="keyword">INTO</span> admin(username,`password`) </span><br><span class="line">	<span class="keyword">VALUES</span>(<span class="string">&#x27;john1&#x27;</span>,<span class="string">&#x27;0000&#x27;</span>),(<span class="string">&#x27;lily&#x27;</span>,<span class="string">&#x27;0000&#x27;</span>),(<span class="string">&#x27;rose&#x27;</span>,<span class="string">&#x27;0000&#x27;</span>),(<span class="string">&#x27;jack&#x27;</span>,<span class="string">&#x27;0000&#x27;</span>),(<span class="string">&#x27;tom&#x27;</span>,<span class="string">&#x27;0000&#x27;</span>);</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#调用</span><br><span class="line"><span class="keyword">CALL</span> myp1()$</span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>创建带<span class="keyword">in</span>模式参数的存储过程</span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：创建存储过程实现 根据女神名，查询对应的男神信息</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> myp2(<span class="keyword">IN</span> beautyName <span class="type">VARCHAR</span>(<span class="number">20</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> bo.<span class="operator">*</span></span><br><span class="line">	<span class="keyword">FROM</span> boys bo</span><br><span class="line">	<span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> beauty b <span class="keyword">ON</span> bo.id <span class="operator">=</span> b.boyfriend_id</span><br><span class="line">	<span class="keyword">WHERE</span> b.name<span class="operator">=</span>beautyName;</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line">#调用</span><br><span class="line"><span class="keyword">CALL</span> myp2(<span class="string">&#x27;柳岩&#x27;</span>)$</span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span> ：创建存储过程实现，用户是否登录成功</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> myp4(<span class="keyword">IN</span> username <span class="type">VARCHAR</span>(<span class="number">20</span>),<span class="keyword">IN</span> PASSWORD <span class="type">VARCHAR</span>(<span class="number">20</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">DECLARE</span> <span class="keyword">result</span> <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;#声明并初始化</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">INTO</span> <span class="keyword">result</span>#赋值</span><br><span class="line">	<span class="keyword">FROM</span> admin</span><br><span class="line">	<span class="keyword">WHERE</span> admin.username <span class="operator">=</span> username</span><br><span class="line">	<span class="keyword">AND</span> admin.password <span class="operator">=</span> PASSWORD;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SELECT</span> IF(<span class="keyword">result</span><span class="operator">&gt;</span><span class="number">0</span>,<span class="string">&#x27;成功&#x27;</span>,<span class="string">&#x27;失败&#x27;</span>);#使用</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line">#调用</span><br><span class="line"><span class="keyword">CALL</span> myp3(<span class="string">&#x27;张飞&#x27;</span>,<span class="string">&#x27;8888&#x27;</span>)$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>创建<span class="keyword">out</span> 模式参数的存储过程</span><br><span class="line">#案例<span class="number">1</span>：根据输入的女神名，返回对应的男神名</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> myp6(<span class="keyword">IN</span> beautyName <span class="type">VARCHAR</span>(<span class="number">20</span>),<span class="keyword">OUT</span> boyName <span class="type">VARCHAR</span>(<span class="number">20</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> bo.boyname <span class="keyword">INTO</span> boyname</span><br><span class="line">	<span class="keyword">FROM</span> boys bo</span><br><span class="line">	<span class="keyword">RIGHT</span> <span class="keyword">JOIN</span></span><br><span class="line">	beauty b <span class="keyword">ON</span> b.boyfriend_id <span class="operator">=</span> bo.id</span><br><span class="line">	<span class="keyword">WHERE</span> b.name<span class="operator">=</span>beautyName ;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：根据输入的女神名，返回对应的男神名和魅力值</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> myp7(<span class="keyword">IN</span> beautyName <span class="type">VARCHAR</span>(<span class="number">20</span>),<span class="keyword">OUT</span> boyName <span class="type">VARCHAR</span>(<span class="number">20</span>),<span class="keyword">OUT</span> usercp <span class="type">INT</span>) </span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> boys.boyname ,boys.usercp <span class="keyword">INTO</span> boyname,usercp</span><br><span class="line">	<span class="keyword">FROM</span> boys </span><br><span class="line">	<span class="keyword">RIGHT</span> <span class="keyword">JOIN</span></span><br><span class="line">	beauty b <span class="keyword">ON</span> b.boyfriend_id <span class="operator">=</span> boys.id</span><br><span class="line">	<span class="keyword">WHERE</span> b.name<span class="operator">=</span>beautyName ;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#调用</span><br><span class="line"><span class="keyword">CALL</span> myp7(<span class="string">&#x27;小昭&#x27;</span>,<span class="variable">@name</span>,<span class="variable">@cp</span>)$</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@name</span>,<span class="variable">@cp</span>$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">4.</span>创建带<span class="keyword">inout</span>模式参数的存储过程</span><br><span class="line">#案例<span class="number">1</span>：传入a和b两个值，最终a和b都翻倍并返回</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> myp8(<span class="keyword">INOUT</span> a <span class="type">INT</span> ,<span class="keyword">INOUT</span> b <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SET</span> a<span class="operator">=</span>a<span class="operator">*</span><span class="number">2</span>;</span><br><span class="line">	<span class="keyword">SET</span> b<span class="operator">=</span>b<span class="operator">*</span><span class="number">2</span>;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line">#调用</span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@m</span><span class="operator">=</span><span class="number">10</span>$</span><br><span class="line"><span class="keyword">SET</span> <span class="variable">@n</span><span class="operator">=</span><span class="number">20</span>$</span><br><span class="line"><span class="keyword">CALL</span> myp8(<span class="variable">@m</span>,<span class="variable">@n</span>)$</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@m</span>,<span class="variable">@n</span>$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#三、删除存储过程</span><br><span class="line">#语法：<span class="keyword">drop</span> <span class="keyword">procedure</span> 存储过程名</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> p1;</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> p2,p3;#×</span><br><span class="line"></span><br><span class="line">#四、查看存储过程的信息</span><br><span class="line"><span class="keyword">DESC</span> myp2;×</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span>  myp2;</span><br><span class="line"></span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165</span></span><br></pre></td></tr></table></figure>

<h5 id="3-4-1-案例存储过程"><a href="#3-4-1-案例存储过程" class="headerlink" title="3.4.1 案例存储过程"></a>3.4.1 案例存储过程</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">#一、创建存储过程实现传入用户名和密码，插入到admin表中</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test_pro1(<span class="keyword">IN</span> username <span class="type">VARCHAR</span>(<span class="number">20</span>),<span class="keyword">IN</span> loginPwd <span class="type">VARCHAR</span>(<span class="number">20</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">INSERT</span> <span class="keyword">INTO</span> admin(admin.username,PASSWORD)</span><br><span class="line">	<span class="keyword">VALUES</span>(username,loginpwd);</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line">#二、创建存储过程实现传入女神编号，返回女神名称和女神电话</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test_pro2(<span class="keyword">IN</span> id <span class="type">INT</span>,<span class="keyword">OUT</span> NAME <span class="type">VARCHAR</span>(<span class="number">20</span>),<span class="keyword">OUT</span> phone <span class="type">VARCHAR</span>(<span class="number">20</span>))</span><br><span class="line"></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> b.name ,b.phone <span class="keyword">INTO</span> NAME,phone</span><br><span class="line">	<span class="keyword">FROM</span> beauty b</span><br><span class="line">	<span class="keyword">WHERE</span> b.id <span class="operator">=</span> id;</span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">#三、创建存储存储过程或函数实现传入两个女神生日，返回大小</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test_pro3(<span class="keyword">IN</span> birth1 DATETIME,<span class="keyword">IN</span> birth2 DATETIME,<span class="keyword">OUT</span> <span class="keyword">result</span> <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> DATEDIFF(birth1,birth2) <span class="keyword">INTO</span> <span class="keyword">result</span>;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line">#四、创建存储过程或函数实现传入一个日期，格式化成xx年xx月xx日并返回</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test_pro4(<span class="keyword">IN</span> mydate DATETIME,<span class="keyword">OUT</span> strDate <span class="type">VARCHAR</span>(<span class="number">50</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> DATE_FORMAT(mydate,<span class="string">&#x27;%y年%m月%d日&#x27;</span>) <span class="keyword">INTO</span> strDate;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> test_pro4(NOW(),<span class="variable">@str</span>)$</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@str</span> $</span><br><span class="line"></span><br><span class="line">#五、创建存储过程或函数实现传入女神名称，返回：女神 <span class="keyword">and</span> 男神  格式的字符串</span><br><span class="line">如 传入 ：小昭</span><br><span class="line">返回： 小昭 <span class="keyword">AND</span> 张无忌</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> test_pro5 $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test_pro5(<span class="keyword">IN</span> beautyName <span class="type">VARCHAR</span>(<span class="number">20</span>),<span class="keyword">OUT</span> str <span class="type">VARCHAR</span>(<span class="number">50</span>))</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> CONCAT(beautyName,<span class="string">&#x27; and &#x27;</span>,IFNULL(boyName,<span class="string">&#x27;null&#x27;</span>)) <span class="keyword">INTO</span> str</span><br><span class="line">	<span class="keyword">FROM</span> boys bo</span><br><span class="line">	<span class="keyword">RIGHT</span> <span class="keyword">JOIN</span> beauty b <span class="keyword">ON</span> b.boyfriend_id <span class="operator">=</span> bo.id</span><br><span class="line">	<span class="keyword">WHERE</span> b.name<span class="operator">=</span>beautyName;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">SET</span> str<span class="operator">=</span></span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> test_pro5(<span class="string">&#x27;柳岩&#x27;</span>,<span class="variable">@str</span>)$</span><br><span class="line"><span class="keyword">SELECT</span> <span class="variable">@str</span> $</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#六、创建存储过程或函数，根据传入的条目数和起始索引，查询beauty表的记录</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> test_pro6$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test_pro6(<span class="keyword">IN</span> startIndex <span class="type">INT</span>,<span class="keyword">IN</span> size <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> beauty LIMIT startIndex,size;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> test_pro6(<span class="number">3</span>,<span class="number">5</span>)$</span><br><span class="line"></span><br><span class="line"><span class="number">1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162</span></span><br></pre></td></tr></table></figure>

<h4 id="3-5-函数"><a href="#3-5-函数" class="headerlink" title="3.5 函数"></a>3.5 函数</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">#函数</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">含义：一组预先编译好的SQL语句的集合，理解成批处理语句</span></span><br><span class="line"><span class="comment">1、提高代码的重用性</span></span><br><span class="line"><span class="comment">2、简化操作</span></span><br><span class="line"><span class="comment">3、减少了编译次数并且减少了和数据库服务器的连接次数，提高了效率</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">区别：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">存储过程：可以有0个返回，也可以有多个返回，适合做批量插入、批量更新</span></span><br><span class="line"><span class="comment">函数：有且仅有1 个返回，适合做处理数据后返回一个结果</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#一、创建语法</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> 函数名(参数列表) <span class="keyword">RETURNS</span> 返回类型</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	函数体</span><br><span class="line"><span class="keyword">END</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">注意：</span></span><br><span class="line"><span class="comment">1.参数列表 包含两部分：</span></span><br><span class="line"><span class="comment">参数名 参数类型</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">2.函数体：肯定会有return语句，如果没有会报错</span></span><br><span class="line"><span class="comment">如果return语句没有放在函数体的最后也不报错，但不建议</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">return 值;</span></span><br><span class="line"><span class="comment">3.函数体中仅有一句话，则可以省略begin end</span></span><br><span class="line"><span class="comment">4.使用 delimiter语句设置结束标记</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#二、调用语法</span><br><span class="line"><span class="keyword">SELECT</span> 函数名(参数列表)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="comment">------------------------------案例演示----------------------------</span></span><br><span class="line">#<span class="number">1.</span>无参有返回</span><br><span class="line">#案例：返回公司的员工个数</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> myf1() <span class="keyword">RETURNS</span> <span class="type">INT</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">DECLARE</span> c <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;#定义局部变量</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">COUNT</span>(<span class="operator">*</span>) <span class="keyword">INTO</span> c#赋值</span><br><span class="line">	<span class="keyword">FROM</span> employees;</span><br><span class="line">	<span class="keyword">RETURN</span> c;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> myf1()$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>有参有返回</span><br><span class="line">#案例<span class="number">1</span>：根据员工名，返回它的工资</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> myf2(empName <span class="type">VARCHAR</span>(<span class="number">20</span>)) <span class="keyword">RETURNS</span> <span class="keyword">DOUBLE</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">SET</span> <span class="variable">@sal</span><span class="operator">=</span><span class="number">0</span>;#定义用户变量 </span><br><span class="line">	<span class="keyword">SELECT</span> salary <span class="keyword">INTO</span> <span class="variable">@sal</span>   #赋值</span><br><span class="line">	<span class="keyword">FROM</span> employees</span><br><span class="line">	<span class="keyword">WHERE</span> last_name <span class="operator">=</span> empName;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">RETURN</span> <span class="variable">@sal</span>;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> myf2(<span class="string">&#x27;k_ing&#x27;</span>) $</span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：根据部门名，返回该部门的平均工资</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> myf3(deptName <span class="type">VARCHAR</span>(<span class="number">20</span>)) <span class="keyword">RETURNS</span> <span class="keyword">DOUBLE</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">DECLARE</span> sal <span class="keyword">DOUBLE</span> ;</span><br><span class="line">	<span class="keyword">SELECT</span> <span class="built_in">AVG</span>(salary) <span class="keyword">INTO</span> sal</span><br><span class="line">	<span class="keyword">FROM</span> employees e</span><br><span class="line">	<span class="keyword">JOIN</span> departments d <span class="keyword">ON</span> e.department_id <span class="operator">=</span> d.department_id</span><br><span class="line">	<span class="keyword">WHERE</span> d.department_name<span class="operator">=</span>deptName;</span><br><span class="line">	<span class="keyword">RETURN</span> sal;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> myf3(<span class="string">&#x27;IT&#x27;</span>)$</span><br><span class="line"></span><br><span class="line">#三、查看函数</span><br><span class="line"></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> myf3;</span><br><span class="line"></span><br><span class="line">#四、删除函数</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">FUNCTION</span> myf3;</span><br><span class="line"></span><br><span class="line">#案例</span><br><span class="line">#一、创建函数，实现传入两个<span class="type">float</span>，返回二者之和</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> test_fun1(num1 <span class="type">FLOAT</span>,num2 <span class="type">FLOAT</span>) <span class="keyword">RETURNS</span> <span class="type">FLOAT</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">DECLARE</span> SUM <span class="type">FLOAT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">SET</span> SUM<span class="operator">=</span>num1<span class="operator">+</span>num2;</span><br><span class="line">	<span class="keyword">RETURN</span> SUM;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> test_fun1(<span class="number">1</span>,<span class="number">2</span>)$</span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101</span></span><br></pre></td></tr></table></figure>

<h4 id="3-6-流程控制结构"><a href="#3-6-流程控制结构" class="headerlink" title="3.6 流程控制结构"></a>3.6 流程控制结构</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br></pre></td><td class="code"><pre><span class="line">#流程控制结构</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">顺序、分支、循环</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#一、分支结构</span><br><span class="line">#<span class="number">1.</span>if函数</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：if(条件,值1，值2)</span></span><br><span class="line"><span class="comment">功能：实现双分支</span></span><br><span class="line"><span class="comment">应用在begin end中或外面</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span><span class="keyword">case</span>结构</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">情况1：类似于switch</span></span><br><span class="line"><span class="comment">case 变量或表达式</span></span><br><span class="line"><span class="comment">when 值1 then 语句1;</span></span><br><span class="line"><span class="comment">when 值2 then 语句2;</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">else 语句n;</span></span><br><span class="line"><span class="comment">end </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">情况2：</span></span><br><span class="line"><span class="comment">case </span></span><br><span class="line"><span class="comment">when 条件1 then 语句1;</span></span><br><span class="line"><span class="comment">when 条件2 then 语句2;</span></span><br><span class="line"><span class="comment">...</span></span><br><span class="line"><span class="comment">else 语句n;</span></span><br><span class="line"><span class="comment">end </span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">应用在begin end 中或外面</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>if结构</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">if 条件1 then 语句1;</span></span><br><span class="line"><span class="comment">elseif 条件2 then 语句2;</span></span><br><span class="line"><span class="comment">....</span></span><br><span class="line"><span class="comment">else 语句n;</span></span><br><span class="line"><span class="comment">end if;</span></span><br><span class="line"><span class="comment">功能：类似于多重if</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">只能应用在begin end 中</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：创建函数，实现传入成绩，如果成绩<span class="operator">&gt;</span><span class="number">90</span>,返回A，如果成绩<span class="operator">&gt;</span><span class="number">80</span>,返回B，如果成绩<span class="operator">&gt;</span><span class="number">60</span>,返回C，否则返回D</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> test_if(score <span class="type">FLOAT</span>) <span class="keyword">RETURNS</span> <span class="type">CHAR</span></span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">DECLARE</span> ch <span class="type">CHAR</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">	IF score<span class="operator">&gt;</span><span class="number">90</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> ch<span class="operator">=</span><span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">	ELSEIF score<span class="operator">&gt;</span><span class="number">80</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> ch<span class="operator">=</span><span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">	ELSEIF score<span class="operator">&gt;</span><span class="number">60</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> ch<span class="operator">=</span><span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">	<span class="keyword">ELSE</span> <span class="keyword">SET</span> ch<span class="operator">=</span><span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">	<span class="keyword">END</span> IF;</span><br><span class="line">	<span class="keyword">RETURN</span> ch;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> test_if(<span class="number">87</span>)$</span><br><span class="line"></span><br><span class="line">#案例<span class="number">2</span>：创建存储过程，如果工资<span class="operator">&lt;</span><span class="number">2000</span>,则删除，如果<span class="number">5000</span><span class="operator">&gt;</span>工资<span class="operator">&gt;</span><span class="number">2000</span>,则涨工资<span class="number">1000</span>，否则涨工资<span class="number">500</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test_if_pro(<span class="keyword">IN</span> sal <span class="keyword">DOUBLE</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	IF sal<span class="operator">&lt;</span><span class="number">2000</span> <span class="keyword">THEN</span> <span class="keyword">DELETE</span> <span class="keyword">FROM</span> employees <span class="keyword">WHERE</span> employees.salary<span class="operator">=</span>sal;</span><br><span class="line">	ELSEIF sal<span class="operator">&gt;=</span><span class="number">2000</span> <span class="keyword">AND</span> sal<span class="operator">&lt;</span><span class="number">5000</span> <span class="keyword">THEN</span> <span class="keyword">UPDATE</span> employees <span class="keyword">SET</span> salary<span class="operator">=</span>salary<span class="operator">+</span><span class="number">1000</span> <span class="keyword">WHERE</span> employees.`salary`<span class="operator">=</span>sal;</span><br><span class="line">	<span class="keyword">ELSE</span> <span class="keyword">UPDATE</span> employees <span class="keyword">SET</span> salary<span class="operator">=</span>salary<span class="operator">+</span><span class="number">500</span> <span class="keyword">WHERE</span> employees.`salary`<span class="operator">=</span>sal;</span><br><span class="line">	<span class="keyword">END</span> IF;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> test_if_pro(<span class="number">2100</span>)$</span><br><span class="line"></span><br><span class="line">#案例<span class="number">1</span>：创建函数，实现传入成绩，如果成绩<span class="operator">&gt;</span><span class="number">90</span>,返回A，如果成绩<span class="operator">&gt;</span><span class="number">80</span>,返回B，如果成绩<span class="operator">&gt;</span><span class="number">60</span>,返回C，否则返回D</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">FUNCTION</span> test_case(score <span class="type">FLOAT</span>) <span class="keyword">RETURNS</span> <span class="type">CHAR</span></span><br><span class="line"><span class="keyword">BEGIN</span> </span><br><span class="line">	<span class="keyword">DECLARE</span> ch <span class="type">CHAR</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">CASE</span> </span><br><span class="line">	<span class="keyword">WHEN</span> score<span class="operator">&gt;</span><span class="number">90</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> ch<span class="operator">=</span><span class="string">&#x27;A&#x27;</span>;</span><br><span class="line">	<span class="keyword">WHEN</span> score<span class="operator">&gt;</span><span class="number">80</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> ch<span class="operator">=</span><span class="string">&#x27;B&#x27;</span>;</span><br><span class="line">	<span class="keyword">WHEN</span> score<span class="operator">&gt;</span><span class="number">60</span> <span class="keyword">THEN</span> <span class="keyword">SET</span> ch<span class="operator">=</span><span class="string">&#x27;C&#x27;</span>;</span><br><span class="line">	<span class="keyword">ELSE</span> <span class="keyword">SET</span> ch<span class="operator">=</span><span class="string">&#x27;D&#x27;</span>;</span><br><span class="line">	<span class="keyword">END</span> <span class="keyword">CASE</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">RETURN</span> ch;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> test_case(<span class="number">56</span>)$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#二、循环结构</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">分类：</span></span><br><span class="line"><span class="comment">while、loop、repeat</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">循环控制：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">iterate类似于 continue，继续，结束本次循环，继续下一次</span></span><br><span class="line"><span class="comment">leave 类似于  break，跳出，结束当前所在的循环</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#<span class="number">1.</span>while</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">【标签:】while 循环条件 do</span></span><br><span class="line"><span class="comment">	循环体;</span></span><br><span class="line"><span class="comment">end while【 标签】;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">联想：</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">while(循环条件)&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	循环体;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>loop</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">【标签:】loop</span></span><br><span class="line"><span class="comment">	循环体;</span></span><br><span class="line"><span class="comment">end loop 【标签】;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">可以用来模拟简单的死循环</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>repeat</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">语法：</span></span><br><span class="line"><span class="comment">【标签：】repeat</span></span><br><span class="line"><span class="comment">	循环体;</span></span><br><span class="line"><span class="comment">until 结束循环的条件</span></span><br><span class="line"><span class="comment">end repeat 【标签】;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#<span class="number">1.</span>没有添加循环控制语句</span><br><span class="line">#案例：批量插入，根据次数插入到admin表中多条记录</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> pro_while1$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> pro_while1(<span class="keyword">IN</span> insertCount <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line">	WHILE i<span class="operator">&lt;=</span>insertCount DO</span><br><span class="line">		<span class="keyword">INSERT</span> <span class="keyword">INTO</span> admin(username,`password`) <span class="keyword">VALUES</span>(CONCAT(<span class="string">&#x27;Rose&#x27;</span>,i),<span class="string">&#x27;666&#x27;</span>);</span><br><span class="line">		<span class="keyword">SET</span> i<span class="operator">=</span>i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">	<span class="keyword">END</span> WHILE;</span><br><span class="line">	</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> pro_while1(<span class="number">100</span>)$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">int i=1;</span></span><br><span class="line"><span class="comment">while(i&lt;=insertcount)&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">	//插入</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">	i++;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">2.</span>添加leave语句</span><br><span class="line"></span><br><span class="line">#案例：批量插入，根据次数插入到admin表中多条记录，如果次数<span class="operator">&gt;</span><span class="number">20</span>则停止</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> admin$</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> test_while1$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test_while1(<span class="keyword">IN</span> insertCount <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line">	a:WHILE i<span class="operator">&lt;=</span>insertCount DO</span><br><span class="line">		<span class="keyword">INSERT</span> <span class="keyword">INTO</span> admin(username,`password`) <span class="keyword">VALUES</span>(CONCAT(<span class="string">&#x27;xiaohua&#x27;</span>,i),<span class="string">&#x27;0000&#x27;</span>);</span><br><span class="line">		IF i<span class="operator">&gt;=</span><span class="number">20</span> <span class="keyword">THEN</span> LEAVE a;</span><br><span class="line">		<span class="keyword">END</span> IF;</span><br><span class="line">		<span class="keyword">SET</span> i<span class="operator">=</span>i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">	<span class="keyword">END</span> WHILE a;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> test_while1(<span class="number">100</span>)$</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#<span class="number">3.</span>添加iterate语句</span><br><span class="line"></span><br><span class="line">#案例：批量插入，根据次数插入到admin表中多条记录，只插入偶数次</span><br><span class="line"><span class="keyword">TRUNCATE</span> <span class="keyword">TABLE</span> admin$</span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">PROCEDURE</span> test_while1$</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test_while1(<span class="keyword">IN</span> insertCount <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span>;</span><br><span class="line">	a:WHILE i<span class="operator">&lt;=</span>insertCount DO</span><br><span class="line">		<span class="keyword">SET</span> i<span class="operator">=</span>i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">		IF <span class="built_in">MOD</span>(i,<span class="number">2</span>)<span class="operator">!=</span><span class="number">0</span> <span class="keyword">THEN</span> ITERATE a;</span><br><span class="line">		<span class="keyword">END</span> IF;</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">INSERT</span> <span class="keyword">INTO</span> admin(username,`password`) <span class="keyword">VALUES</span>(CONCAT(<span class="string">&#x27;xiaohua&#x27;</span>,i),<span class="string">&#x27;0000&#x27;</span>);</span><br><span class="line">		</span><br><span class="line">	<span class="keyword">END</span> WHILE a;</span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> test_while1(<span class="number">100</span>)$</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">int i=0;</span></span><br><span class="line"><span class="comment">while(i&lt;=insertCount)&#123;</span></span><br><span class="line"><span class="comment">	i++;</span></span><br><span class="line"><span class="comment">	if(i%2==0)&#123;</span></span><br><span class="line"><span class="comment">		continue;</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">	插入</span></span><br><span class="line"><span class="comment">	</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="number">123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245</span></span><br></pre></td></tr></table></figure>

<h5 id="3-6-1-流程控制经典案例讲解"><a href="#3-6-1-流程控制经典案例讲解" class="headerlink" title="3.6.1 流程控制经典案例讲解"></a>3.6.1 流程控制经典案例讲解</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*一、已知表stringcontent</span></span><br><span class="line"><span class="comment">其中字段：</span></span><br><span class="line"><span class="comment">id 自增长</span></span><br><span class="line"><span class="comment">content varchar(20)</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">向该表插入指定个数的，随机的字符串</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> stringcontent;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> stringcontent(</span><br><span class="line">	id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY AUTO_INCREMENT,</span><br><span class="line">	content <span class="type">VARCHAR</span>(<span class="number">20</span>)</span><br><span class="line">	</span><br><span class="line">);</span><br><span class="line">DELIMITER $</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">PROCEDURE</span> test_randstr_insert(<span class="keyword">IN</span> insertCount <span class="type">INT</span>)</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	<span class="keyword">DECLARE</span> i <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">DECLARE</span> str <span class="type">VARCHAR</span>(<span class="number">26</span>) <span class="keyword">DEFAULT</span> <span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span>;</span><br><span class="line">	<span class="keyword">DECLARE</span> startIndex <span class="type">INT</span>;#代表初始索引</span><br><span class="line">	<span class="keyword">DECLARE</span> len <span class="type">INT</span>;#代表截取的字符长度</span><br><span class="line">	WHILE i<span class="operator">&lt;=</span>insertcount DO</span><br><span class="line">		<span class="keyword">SET</span> startIndex<span class="operator">=</span><span class="built_in">FLOOR</span>(RAND()<span class="operator">*</span><span class="number">26</span><span class="operator">+</span><span class="number">1</span>);#代表初始索引，随机范围<span class="number">1</span><span class="number">-26</span></span><br><span class="line">		<span class="keyword">SET</span> len<span class="operator">=</span><span class="built_in">FLOOR</span>(RAND()<span class="operator">*</span>(<span class="number">20</span><span class="operator">-</span>startIndex<span class="operator">+</span><span class="number">1</span>)<span class="operator">+</span><span class="number">1</span>);#代表截取长度，随机范围<span class="number">1</span><span class="operator">-</span>（<span class="number">20</span><span class="operator">-</span>startIndex<span class="operator">+</span><span class="number">1</span>）</span><br><span class="line">		<span class="keyword">INSERT</span> <span class="keyword">INTO</span> stringcontent(content) <span class="keyword">VALUES</span>(SUBSTR(str,startIndex,len));</span><br><span class="line">		<span class="keyword">SET</span> i<span class="operator">=</span>i<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line">	<span class="keyword">END</span> WHILE;</span><br><span class="line"></span><br><span class="line"><span class="keyword">END</span> $</span><br><span class="line"></span><br><span class="line"><span class="keyword">CALL</span> test_randstr_insert(<span class="number">10</span>)$</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20210717155926667.png" alt="在这里插入图片描述"></p>
<h3 id="MySql高级"><a href="#MySql高级" class="headerlink" title="MySql高级"></a>MySql高级</h3><h4 id="1-MYSQL用户管理"><a href="#1-MYSQL用户管理" class="headerlink" title="1 MYSQL用户管理"></a>1 MYSQL用户管理</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">修改密码</span><br><span class="line">方法1： 用SET PASSWORD命令 </span><br><span class="line">首先登录MySQL。 </span><br><span class="line">格式：mysql&gt; set password for 用户名@localhost = password(&#x27;新密码&#x27;); </span><br><span class="line">例子：mysql&gt; set password for root@localhost = password(&#x27;123&#x27;); </span><br><span class="line"></span><br><span class="line">方法2：用mysqladmin </span><br><span class="line">格式：mysqladmin -u用户名 -p旧密码 password 新密码 </span><br><span class="line">例子：mysqladmin -uroot -p123456 password 123 </span><br><span class="line"></span><br><span class="line">方法3：用UPDATE直接编辑user表 </span><br><span class="line">首先登录MySQL。 </span><br><span class="line">mysql&gt; use mysql; </span><br><span class="line">mysql&gt; update user set password=password(&#x27;123&#x27;) where user=&#x27;root&#x27; </span><br><span class="line">and host=&#x27;localhost&#x27;; </span><br><span class="line">mysql&gt; flush privileges; </span><br><span class="line"></span><br><span class="line">方法4：在忘记root密码的时候，可以这样 </span><br><span class="line">以windows为例： </span><br><span class="line"><span class="bullet">1.</span> 关闭正在运行的MySQL服务。 </span><br><span class="line"><span class="bullet">2.</span> 打开DOS窗口，转到mysql\bin目录。 </span><br><span class="line"><span class="bullet">3.</span> 输入mysqld --skip-grant-tables 回车。--skip-grant-tables 的意思是启动MySQL</span><br><span class="line">服务的时候跳过权限表认证。 </span><br><span class="line"><span class="bullet">4.</span> 再开一个DOS窗口（因为刚才那个DOS窗口已经不能动了），转到mysql\bin目录。 </span><br><span class="line"><span class="bullet">5.</span> 输入mysql回车，如果成功，将出现MySQL提示符 &gt;。 </span><br><span class="line"><span class="bullet">6.</span> 连接权限数据库： use mysql; 。 </span><br><span class="line"><span class="bullet">7.</span> 改密码：update user set password=password(&quot;123&quot;)</span><br><span class="line"><span class="bullet">8.</span>  where user=&quot;root&quot;;（别忘了最后加分号） 。 </span><br><span class="line"><span class="bullet">9.</span> 刷新权限（必须步骤）：flush privileges;　。 </span><br><span class="line"><span class="bullet">10.</span> 退出 quit。 </span><br><span class="line"><span class="bullet">11.</span> 注销系统，再进入，使用用户名root和刚才设置的新密码123登录。</span><br><span class="line"></span><br><span class="line">删除MySQL</span><br><span class="line">1、双击安装包，点击下一步，然后点击remove。卸载。</span><br><span class="line">2、手动删除Program Files中的MySQL目录。</span><br><span class="line">3、手动删除ProgramData目录（这个目录是隐藏的。）中的MySQL。</span><br><span class="line">123456789101112131415161718192021222324252627282930313233343536</span><br></pre></td></tr></table></figure>

<h5 id="1-1-创建用户"><a href="#1-1-创建用户" class="headerlink" title="1.1 创建用户"></a>1.1 创建用户</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">创建用户</span><br><span class="line">create user zhang3 identified by &#x27;123123&#x27;;</span><br><span class="line">表示创建名称为zhang3的用户，密码设为123123；</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<h5 id="1-2-了解User表"><a href="#1-2-了解User表" class="headerlink" title="1.2 了解User表"></a>1.2 了解User表</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">查看用户</span><br><span class="line">select host,user,password,select<span class="emphasis">_priv,insert_</span>priv,drop<span class="emphasis">_priv from mysql.user;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">select * from user\G;</span></span><br><span class="line"><span class="emphasis">将 user 中的数据以行的形式显示出来(针对列很长的表可以采用这个方法 )</span></span><br><span class="line"><span class="emphasis">12345</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201130143618944.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">host ：   表示连接类型</span><br><span class="line"><span class="code">      % 表示所有远程通过 TCP方式的连接</span></span><br><span class="line"><span class="code">      IP 地址 如 (192.168.1.2,127.0.0.1) 通过制定ip地址进行的TCP方式的连接</span></span><br><span class="line"><span class="code">     机器名   通过制定i网络中的机器名进行的TCP方式的连接</span></span><br><span class="line"><span class="code">      ::1   IPv6的本地ip地址  等同于IPv4的 127.0.0.1</span></span><br><span class="line"><span class="code">      localhost 本地方式通过命令行方式的连接 ，比如mysql -u xxx -p 123xxx 方式的连接。</span></span><br><span class="line"><span class="code">User:表示用户名</span></span><br><span class="line"><span class="code">     同一用户通过不同方式链接的权限是不一样的。</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">password ： 密码</span><br><span class="line"><span class="code">     所有密码串通过 password(明文字符串) 生成的密文字符串。加密算法为MYSQLSHA1 ，不可逆 。</span></span><br><span class="line"><span class="code">      mysql 5.7 的密码保存到 authentication_string 字段中不再使用password 字段。</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">select<span class="emphasis">_priv , insert_</span>priv等 </span><br><span class="line"><span class="code">      为该用户所拥有的权限。</span></span><br><span class="line"><span class="code"></span></span><br><span class="line">12345678910111213141516</span><br></pre></td></tr></table></figure>

<h5 id="1-3-设置密码"><a href="#1-3-设置密码" class="headerlink" title="1.3 设置密码"></a>1.3 设置密码</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">修改当前用户的密码:</span><br><span class="line">set password =password(&#x27;123456&#x27;)</span><br><span class="line"> </span><br><span class="line">修改某个用户的密码:</span><br><span class="line">update mysql.user set password=password(&#x27;123456&#x27;) where user=&#x27;li4&#x27;;</span><br><span class="line">flush privileges;   #所有通过user表的修改，必须用该命令才能生效。</span><br><span class="line">123456</span><br></pre></td></tr></table></figure>

<h5 id="1-4-修改用户"><a href="#1-4-修改用户" class="headerlink" title="1.4 修改用户"></a>1.4 修改用户</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">修改用户名：</span><br><span class="line">update mysql.user set user=&#x27;li4&#x27; where user=&#x27;wang5&#x27;;</span><br><span class="line">flush privileges;   #所有通过user表的修改，必须用该命令才能生效。</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201130144104133.png" alt="在这里插入图片描述"></p>
<h5 id="1-5-删除用户"><a href="#1-5-删除用户" class="headerlink" title="1.5 删除用户"></a>1.5 删除用户</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">drop user li4 ;</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201130144158391.png" alt="在这里插入图片描述"></p>
<h4 id="2-权限管理"><a href="#2-权限管理" class="headerlink" title="2 权限管理"></a>2 权限管理</h4><h5 id="2-1-授予权限"><a href="#2-1-授予权限" class="headerlink" title="2.1 授予权限"></a>2.1 授予权限</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">授权命令： </span><br><span class="line">grant 权限1,权限2,…权限n on 数据库名称.表名称 to 用户名@用户地址 identified by ‘连接口令’;</span><br><span class="line">该权限如果发现没有该用户，则会直接新建一个用户。</span><br><span class="line">比如  </span><br><span class="line">grant select,insert,delete,drop on cqmdb.* to li4@localhost  ;</span><br><span class="line"><span class="section">#给li4用户用本地命令行方式下，授予cqmdb这个库下的所有表的插删改查的权限。</span></span><br><span class="line"></span><br><span class="line">grant all privileges on <span class="emphasis">*.*</span> to joe@&#x27;%&#x27;  identified by &#x27;123&#x27;; </span><br><span class="line"><span class="section">#授予通过网络方式登录的的joe用户 ，对所有库所有表的全部权限，密码设为123.</span></span><br><span class="line">就算 all privileges 了所有权限，grant<span class="emphasis">_priv 权限也只有 root 才能拥有。</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">给 root 赋连接口令 grant all privileges on *.* to root@&#x27;%&#x27;  ;后新建的连接没有密码，需要设置密码才能远程连接。</span></span><br><span class="line"><span class="emphasis">update user set password=password(&#x27;root&#x27;) where user=&#x27;root&#x27; and host=&#x27;%&#x27;;</span></span><br><span class="line"><span class="emphasis">12345678910111213</span></span><br></pre></td></tr></table></figure>

<h5 id="2-2-收回权限"><a href="#2-2-收回权限" class="headerlink" title="2.2 收回权限"></a>2.2 收回权限</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">授权命令： </span><br><span class="line">revoke  权限1,权限2,…权限n on 数据库名称.表名称  from  用户名@用户地址 ;</span><br><span class="line"></span><br><span class="line">REVOKE ALL PRIVILEGES ON mysql.* FROM joe@localhost;</span><br><span class="line"><span class="section">#若赋的全库的表就 收回全库全表的所有权限</span></span><br><span class="line"></span><br><span class="line">REVOKE select,insert,update,delete ON mysql.* FROM joe@localhost;</span><br><span class="line"><span class="section">#收回mysql库下的所有表的插删改查权限</span></span><br><span class="line">对比赋予权限的方法。</span><br><span class="line">必须用户重新登录后才能生效</span><br><span class="line">12345678910</span><br></pre></td></tr></table></figure>

<h5 id="2-3-查看权限"><a href="#2-3-查看权限" class="headerlink" title="2.3 查看权限"></a>2.3 查看权限</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">查看当前用户权限</span><br><span class="line">show grants;</span><br><span class="line"> </span><br><span class="line">查看某用户的全局权限</span><br><span class="line">select  * from user ;</span><br><span class="line"> </span><br><span class="line">查看某用户的某库的权限</span><br><span class="line">select * from  db;</span><br><span class="line"> </span><br><span class="line">查看某用户的某个表的权限</span><br><span class="line">select * from tables<span class="emphasis">_priv;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">123456789101112</span></span><br></pre></td></tr></table></figure>

<h5 id="2-4-通过工具远程访问"><a href="#2-4-通过工具远程访问" class="headerlink" title="2.4 通过工具远程访问"></a>2.4 通过工具远程访问</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1、先 ping 一下数据库服务器的ip 地址确认网络畅通。</span><br><span class="line"> </span><br><span class="line">2、关闭数据库服务的防火墙</span><br><span class="line"><span class="code">    service iptables stop</span></span><br><span class="line"><span class="code"> </span></span><br><span class="line"><span class="code">3、 确认Mysql中已经有可以通过远程登录的账户</span></span><br><span class="line"><span class="code">    select  * from mysql.user where user=&#x27;li4&#x27; and host=&#x27;%&#x27;;</span></span><br><span class="line"><span class="code"> </span></span><br><span class="line"><span class="code">如果没有用户,先执行如下命令：</span></span><br><span class="line"><span class="code">    grant all privileges on *.*  to li4@&#x27;%&#x27;  identified by &#x27;123123&#x27;;</span></span><br><span class="line"><span class="code"> </span></span><br><span class="line"><span class="code">4、测试连接：</span></span><br><span class="line"><span class="code">123456789101112</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201130144732412.png" alt="在这里插入图片描述"></p>
<h4 id="3-mysql的一些杂项配置"><a href="#3-mysql的一些杂项配置" class="headerlink" title="3 mysql的一些杂项配置"></a>3 mysql的一些杂项配置</h4><h5 id="3-1-大小写问题"><a href="#3-1-大小写问题" class="headerlink" title="3.1 大小写问题"></a>3.1 大小写问题</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> SHOW VARIABLES LIKE &#x27;%lower<span class="emphasis">_case_</span>table<span class="emphasis">_names%&#x27; </span></span><br><span class="line"><span class="emphasis">1</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201130145104135.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">windows系统默认大小写不敏感，但是linux系统是大小写敏感的</span><br><span class="line">默认为0，大小写敏感。</span><br><span class="line">设置1，大小写不敏感。创建的表，数据库都是以小写形式存放在磁盘上，</span><br><span class="line">对于sql语句都是转换为小写对表和DB进行查找。</span><br><span class="line">设置2，创建的表和DB依据语句上格式存放，凡是查找都是转换为小</span><br><span class="line">写进行。 </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">设置变量常采用 set lower<span class="emphasis">_case_</span>table<span class="emphasis">_names = 1； 的方式，</span></span><br><span class="line"><span class="emphasis">但此变量是只读权限，所以需要在配置文件中改。</span></span><br><span class="line"><span class="emphasis">当想设置为大小写不敏感时，要在my.cnf这个配置文件 [mysqld] 中加入</span></span><br><span class="line"><span class="emphasis">lower_</span>case<span class="emphasis">_table_</span>names = 1 ，然后重启服务器。</span><br><span class="line">但是要在重启数据库实例之前就需要将原来的数据库和表转换为小写，</span><br><span class="line">否则更改后将找不到数据库名。</span><br><span class="line">在进行数据库参数设置之前，需要掌握这个参数带来的影响，</span><br><span class="line">切不可盲目设置。</span><br><span class="line"></span><br><span class="line">1234567891011121314151617</span><br></pre></td></tr></table></figure>

<h5 id="3-2-sql-mode"><a href="#3-2-sql-mode" class="headerlink" title="3.2 sql_mode"></a>3.2 sql_mode</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">MySQL的sql<span class="emphasis">_mode合理设置</span></span><br><span class="line"><span class="emphasis">sql_</span>mode是个很容易被忽视的变量，默认值是空值，在这种</span><br><span class="line">设置下是可以允许一些非法操作的，比如允许一些非法数据</span><br><span class="line">的插入。在生产环境必须将这个值设置为严格模式，所以开发、</span><br><span class="line">测试环境的数据库也必须要设置，这样在开发测试阶段就可以发现问题。</span><br><span class="line">12345</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201130145238544.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">使用 set sql<span class="emphasis">_mode=ONLY_</span>FULL<span class="emphasis">_GROUP_</span>BY; 的方式设置会将之前的设置覆盖掉</span><br><span class="line">同时设置多个限制：set sql<span class="emphasis">_mode=&#x27;ONLY_</span>FULL<span class="emphasis">_GROUP_</span>BY,NO<span class="emphasis">_AUTO_</span>VALUE<span class="emphasis">_ON_</span>ZERO&#x27;;</span><br><span class="line"> </span><br><span class="line">sql<span class="emphasis">_mode常用值如下： </span></span><br><span class="line"><span class="emphasis">ONLY_</span>FULL<span class="emphasis">_GROUP_</span>BY：</span><br><span class="line">对于GROUP BY聚合操作，如果在SELECT中的列，没有在GROUP BY</span><br><span class="line">中出现，那么这个SQL是不合法的，因为列不在GROUP BY从句中</span><br><span class="line"> </span><br><span class="line">NO<span class="emphasis">_AUTO_</span>VALUE<span class="emphasis">_ON_</span>ZERO：</span><br><span class="line">该值影响自增长列的插入。默认设置下，插入0或NULL代表生成下</span><br><span class="line">一个自增长值。如果用户 希望插入的值为0，而该列又是自增长的，</span><br><span class="line">那么这个选项就有用了。</span><br><span class="line"> </span><br><span class="line">STRICT<span class="emphasis">_TRANS_</span>TABLES：</span><br><span class="line">在该模式下，如果一个值不能插入到一个事务表中，则中断当前的</span><br><span class="line">操作，对非事务表不做限制</span><br><span class="line">NO<span class="emphasis">_ZERO_</span>IN<span class="emphasis">_DATE：</span></span><br><span class="line"><span class="emphasis">在严格模式下，不允许日期和月份为零</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">NO_</span>ZERO<span class="emphasis">_DATE：</span></span><br><span class="line"><span class="emphasis">设置该值，mysql数据库不允许插入零日期，插入零日期会抛出错误</span></span><br><span class="line"><span class="emphasis">而不是警告。</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">ERROR_</span>FOR<span class="emphasis">_DIVISION_</span>BY<span class="emphasis">_ZERO：</span></span><br><span class="line"><span class="emphasis">在INSERT或UPDATE过程中，如果数据被零除，则产生错误而非警告。</span></span><br><span class="line"><span class="emphasis">如果未给出该模式，那么数据被零除时MySQL返回NULL</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">NO_</span>AUTO<span class="emphasis">_CREATE_</span>USER：</span><br><span class="line">禁止GRANT创建密码为空的用户</span><br><span class="line"> </span><br><span class="line">NO<span class="emphasis">_ENGINE_</span>SUBSTITUTION：</span><br><span class="line">如果需要的存储引擎被禁用或未编译，那么抛出错误。不设置此值时，</span><br><span class="line">用默认的存储引擎替代，并抛出一个异常</span><br><span class="line"> </span><br><span class="line">PIPES<span class="emphasis">_AS_</span>CONCAT：</span><br><span class="line">将&quot;||&quot;视为字符串的连接操作符而非或运算符，这和Oracle数据库是一样的，</span><br><span class="line">也和字符串的拼接函数Concat相类似</span><br><span class="line"> </span><br><span class="line">ANSI<span class="emphasis">_QUOTES：</span></span><br><span class="line"><span class="emphasis">启用ANSI_</span>QUOTES后，不能用双引号来引用字符串，因为它被解</span><br><span class="line">释为识别符</span><br><span class="line"> </span><br><span class="line">ORACLE：</span><br><span class="line">  设置等同：PIPES<span class="emphasis">_AS_</span>CONCAT, ANSI<span class="emphasis">_QUOTES, IGNORE_</span>SPACE, NO<span class="emphasis">_KEY_</span>OPTIONS, NO<span class="emphasis">_TABLE_</span>OPTIONS, NO<span class="emphasis">_FIELD_</span>OPTIONS, NO<span class="emphasis">_AUTO_</span>CREATE<span class="emphasis">_USER.</span></span><br><span class="line"><span class="emphasis">1234567891011121314151617181920212223242526272829303132333435363738394041424344</span></span><br></pre></td></tr></table></figure>

<h4 id="4-Mysql逻辑架构"><a href="#4-Mysql逻辑架构" class="headerlink" title="4 Mysql逻辑架构"></a>4 Mysql逻辑架构</h4><h5 id="4-1-总体概览"><a href="#4-1-总体概览" class="headerlink" title="4.1 总体概览"></a>4.1 总体概览</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">和其它数据库相比，MySQL有点与众不同，它的架构可以</span><br><span class="line">在多种不同场景中应用并发挥良好作用。主要体现在存储引擎的</span><br><span class="line">架构上，</span><br><span class="line">插件式的存储引擎架构将查询处理和其它的系统任务以及数据</span><br><span class="line">的存储提取相分离。这种架构可以根据业务的需求和实际需要选</span><br><span class="line">择合适的存储引擎。</span><br><span class="line">123456</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201130145737547.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">1.连接层</span><br><span class="line">最上层是一些客户端和连接服务，包含本地sock通信和大多数基于</span><br><span class="line">客户端/服务端工具实现的类似于tcp/ip的通信。主要完成一些类似</span><br><span class="line">于连接处理、授权认证、及相关的安全方案。在该层上引入了线程池的概念，</span><br><span class="line">为通过认证安全接入的客户端提供线程。同样在该层上可以实现基于SSL</span><br><span class="line">的安全链接。服务器也会为安全接入的每个客户端验证它所具有的操</span><br><span class="line">作权限。</span><br><span class="line"> </span><br><span class="line">2.服务层</span><br><span class="line"> </span><br><span class="line">2.1  Management Serveices &amp; Utilities： 系统管理和控制工具  </span><br><span class="line">2.2  SQL Interface: SQL接口</span><br><span class="line"><span class="code">      接受用户的SQL命令，并且返回用户需要查询的结果。比如select from就</span></span><br><span class="line"><span class="code">是调用SQL Interface</span></span><br><span class="line"><span class="code">2.3 Parser: 解析器</span></span><br><span class="line"><span class="code">       SQL命令传递到解析器的时候会被解析器验证和解析。 </span></span><br><span class="line"><span class="code">2.4 Optimizer: 查询优化器。</span></span><br><span class="line"><span class="code">     SQL语句在查询之前会使用查询优化器对查询进行优化。 </span></span><br><span class="line"><span class="code">     用一个例子就可以理解： select uid,name from user where  gender= 1;</span></span><br><span class="line"><span class="code">     优化器来决定先投影还是先过滤。</span></span><br><span class="line"><span class="code">  </span></span><br><span class="line"><span class="code">2.5 Cache和Buffer： 查询缓存。</span></span><br><span class="line"><span class="code">      如果查询缓存有命中的查询结果，查询语句就可以直接去查询缓存中取数据。</span></span><br><span class="line"><span class="code">      这个缓存机制是由一系列小缓存组成的。比如表缓存，记录缓存，</span></span><br><span class="line"><span class="code"> key缓存，权限缓存等</span></span><br><span class="line"><span class="code">       缓存是负责读，缓冲负责写。</span></span><br><span class="line"><span class="code"> </span></span><br><span class="line"><span class="code"> </span></span><br><span class="line"><span class="code">3.引擎层</span></span><br><span class="line"><span class="code">存储引擎层，存储引擎真正的负责了MySQL中数据的存储和提取，服</span></span><br><span class="line"><span class="code">务器通过API与存储引擎进行通信。不同的存储引擎具有的功能不同，</span></span><br><span class="line"><span class="code">这样我们可以根据自己的实际需要进行选取。</span></span><br><span class="line"><span class="code">后面介绍MyISAM和InnoDB</span></span><br><span class="line"><span class="code"> </span></span><br><span class="line"><span class="code">4.存储层</span></span><br><span class="line"><span class="code">数据存储层，主要是将数据存储在运行于裸设备的文件系统之上，</span></span><br><span class="line"><span class="code">并完成与存储引擎的交互。</span></span><br><span class="line"><span class="code">12345678910111213141516171819202122232425262728293031323334353637</span></span><br></pre></td></tr></table></figure>

<h4 id="5-Mysql存储引擎"><a href="#5-Mysql存储引擎" class="headerlink" title="5 Mysql存储引擎"></a>5 Mysql存储引擎</h4><h5 id="5-1-查看命令"><a href="#5-1-查看命令" class="headerlink" title="5.1 查看命令"></a>5.1 查看命令</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1 如何用命令查看</span><br><span class="line">  #看你的mysql现在已提供什么存储引擎:</span><br><span class="line">  mysql&gt; show engines;</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201130150959338.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">#看你的mysql当前默认的存储引擎:</span></span><br><span class="line">mysql&gt; show variables like &#x27;%storage<span class="emphasis">_engine%&#x27;;</span></span><br><span class="line"><span class="emphasis">12</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201130151102553.png" alt="在这里插入图片描述"></p>
<h5 id="5-2-各个引擎简介"><a href="#5-2-各个引擎简介" class="headerlink" title="5.2 各个引擎简介"></a>5.2 各个引擎简介</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">1、InnoDB存储引擎</span><br><span class="line">InnoDB是MySQL的默认事务型引擎，它被设计用来处理大量的</span><br><span class="line">短期(short-lived)事务。除非有非常特别的原因需要使用其他的存储</span><br><span class="line">引擎，否则应该优先考虑InnoDB引擎。行级锁，适合高并发情况</span><br><span class="line"> </span><br><span class="line">2、MyISAM存储引擎</span><br><span class="line">MyISAM提供了大量的特性，包括全文索引、压缩、空间函数(GIS)等，</span><br><span class="line">但MyISAM不支持事务和行级锁(myisam改表时会将整个表全锁住)，</span><br><span class="line">有一个毫无疑问的缺陷就是崩溃后无法安全恢复。</span><br><span class="line"> </span><br><span class="line">3、Archive引擎</span><br><span class="line">Archive存储引擎只支持INSERT和SELECT操作，在MySQL5.1之前不</span><br><span class="line">支持索引。</span><br><span class="line">Archive表适合日志和数据采集类应用。适合低访问量大数据等情况。</span><br><span class="line">根据英文的测试结论来看，Archive表比MyISAM表要小大约75%，比支</span><br><span class="line">持事务处理的InnoDB表小大约83%。</span><br><span class="line"> </span><br><span class="line">4、Blackhole引擎</span><br><span class="line">Blackhole引擎没有实现任何存储机制，它会丢弃所有插入的数据，不</span><br><span class="line">做任何保存。但服务器会记录Blackhole表的日志，所以可以用于复制</span><br><span class="line">数据到备库，或者简单地记录到日志。但这种应用方式会碰到很多</span><br><span class="line">问题，因此并不推荐。</span><br><span class="line"> </span><br><span class="line">5、CSV引擎</span><br><span class="line">CSV引擎可以将普通的CSV文件作为MySQL的表来处理，但不支持索引。</span><br><span class="line">CSV引擎可以作为一种数据交换的机制，非常有用。</span><br><span class="line">CSV存储的数据直接可以在操作系统里，用文本编辑器，或者excel读取。</span><br><span class="line"> </span><br><span class="line">6、Memory引擎</span><br><span class="line">如果需要快速地访问数据，并且这些数据不会被修改，重启</span><br><span class="line">以后丢失也没有关系，那么使用Memory表是非常有用。Memory</span><br><span class="line">表至少比MyISAM表要快一个数量级。(使用专业的内存数据库更</span><br><span class="line">快，如redis)</span><br><span class="line"> </span><br><span class="line">7、Federated引擎</span><br><span class="line">Federated引擎是访问其他MySQL服务器的一个代理，尽管该引</span><br><span class="line">擎看起来提供了一种很好的跨服务器的灵活性，但也经常带来问</span><br><span class="line">题，因此默认是禁用的。</span><br><span class="line">1234567891011121314151617181920212223242526272829303132333435363738</span><br></pre></td></tr></table></figure>

<h6 id="5-2-1-MyISAM和InnoDB"><a href="#5-2-1-MyISAM和InnoDB" class="headerlink" title="5.2.1 MyISAM和InnoDB"></a>5.2.1 MyISAM和InnoDB</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202083627226.png" alt="在这里插入图片描述"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202083540526.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">innodb 索引 使用 B+TREE myisam 索引使用 b-tree</span><br><span class="line">innodb 主键为聚簇索引，基于聚簇索引的增删改查效率非常高。</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<h4 id="6-索引优化分析"><a href="#6-索引优化分析" class="headerlink" title="6 索引优化分析"></a>6 索引优化分析</h4><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">性能下降SQL慢，执行时间长，等待时间长</span><br><span class="line"></span><br><span class="line">查询数据过多</span><br><span class="line">能不能拆，条件过滤尽量少</span><br><span class="line"></span><br><span class="line">关联了太多的表，太多 Join</span><br><span class="line">join 原理。用  A 表的每一条数据 扫描 B表的所有数据。所以尽量先过滤。</span><br><span class="line"></span><br><span class="line">没有利用到索引</span><br><span class="line">单值</span><br><span class="line">复合</span><br><span class="line">条件多时，可以建共同索引(混合索引)。混合索引一般会偶先使用。</span><br><span class="line">有些情况下，就算有索引具体执行时也不会被使 用。</span><br><span class="line"></span><br><span class="line">服务器调优及各个参数设置（缓冲、线程数等）</span><br><span class="line">123456789101112131415</span><br></pre></td></tr></table></figure>

<h4 id="7-手写跟机读"><a href="#7-手写跟机读" class="headerlink" title="7 手写跟机读"></a>7 手写跟机读</h4><h5 id="7-1-手写"><a href="#7-1-手写" class="headerlink" title="7.1 手写"></a>7.1 手写</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201130104201110.png" alt="在这里插入图片描述"></p>
<h5 id="7-2-机读"><a href="#7-2-机读" class="headerlink" title="7.2 机读"></a>7.2 机读</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">随着Mysql版本的更新换代，其优化器也在不断的升级，优化</span><br><span class="line">器会分析不同执行顺序产生的性能消耗不同而动态调整执行顺序。</span><br><span class="line">下面是经常出现的查询顺序：</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202084729474.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201130104437465.png" alt="在这里插入图片描述"></p>
<h4 id="8-七种join"><a href="#8-七种join" class="headerlink" title="8 七种join"></a>8 七种join</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20200730102829640.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20200730103243988.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">1 A、B两表共有</span><br><span class="line"> select * from t<span class="emphasis">_emp a inner join t_</span>dept b on a.deptId = b.id;</span><br><span class="line"> </span><br><span class="line">2 A、B两表共有+A的独有</span><br><span class="line"> select * from t<span class="emphasis">_emp a left join t_</span>dept b on a.deptId = b.id;</span><br><span class="line"> </span><br><span class="line">3 A、B两表共有+B的独有</span><br><span class="line"> select * from t<span class="emphasis">_emp a right join t_</span>dept b on a.deptId = b.id;</span><br><span class="line"> </span><br><span class="line">4 A的独有 </span><br><span class="line">select * from t<span class="emphasis">_emp a left join t_</span>dept b on a.deptId = b.id where b.id is null; </span><br><span class="line"> </span><br><span class="line">5 B的独有</span><br><span class="line"> select * from t<span class="emphasis">_emp a right join t_</span>dept b on a.deptId = b.id where a.deptId is null;  </span><br><span class="line"> </span><br><span class="line">6 AB全有</span><br><span class="line"><span class="section">#MySQL Full Join的实现 因为MySQL不支持FULL JOIN,下面是替代方法</span></span><br><span class="line"> #left join + union(可去除重复数据)+ right join</span><br><span class="line">SELECT * FROM t<span class="emphasis">_emp A LEFT JOIN t_</span>dept B ON A.deptId = B.id</span><br><span class="line">UNION</span><br><span class="line">SELECT * FROM t<span class="emphasis">_emp A RIGHT JOIN t_</span>dept B ON A.deptId = B.id</span><br><span class="line"> 这里因为要联合的缘故，不能考虑到小表驱动大表的情况。只能用right join。要保证查询出来的数字要一致。</span><br><span class="line">7 A的独有+B的独有</span><br><span class="line"><span class="bullet">        *</span> FROM t<span class="emphasis">_emp A LEFT JOIN t_</span>dept B ON A.deptId = B.id WHERE B.<span class="code">`id`</span> IS NULL</span><br><span class="line">UNION</span><br><span class="line">SELECT * FROM t<span class="emphasis">_emp A RIGHT JOIN t_</span>dept B ON A.deptId = B.id WHERE A.<span class="code">`deptId`</span> IS NULL;</span><br><span class="line"></span><br><span class="line">123456789101112131415161718192021222324252627</span><br></pre></td></tr></table></figure>

<h4 id="9-索引"><a href="#9-索引" class="headerlink" title="9 索引"></a>9 索引</h4><h5 id="9-1-是什么"><a href="#9-1-是什么" class="headerlink" title="9.1 是什么"></a>9.1 是什么</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">MYSQL官方对索引的定义为：索引（ Index）是帮助mysql高效获取数</span><br><span class="line">据的数据结构。</span><br><span class="line">可以得到索引的本质：索引是数据结构。</span><br><span class="line">123</span><br><span class="line">索引的目的在于提高查询效率，可以类比字典，</span><br><span class="line">如果要查“mysql”这个单词，我们肯定需要定位到m字母，</span><br><span class="line">然后从下往下找到y字母，再找到剩下的sql。</span><br><span class="line">如果没有索引，那么你可能需要a----z</span><br><span class="line">你可以简单理解为“排好序的快速查找数据结构</span><br><span class="line">12345</span><br><span class="line">在数据之外，数据库系统还维护着满足特定查找算法的数据结构，</span><br><span class="line">这些数据结构以某种方式引用（指向）数据，</span><br><span class="line">这样就可以在这些数据结构上实现高级查找算法。这种数据</span><br><span class="line">结构，就是索引。下图就是一种可能的索引方式示例：</span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201130153740652.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">左边是数据表，一共有两列七条记录，最左边的是数据记录的物理地址</span><br><span class="line">为了加快Col2的查找，可以维护一个右边所示的二叉查找树，每个</span><br><span class="line">节点分别包含索引键值和一个指向对应数据记录物理地址的指针，这</span><br><span class="line">样就可以运用二叉查找在一定的复杂度内获取到相应数据，从而快速</span><br><span class="line">的检索出符合条件的记录。</span><br><span class="line">二叉树弊端之一：二叉树很可能会发生两边不平衡的情况。</span><br><span class="line">B-TREE: (B:balance)  会自动根据两边的情况自动调节，使两端无</span><br><span class="line">限趋近于平衡状态。可以使性能最稳定。(myisam使用的方式)</span><br><span class="line"> B-TREE弊端：(插入/修改操作多时，B-TREE会不断调整平衡，</span><br><span class="line"> 消耗性能)从侧面说明了索引不是越多越好。</span><br><span class="line">B+TREE:Innodb 所使用的索引</span><br><span class="line"></span><br><span class="line">123456789101112</span><br><span class="line">一般来说索引本身也很大，不可能全部存储在内存中，因此索引往往</span><br><span class="line">以索引文件的形式存储的磁盘上</span><br><span class="line"></span><br><span class="line">我们平常所说的索引，如果没有特别指明，都是指B树（多路搜索树，</span><br><span class="line">并不一定是二叉的）结构组织的索引。</span><br><span class="line">其中聚集索引，次要索引，覆盖索引，复合索引，前缀索引，唯一</span><br><span class="line">索引默认都是使用B+树索引，统称索引。</span><br><span class="line">当然，除了B+树这种类型的索引之外，还有哈稀索引（ hash index）等。</span><br><span class="line">12345678</span><br></pre></td></tr></table></figure>

<h5 id="9-2-优势-劣势"><a href="#9-2-优势-劣势" class="headerlink" title="9.2 优势 &amp;&amp; 劣势"></a>9.2 优势 &amp;&amp; 劣势</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">优势</span><br><span class="line">类似大学图书馆建书目索引，提高数据检索的效率，降低数据库的IO成本；</span><br><span class="line">通过索引列对数据进行排序，降低数据排序的成本，降低了CPU的消耗</span><br><span class="line"></span><br><span class="line">劣势</span><br><span class="line">实际上素引也是一张表，该表保存了主键与素引字段，并指向实</span><br><span class="line">体表的记录，所以索引列也是要占用空间的</span><br><span class="line"></span><br><span class="line">虽然索引大大提高了査询速度，同时却会降低更新表的速度，</span><br><span class="line">如对表进行 INSERT、 UPDATE和 DELETE。</span><br><span class="line">因为更新表时， MYSQL不仅要保存数据，还要保存一下索引文</span><br><span class="line">件每次更新添加了索引列的字段，都会调整因为更新所带来的键值变</span><br><span class="line">化后的素引信息</span><br><span class="line"></span><br><span class="line">索引只是提高效率的一个因素，如果你的 MYSQL有大数据量的表，</span><br><span class="line">就需要花时间研究建立最优秀的索引，或优化査询语句</span><br><span class="line">12345678910111213141516</span><br></pre></td></tr></table></figure>

<h4 id="10-mysq索引结构"><a href="#10-mysq索引结构" class="headerlink" title="10 mysq索引结构"></a>10 mysq索引结构</h4><h5 id="10-1-Myisam普通素引"><a href="#10-1-Myisam普通素引" class="headerlink" title="10.1 Myisam普通素引"></a>10.1 Myisam普通素引</h5><h6 id="10-1-1-Btree索引"><a href="#10-1-1-Btree索引" class="headerlink" title="10.1.1 Btree索引"></a>10.1.1 Btree索引</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202092642918.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">【初始化介绍】 </span><br><span class="line">一颗b树，浅蓝色的块我们称之为一个磁盘块，可以看到每个磁盘块</span><br><span class="line">包含几个数据项（深蓝色所示）和指针（黄色所示），</span><br><span class="line">如磁盘块1包含数据项17和35，包含指针P1、P2、P3，</span><br><span class="line">P1表示小于17的磁盘块，P2表示在17和35之间的磁盘块，P3表示</span><br><span class="line">大于35的磁盘块。</span><br><span class="line">真实的数据存在于叶子节点即3、5、9、10、13、15、28、29、36、60、75、79、90、99。</span><br><span class="line">非叶子节点不存储真实的数据，只存储指引搜索方向的数据项，如17、35并</span><br><span class="line">不真实存在于数据表中。</span><br><span class="line"> </span><br><span class="line">【查找过程】</span><br><span class="line">如果要查找数据项29，那么首先会把磁盘块1由磁盘加载到内存，此</span><br><span class="line">时发生一次IO，在内存中用二分查找确定29在17和35之间，锁定磁</span><br><span class="line">盘块1的P2指针，内存时间因为非常短（相比磁盘的IO）可以忽略</span><br><span class="line">不计，通过磁盘块1的P2指针的磁盘地址把磁盘块3由磁盘加载</span><br><span class="line">到内存，发生第二次IO，29在26和30之间，锁定磁盘块3的P2指针，</span><br><span class="line">通过指针加载磁盘块8到内存，发生第三次IO，同时内存中做二</span><br><span class="line">分查找找到29，结束查询，总计三次IO。</span><br><span class="line"> </span><br><span class="line">真实的情况是，3层的b+树可以表示上百万的数据，如果上百万的</span><br><span class="line">数据查找只需要三次IO，性能提高将是巨大的，如果没有索引，每</span><br><span class="line">个数据项都要发生一次IO，那么总共需要百万次的IO，显然成</span><br><span class="line">本非常非常高。</span><br><span class="line">1234567891011121314151617181920212223</span><br></pre></td></tr></table></figure>

<h6 id="10-1-2-关于时间复杂度"><a href="#10-1-2-关于时间复杂度" class="headerlink" title="10.1.2 关于时间复杂度"></a>10.1.2 关于时间复杂度</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">同一问题可用不同算法解决，而一个算法的质量优劣将影响到</span><br><span class="line">算法乃至程序的效率。算法分析的目的在于选择合适算法和改进算法。</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202092945674.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202092957555.png" alt="在这里插入图片描述"></p>
<h5 id="10-2-innodb的普通素引"><a href="#10-2-innodb的普通素引" class="headerlink" title="10.2 innodb的普通素引"></a>10.2 innodb的普通素引</h5><h6 id="10-2-1-B-Tree索引"><a href="#10-2-1-B-Tree索引" class="headerlink" title="10.2.1 B+Tree索引"></a>10.2.1 B+Tree索引</h6><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202093428268.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">B+TREE 第二级的 数据并不能直接取出来，只作索引使用。在内</span><br><span class="line">存有限的情况下，查询效率高于 B-TREE</span><br><span class="line">B-TREE 第二级可以直接取出来，树形结构比较重，在内存无</span><br><span class="line">限大的时候有优势。</span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<h6 id="10-2-2-B树和B-树的区别"><a href="#10-2-2-B树和B-树的区别" class="headerlink" title="10.2.2 B树和B+树的区别"></a>10.2.2 B树和B+树的区别</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">B+Tree与B-Tree 的区别：结论在内存有限的情况下，B+TREE永远比</span><br><span class="line"> B-TREE好。无限内存则后者方便</span><br><span class="line"> </span><br><span class="line">　1）B-树的关键字和记录是放在一起的，叶子节点可以看作外部节点，</span><br><span class="line">不包含任何信息；B+树叶子节点中只有关键字和指向下一个节点的索引，</span><br><span class="line">记录只放在叶子节点中。(一次查询可能进行两次i/o操作)</span><br><span class="line">　 2）在B-树中，越靠近根节点的记录查找时间越快，只要找到关键字</span><br><span class="line">即可确定记录的存在；而B+树中每个记录的查找时间基本是一样的，</span><br><span class="line">都需要从根节点走到叶子节点，而且在叶子节点中还要再比较关键字。</span><br><span class="line">从这个角度看B-树的性能好像要比B+树好，而在实际应用中却是B+</span><br><span class="line">树的性能要好些。因为B+树的非叶子节点不存放实际的数据，这样每</span><br><span class="line">个节点可容纳的元素个数比B-树多，树高比B-树小，这样带来的好处</span><br><span class="line">是减少磁盘访问次数。尽管B+树找到一个记录所需的比较次数要比B-</span><br><span class="line">树多，但是一次磁盘访问的时间相当于成百上千次内存比较的时间，</span><br><span class="line">因此实际中B+树的性能可能还会好些，而且B+树的叶子节点使用指</span><br><span class="line">针连接在一起，方便顺序遍历（例如查看一个目录下的所有文件，</span><br><span class="line">一个表中的所有记录等），这也是很多数据库和文件系统使用B+</span><br><span class="line">树的缘故。 </span><br><span class="line">　</span><br><span class="line">思考：为什么说B+树比B-树更适合实际应用中操作系统的文件索</span><br><span class="line">引和数据库索引？ </span><br><span class="line">1) B+树的磁盘读写代价更低 </span><br><span class="line">　　B+树的内部结点并没有指向关键字具体信息的指针。因此其</span><br><span class="line">内部结点相对B 树更小。如果把所有同一内部结点的关键字存放在</span><br><span class="line">同一盘块中，那么盘块所能容纳的关键字数量也越多。一次性读入</span><br><span class="line">内存中的需要查找的关键字也就越多。相对来说IO读写次数也就降低了。 </span><br><span class="line">2) B+树的查询效率更加稳定 </span><br><span class="line">　　由于非终结点并不是最终指向文件内容的结点，而只是叶子结点</span><br><span class="line">中关键字的索引。所以任何关键字的查找必须走一条从根结点到叶子</span><br><span class="line">结点的路。所有关键字查询的路径长度相同，导致每一个数据的查询效率相当。</span><br><span class="line">123456789101112131415161718192021222324252627282930</span><br></pre></td></tr></table></figure>

<h4 id="11-mysq素引分类"><a href="#11-mysq素引分类" class="headerlink" title="11 mysq素引分类"></a>11 mysq素引分类</h4><h5 id="11-1-主键索引"><a href="#11-1-主键索引" class="headerlink" title="11.1 主键索引"></a>11.1 主键索引</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">设定为主键后数据库会自动建立索引， innodb为聚簇索引</span><br><span class="line">1</span><br><span class="line">随表一起建索引：</span><br><span class="line">CREATE TABLE customer (id INT(10) UNSIGNED  AUTO<span class="emphasis">_INCREMENT ,customer_</span>no VARCHAR(200),customer<span class="emphasis">_name VARCHAR(200),</span></span><br><span class="line"><span class="emphasis">  PRIMARY KEY(id) </span></span><br><span class="line"><span class="emphasis">);</span></span><br><span class="line"><span class="emphasis">unsigned (无符号的)</span></span><br><span class="line"><span class="emphasis">使用  AUTO_</span>INCREMENT 关键字的列必须有索引(只要有索引就行)。</span><br><span class="line"> </span><br><span class="line">CREATE TABLE customer2 (id INT(10) UNSIGNED   ,customer<span class="emphasis">_no VARCHAR(200),customer_</span>name VARCHAR(200),</span><br><span class="line">  PRIMARY KEY(id) </span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line"> 单独建主键索引：</span><br><span class="line">ALTER TABLE customer </span><br><span class="line"> add PRIMARY KEY customer(customer<span class="emphasis">_no);  </span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">删除建主键索引：</span></span><br><span class="line"><span class="emphasis">ALTER TABLE customer </span></span><br><span class="line"><span class="emphasis"> drop PRIMARY KEY ;  </span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">修改建主键索引：</span></span><br><span class="line"><span class="emphasis">必须先删除掉(drop)原索引，再新建(add)索引</span></span><br><span class="line"><span class="emphasis">123456789101112131415161718192021</span></span><br></pre></td></tr></table></figure>

<h5 id="11-2-单值索引"><a href="#11-2-单值索引" class="headerlink" title="11.2 单值索引"></a>11.2 单值索引</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">即一个素引只包含单个列，一个表可以有多个单列索引</span><br><span class="line">1</span><br><span class="line">索引建立成哪种索引类型？</span><br><span class="line">根据数据引擎类型自动选择的索引类型</span><br><span class="line">除了innodb 引擎主键默认为聚簇索引 外。 innodb 的索引都采用的 B+TREE</span><br><span class="line">myisam 则都采用的 B-TREE索引</span><br><span class="line">1234</span><br><span class="line">随表一起建索引：</span><br><span class="line">CREATE TABLE customer (id INT(10) UNSIGNED  AUTO<span class="emphasis">_INCREMENT ,customer_</span>no VARCHAR(200),customer<span class="emphasis">_name VARCHAR(200),</span></span><br><span class="line"><span class="emphasis">  PRIMARY KEY(id),</span></span><br><span class="line"><span class="emphasis">  KEY (customer_</span>name)  </span><br><span class="line">);</span><br><span class="line"> 随表一起建立的索引 索引名同 列名(customer<span class="emphasis">_name)</span></span><br><span class="line"><span class="emphasis">单独建单值索引：</span></span><br><span class="line"><span class="emphasis">CREATE  INDEX idx_</span>customer<span class="emphasis">_name ON customer(customer_</span>name); </span><br><span class="line"> </span><br><span class="line">删除索引：</span><br><span class="line">DROP INDEX idx<span class="emphasis">_customer_</span>name ;</span><br><span class="line">1234567891011</span><br></pre></td></tr></table></figure>

<h5 id="11-3-唯一索引"><a href="#11-3-唯一索引" class="headerlink" title="11.3 唯一索引"></a>11.3 唯一索引</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">索引列的值必须唯一，但允许有空值</span><br><span class="line">1</span><br><span class="line">随表一起建索引：</span><br><span class="line">CREATE TABLE customer (id INT(10) UNSIGNED  AUTO<span class="emphasis">_INCREMENT ,customer_</span>no VARCHAR(200),customer<span class="emphasis">_name VARCHAR(200),</span></span><br><span class="line"><span class="emphasis">  PRIMARY KEY(id),</span></span><br><span class="line"><span class="emphasis">  KEY (customer_</span>name),</span><br><span class="line">  UNIQUE (customer<span class="emphasis">_no)</span></span><br><span class="line"><span class="emphasis">);</span></span><br><span class="line"><span class="emphasis">建立 唯一索引时必须保证所有的值是唯一的（除了null），若有重复数据，会报错。  </span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">单独建唯一索引：</span></span><br><span class="line"><span class="emphasis">CREATE UNIQUE INDEX idx_</span>customer<span class="emphasis">_no ON customer(customer_</span>no); </span><br><span class="line"> </span><br><span class="line">删除索引：</span><br><span class="line">DROP INDEX idx<span class="emphasis">_customer_</span>no on customer ;</span><br><span class="line">12345678910111213</span><br></pre></td></tr></table></figure>

<h5 id="11-4-复合索引"><a href="#11-4-复合索引" class="headerlink" title="11.4 复合索引"></a>11.4 复合索引</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">即一个索引包含多个列</span><br><span class="line">在数据库操作期间，复合索引比单值索引所需要的开销更小（对于相同的多个列建索引）</span><br><span class="line">当表的行数远大于索引列的数目时可以使用复合索弓</span><br><span class="line">123</span><br><span class="line"> 随表一起建索引：</span><br><span class="line">CREATE TABLE customer (id INT(10) UNSIGNED  AUTO<span class="emphasis">_INCREMENT ,customer_</span>no VARCHAR(200),customer<span class="emphasis">_name VARCHAR(200),</span></span><br><span class="line"><span class="emphasis">  PRIMARY KEY(id),</span></span><br><span class="line"><span class="emphasis">  KEY (customer_</span>name),</span><br><span class="line">  UNIQUE (customer<span class="emphasis">_name),</span></span><br><span class="line"><span class="emphasis">  KEY (customer_</span>no,customer<span class="emphasis">_name)</span></span><br><span class="line"><span class="emphasis">);</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">单独建索引：</span></span><br><span class="line"><span class="emphasis">CREATE  INDEX idx_</span>no<span class="emphasis">_name ON customer(customer_</span>no,customer<span class="emphasis">_name); </span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">删除索引：</span></span><br><span class="line"><span class="emphasis">DROP INDEX idx_</span>no<span class="emphasis">_name  on customer ;</span></span><br><span class="line"><span class="emphasis">12345678910111213</span></span><br></pre></td></tr></table></figure>

<h5 id="11-5-基本语法"><a href="#11-5-基本语法" class="headerlink" title="11.5 基本语法"></a>11.5 基本语法</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">创建 <span class="keyword">ALTER</span> mytable <span class="keyword">ADD</span>  [<span class="keyword">UNIQUE</span>] INDEX [indexname]  <span class="keyword">ON</span>  (columnname(length))</span><br><span class="line">删除 <span class="keyword">DROP</span> INDEX [indexname] <span class="keyword">ON</span> mytable;</span><br><span class="line">查看 <span class="keyword">SHOW</span> INDEX <span class="keyword">FROM</span> table_name\G</span><br><span class="line"><span class="number">123</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202095755996.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">non<span class="emphasis">_unique: 是否是唯一索引  1：是   0：不是</span></span><br><span class="line"><span class="emphasis">seq_</span>in<span class="emphasis">_index:列 在索引中的 序列。针对符合索引(一个索引对应多个列)。</span></span><br><span class="line"><span class="emphasis">针对同一个复合索引 按照创建复合索引时的顺序进行排序</span></span><br><span class="line"><span class="emphasis">collation:</span></span><br><span class="line"><span class="emphasis">cardinality:</span></span><br><span class="line"><span class="emphasis">sub_</span>part:</span><br><span class="line">packed:</span><br><span class="line">Null:是否允许 null 值</span><br><span class="line"></span><br><span class="line">123456789</span><br><span class="line">使用 ALTERI命令</span><br><span class="line">有四种方式来添加数据表的索引：</span><br><span class="line">ALTER TABLE tbl<span class="emphasis">_name ADD PRIMARY KEY (column_</span>list): 该语句添加一个主键，这意味着索引值必须是唯一的，且不能为NULL。</span><br><span class="line"> </span><br><span class="line">ALTER TABLE tbl<span class="emphasis">_name ADD UNIQUE index_</span>name (column<span class="emphasis">_list): 这条语句创建索引的值必须是唯一的（除了NULL外，NULL可能会出现多次）。</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">ALTER TABLE tbl_</span>name ADD INDEX index<span class="emphasis">_name (column_</span>list): 添加普通索引，索引值可出现多次。</span><br><span class="line"> </span><br><span class="line">ALTER TABLE tbl<span class="emphasis">_name ADD FULLTEXT index_</span>name (column<span class="emphasis">_list):该语句指定了索引为 FULLTEXT ，用于全文索引。</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">12345678910</span></span><br></pre></td></tr></table></figure>

<h5 id="11-6-哪些情况需要创建索引"><a href="#11-6-哪些情况需要创建索引" class="headerlink" title="11.6 哪些情况需要创建索引"></a>11.6 哪些情况需要创建索引</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">1.主键自动建立唯一索引</span><br><span class="line">2.频繁作为查询条件的字段应该创建索引（where后面的语句）</span><br><span class="line">12</span><br><span class="line">3.查询中与其它表关联的字段，外键关系建立索引</span><br><span class="line"></span><br><span class="line">A 表关联 B 表：A join B  。  on 后面的连接条件 既 A 表查询 B 表的条</span><br><span class="line">件。所以 B 表被关联的字段建立索引能大大提高查询效率</span><br><span class="line">因为在 join 中，join 左边的表会用每一个字段去遍历 B 表的所有</span><br><span class="line">的关联数据，相当于一个查询操作</span><br><span class="line"></span><br><span class="line">1234567</span><br><span class="line">4.单键/组合索引的选择问题，Who？(在高并发下倾向创建组合索引)</span><br><span class="line">1</span><br><span class="line">5.查询中排序的字段，排序字段若通过索引去访问将大大提高排序速度</span><br><span class="line">group by 和 order by 后面的字段有索引大大提高效率</span><br><span class="line">12</span><br><span class="line">6.查询中统计或者分组字段</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h5 id="11-7-哪些情况不要创建索引"><a href="#11-7-哪些情况不要创建索引" class="headerlink" title="11.7 哪些情况不要创建索引"></a>11.7 哪些情况不要创建索引</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1.表记录太少</span><br><span class="line">1</span><br><span class="line">2.经常増删改的表</span><br><span class="line">Why：提高了查询速度，同时却会降低更新表的速度，</span><br><span class="line">如对表进行INSERT、 UPDATE和 DELETE.</span><br><span class="line">因为更新表时， MYSQL不仅要保存数据，还要保存一下素引文件</span><br><span class="line">1234</span><br><span class="line"><span class="bullet">3.</span> Where条件里用不到的字段不创建索引</span><br><span class="line">索引建多了影响 增删改 的效率</span><br><span class="line">12</span><br><span class="line">4.数据重复且分布平均的表字段,因此应该只为最经常查询和最经</span><br><span class="line">常排序的数据列建立索引。</span><br><span class="line">注意，如果某个数据列包含许多重复的内容，为它建立索引就没</span><br><span class="line">有太大的实际效果。</span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<h4 id="12-性能分析"><a href="#12-性能分析" class="headerlink" title="12 性能分析"></a>12 性能分析</h4><h5 id="12-1-MYSQL常见瓶颈"><a href="#12-1-MYSQL常见瓶颈" class="headerlink" title="12.1 MYSQL常见瓶颈"></a>12.1 MYSQL常见瓶颈</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">CPU </span><br><span class="line">SQL中对大量数据进行比较、关联、排序、分组</span><br><span class="line">最大的压力在于 比较</span><br><span class="line"></span><br><span class="line">IO</span><br><span class="line">实际内存满足不了缓存数据或排序等需要，导致产生大量物理IO</span><br><span class="line">查询执行效率低，扫描过多数据行。</span><br><span class="line"></span><br><span class="line">锁</span><br><span class="line">不适宜的锁的设置，导致线程阻塞，性能下降。</span><br><span class="line">死锁，线程之间交叉调用资源，导致死锁，程序卡住。</span><br><span class="line"></span><br><span class="line">服务器硬件的性能瓶颈：top,free, iostat和 vmstat来查看系统</span><br><span class="line">的性能状态</span><br><span class="line">1234567891011121314</span><br></pre></td></tr></table></figure>

<h5 id="12-2-Explain"><a href="#12-2-Explain" class="headerlink" title="12.2 Explain"></a>12.2 Explain</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">使用 EXPLAIN关键字可以模拟优化器执行SQL查询语句，从</span><br><span class="line">而知道MySQL是</span><br><span class="line">如何处理你的SQL语句的。分析你的查询语句或是表结构的</span><br><span class="line">性能瓶颈</span><br><span class="line">1234</span><br><span class="line">表的读取顺序</span><br><span class="line">哪些索引可以使用</span><br><span class="line">数据读取操作的操作类型</span><br><span class="line">哪些索引被实际使用</span><br><span class="line">表之间的引用</span><br><span class="line">每张表有多少行被优化器查询</span><br><span class="line">123456</span><br></pre></td></tr></table></figure>

<h5 id="12-3-执行计划包含的信息"><a href="#12-3-执行计划包含的信息" class="headerlink" title="12.3 执行计划包含的信息"></a>12.3 执行计划包含的信息</h5><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/2020120210534494.png" alt="在这里插入图片描述"></p>
<h6 id="12-3-1-id"><a href="#12-3-1-id" class="headerlink" title="12.3.1 id"></a>12.3.1 id</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">select查询的序列号，包含一组数字表示查询中执行 select子句</span><br><span class="line">或操作表的顺序</span><br><span class="line">12</span><br><span class="line">三种情況</span><br><span class="line">id相同，执行顺序由上至下  </span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202142409303.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">此例中 先执行where 后的第一条语句 t1.id = t2.id 通过 t1.id 关联 t2.id 。 </span><br><span class="line">而  t2.id 的结果建立在 t2.id=t3.id 的基础之上。</span><br><span class="line">12</span><br><span class="line">id不同，如果是子查询，id的序号会增，id值越大优先级越高，</span><br><span class="line">越先被执行</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202142536548.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">id相同不同，同时存在</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202140414660.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">id如果相同，可以认为是一组，从上往下顺序执行；</span><br><span class="line">在所有组中，id值越大，优先级越高，越先执行</span><br><span class="line"> </span><br><span class="line">衍生表 = derived2 --&gt; derived + 2 （2 表示由 id =2 的查询衍生出来的表。</span><br><span class="line">type 肯定是 all ，因为衍生的表没有建立索引）</span><br><span class="line">12345</span><br></pre></td></tr></table></figure>

<h6 id="12-3-2-select-type"><a href="#12-3-2-select-type" class="headerlink" title="12.3.2 select_type"></a>12.3.2 select_type</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">查询的类型，主要是用于区别普通查询、联合查询、子查询</span><br><span class="line">等的复杂查询表示 SELECT 的类型，常见的取值，如下表所示：</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/2020120214145716.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SIMPLE</span><br><span class="line">简单的 select查询，查询中不包含子查询或者 UNION</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202143803751.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PRIMARY</span><br><span class="line">查询中若包含任何复杂的子部分，最外层查询则被标记为 Primary</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202143926349.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DERIVED</span><br><span class="line">在FROM列表中包含的子查询被标记为 DERIVED(衍生)</span><br><span class="line">MYSQL会递归执行这些子查询，把结果放在临时表里。</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202144251856.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SUBQUERY</span><br><span class="line">在 SELECTI或 WHERE列表中包含了子查询</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202144441536.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DEPENDENT SUBQUERY</span><br><span class="line">在 SELECT或WHERE列表中包含了子査询，子査询基于外层</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202144652540.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">dependent subquery 与 subquery 的区别</span><br><span class="line">依赖子查询 ： 子查询结果为 多值</span><br><span class="line">子查询：查询结果为 单值 </span><br><span class="line"></span><br><span class="line">1234</span><br><span class="line">UNCACHEABLE SUBQUREY</span><br><span class="line">无法被缓存的子查询</span><br><span class="line">图中的 @@ 表示查的环境参数 。没办法缓存</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202144928700.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UNION</span><br><span class="line">若第二个 SELECT出现在 UNION之后，则被标记为 UNION</span><br><span class="line">若 UNION包含在FROM子句的子查询中，外层 SELECT将被标记为： </span><br><span class="line">DERIVED</span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202145225866.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">UNION RESULT 两个语句执行完后的结果</span><br><span class="line">1</span><br><span class="line">UNION RESULT </span><br><span class="line">从 UNION表获取结果的 SELECT</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202150004902.png" alt="在这里插入图片描述"></p>
<h6 id="12-3-3-table"><a href="#12-3-3-table" class="headerlink" title="12.3.3 table"></a>12.3.3 table</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">显示这一行的数据是关于哪张表的</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<h6 id="12-3-4-访问类型排列"><a href="#12-3-4-访问类型排列" class="headerlink" title="12.3.4 访问类型排列"></a>12.3.4 访问类型排列</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">type显示的是访问类型，是较为重要的一个指标，结果值从最好到最</span><br><span class="line">坏依次是： </span><br><span class="line"></span><br><span class="line">system &gt; const &gt; eq<span class="emphasis">_ref &gt; ref &gt; fulltext </span></span><br><span class="line"><span class="emphasis">&gt; ref_</span>or<span class="emphasis">_null &gt; index_</span>merge &gt; unique<span class="emphasis">_subquery</span></span><br><span class="line"><span class="emphasis">&gt; index_</span>subquery &gt; range(尽量保证) &gt; index &gt; ALL </span><br><span class="line"></span><br><span class="line">system&gt;const&gt;eq<span class="emphasis">_ref&gt;ref&gt;range&gt;index&gt;ALL</span></span><br><span class="line"><span class="emphasis">一般来说，得保证查询至少达到range级别，最好能达到ref。</span></span><br><span class="line"><span class="emphasis">123456789</span></span><br><span class="line"><span class="emphasis">system</span></span><br><span class="line"><span class="emphasis">表只有一行记录（等于系统表），这是cont类型的特列，平时不会出现，</span></span><br><span class="line"><span class="emphasis">这个也可以忽略不计</span></span><br><span class="line"><span class="emphasis">123</span></span><br><span class="line"><span class="emphasis">const</span></span><br><span class="line"><span class="emphasis">表示通过索引一次就找到了 const用于比较 primary key或者 </span></span><br><span class="line"><span class="emphasis">unique素引。因为只匹配一行数据，所以很快</span></span><br><span class="line"><span class="emphasis">如将主键置于 where列表中， MYSQL就能将该查询转换为一个常量</span></span><br><span class="line"><span class="emphasis">1234</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202153814990.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">eq<span class="emphasis">_ref</span></span><br><span class="line"><span class="emphasis">唯一性素引扫描，对于每个索引键，表中只有一条记录与之匹配。</span></span><br><span class="line"><span class="emphasis">常见于主键或唯一索引扫描</span></span><br><span class="line"><span class="emphasis">123</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202153731432.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ref</span><br><span class="line">非唯一性素引扫描，返回匹配某个单独值的所有行</span><br><span class="line">本质上也是一种索引访问，它返回所有匹配某个单独值的行，然而</span><br><span class="line">它可能会找到多个符合条件的行，所以他应该属于查找和扫描的混合体</span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202154435169.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">range</span><br><span class="line">只检索给定范围的行，使用一个索引来选择行。</span><br><span class="line">key列显示使用了哪个素引</span><br><span class="line">一般就是在你的 where语句中出现了 between、&lt;、&gt;、in等的查询</span><br><span class="line">这种范围扫描索引扫描比全表扫描要好，因为它只需要开始于索</span><br><span class="line">引的某一点.而结束语另一点，不用扫描全部素引。</span><br><span class="line">123456</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202181003539.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">index</span><br><span class="line">Full Index Scan, index与ALL区别为 index类型只遍历素引树.</span><br><span class="line">这通常比ALL快，因为索引文件週常比数据文件小。</span><br><span class="line">也就是说虽然al和 Index都是读全表，但 index是从素引中读取的，</span><br><span class="line">而all是从硬盘中读的）</span><br><span class="line">12345</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202182023698.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">all</span><br><span class="line">Full Table Scan，将遍历全表以找到匹配的行</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202182132346.png" alt="在这里插入图片描述"></p>
<h6 id="12-3-5-possible-keys"><a href="#12-3-5-possible-keys" class="headerlink" title="12.3.5 possible_keys"></a>12.3.5 possible_keys</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">显示可能应用在这张表中的素引，一个或多个</span><br><span class="line">查询涉及到的字段上若存在素引，则该索引将被列出，但不一</span><br><span class="line">定被查询实际使用</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<h6 id="12-3-6-key"><a href="#12-3-6-key" class="headerlink" title="12.3.6 key"></a>12.3.6 key</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">实际使用的素引。如果为NULL，则没有使用索引</span><br><span class="line">1</span><br><span class="line">查询中若使用了覆盖索引，则该索引和查询的 select字段重叠</span><br><span class="line">1</span><br><span class="line">对比下图两个 sql 语句。和 key 的值：当查询具体某一字段时，</span><br><span class="line">且那个字段有索引时，key 值会显示为索引。 </span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202183656628.png" alt="在这里插入图片描述"></p>
<h6 id="12-3-7-key-len"><a href="#12-3-7-key-len" class="headerlink" title="12.3.7 key_len"></a>12.3.7 key_len</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度。</span><br><span class="line">key<span class="emphasis">_len字段能够帮你裣查是否充分的利用上了索引</span></span><br><span class="line"><span class="emphasis">12</span></span><br></pre></td></tr></table></figure>

<h6 id="12-3-8-ref"><a href="#12-3-8-ref" class="headerlink" title="12.3.8 ref"></a>12.3.8 ref</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">显示索引的哪一列被使用了，如果可能的话，是一个常数。</span><br><span class="line">哪些列或常量被用于查找素引列上的值</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202191619911.png" alt="在这里插入图片描述"></p>
<h6 id="12-3-9-rows"><a href="#12-3-9-rows" class="headerlink" title="12.3.9 rows"></a>12.3.9 rows</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rows列显示MySQL认为它执行查询时必须检查的行数。</span><br><span class="line">越少越好</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<h6 id="12-3-10-Extra"><a href="#12-3-10-Extra" class="headerlink" title="12.3.10 Extra"></a>12.3.10 Extra</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">包含不适合在其他列中显示但十分重要的额外信息</span><br><span class="line">1</span><br><span class="line">Using filesort</span><br><span class="line">说明mysql会对数据使用一个外部的索引排序,</span><br><span class="line">而不是按照表内的索引顺序进行读取。</span><br><span class="line">MYSQL中无法利用索引完成的排序操作称为&quot;文件排序&quot;</span><br><span class="line">1234</span><br><span class="line">Using temporary</span><br><span class="line">使了用临时表保存中间结果 ,MYQL在对查询</span><br><span class="line">结果排序时使用临时表。常见于排序 order</span><br><span class="line">by和分组查询 group by。</span><br><span class="line">1234</span><br><span class="line">优化前存在 using  temporary 和 using  filesort </span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202194416997.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">create index idx<span class="emphasis">_deptno_</span>ename on emp(deptno,ename) 后解决</span><br><span class="line">优化前存在的 using  temporary 和 using  filesort 不在，性能发生明显变化：</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202194457546.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">USING index</span><br><span class="line">表示相应的 select操作中使用了覆盖索引(CoveringIndex) ,避兔访问了</span><br><span class="line">表的数据行，效率不错</span><br><span class="line">如果同时出现 using where，表明索引被用来执行索引键值的查找；</span><br><span class="line">如果没有同时出现 using where，表明索引只是用来读取数据而非利</span><br><span class="line">用索引执行查找。</span><br><span class="line">123456</span><br><span class="line">Using where</span><br><span class="line">表明使用了 where过滤</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<h5 id="12-4-查询优化"><a href="#12-4-查询优化" class="headerlink" title="12.4 查询优化"></a>12.4 查询优化</h5><h6 id="12-4-1-案例（索引失效）"><a href="#12-4-1-案例（索引失效）" class="headerlink" title="12.4.1 案例（索引失效）"></a>12.4.1 案例（索引失效）</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.全值匹配我最爱</span><br><span class="line">1</span><br><span class="line">索引  idx<span class="emphasis">_staffs_</span>nameAgePos 建立索引时 以 name ， age ，pos 的顺序建立的。全值匹配表示 按顺序匹配的</span><br><span class="line">EXPLAIN SELECT * FROM staffs WHERE NAME = &#x27;July&#x27;;</span><br><span class="line">EXPLAIN SELECT * FROM staffs WHERE NAME = &#x27;July&#x27; AND age = 25;</span><br><span class="line">EXPLAIN SELECT * FROM staffs WHERE NAME = &#x27;July&#x27; AND age = 25 AND pos = &#x27;dev&#x27;;</span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202230540196.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">2.最佳左前缀法则</span><br><span class="line">如果索引了多列，要遵守最左前缀法则。指的是查询从索引的最左</span><br><span class="line">前列开始并且不跳过索引中的列</span><br><span class="line">123</span><br><span class="line">EXPLAIN SELECT * FROM staffs WHERE age = 25 AND pos = &#x27;dev&#x27;; </span><br><span class="line">EXPLAIN SELECT * FROM staffs WHERE pos = &#x27;dev&#x27;;</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202231814488.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202231827845.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202231902847.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">3.不在索引列上做任何操作</span><br><span class="line">(计算、函数、(自动or手动）类型转换）,会导致索引失效而转向全</span><br><span class="line">表扫描</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/2020120223210288.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">4.存储引擎不能使用索引中范围条件右边的列</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202233238740.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201202233346723.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">5.尽量使用覆盖索引,只访问索引的查询（索引列和查询列一致），</span><br><span class="line">减少 select * </span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203074831799.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203074924515.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">6.mysql在使用不等于（!=或者&lt;&gt;)的时候无法使用索引会导致</span><br><span class="line">全表扫描</span><br><span class="line">索引  idx<span class="emphasis">_nameAgeJob</span></span><br><span class="line"><span class="emphasis">123</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203080035748.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">7.is not nu也无法使用索引，但是 is null是可以使用索引的</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203080132985.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">8.like以通配符开头（&quot;%abc..)mysql索引失效会变成全表扫描的操作</span><br><span class="line">like ‘%abc%’  type 类型会变成 all</span><br><span class="line">like ‘abc%’ type 类型为 range ，算是范围，可以使用索引</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203080309326.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">9.字符串不加单引号索引失效</span><br><span class="line"> 底层进行转换使索引失效，使用了函数造成索引失效</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203080425311.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">10.少用or，用它来连接时会索引失效</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/2020120308051825.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">小总结</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203081016393.png" alt="在这里插入图片描述"></p>
<h5 id="12-5-order-by关键字优化"><a href="#12-5-order-by关键字优化" class="headerlink" title="12.5 order by关键字优化"></a>12.5 order by关键字优化</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ORDER BY子句，尽量使用 Index方式排序，避免使用 File Sort，方式排序</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203091940631.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203092000526.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MYSQL支持二种方式的排序， File Sort和Index, Index效率高,</span><br><span class="line">它指 MYSQL扫描索引本身完成排序。 File Sort，方式效率较低。</span><br><span class="line">12</span><br><span class="line">ORDER BY满足两情況，会使用Index方式排序</span><br><span class="line">1ORDER BY语句使用索引最左前列</span><br><span class="line">2.使用 Where子句与 Order BY子句条件列组合满足索引最左前列</span><br><span class="line">3.where子句中如果出现引的范围查询（即explain中出现 range）</span><br><span class="line">会导致 order by索引失效</span><br><span class="line">12345</span><br><span class="line">尽可能在索引列上完成排序操作，遵照索引建的最佳左前缀</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203093527967.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">第二种中，where a = const and b &gt; const order by b , c </span><br><span class="line">不会出现 using filesort  b , c 两个衔接上了</span><br><span class="line">但是：where a = const and b &gt; const order by  c 将会出</span><br><span class="line">现 using filesort 。因为 b 用了范围索引，断了。</span><br><span class="line">而上一个  order by 后的b 用到了索引，所以能衔接上 c </span><br><span class="line">12345</span><br></pre></td></tr></table></figure>

<h5 id="12-6-GROUP-BY关键字优化"><a href="#12-6-GROUP-BY关键字优化" class="headerlink" title="12.6 GROUP BY关键字优化"></a>12.6 GROUP BY关键字优化</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">1.group  by实质是先排序后进行分组，遵照索引建的最佳左前缀</span><br><span class="line">2.当无法使用索引列，增大 max<span class="emphasis">_length_</span>for<span class="emphasis">_sort_</span>data参数的设置+增</span><br><span class="line">大 sort<span class="emphasis">_buffer_</span>size参数的设置</span><br><span class="line">3.where高于having,能写在 where限定的条件就不要去 having限定了。</span><br><span class="line">4.去重优化</span><br><span class="line">尽量不要使用 distinct</span><br><span class="line">关键字去重：优化</span><br><span class="line">t<span class="emphasis">_mall_</span>sku 表</span><br><span class="line">  id  shp<span class="emphasis">_id      kcdz                </span></span><br><span class="line"><span class="emphasis">------  ------ --------------------</span></span><br><span class="line"><span class="emphasis">     3       1    北京市昌平区  </span></span><br><span class="line"><span class="emphasis">     4       1    北京市昌平区  </span></span><br><span class="line"><span class="emphasis">     5       5    北京市昌平区  </span></span><br><span class="line"><span class="emphasis">     6       3       重庆              </span></span><br><span class="line"><span class="emphasis">     8       8     天津              </span></span><br><span class="line"><span class="emphasis">例子：select kcdz form t_</span>mall<span class="emphasis">_sku where id in( 3,4,5,6,8 )  </span></span><br><span class="line"><span class="emphasis">将产生重复数据，</span></span><br><span class="line"><span class="emphasis">select distinct kcdz form t_</span>mall<span class="emphasis">_sku where id in( 3,4,5,6,8 )   使用 distinct 关键字去重消耗性能</span></span><br><span class="line"><span class="emphasis">优化： select  kcdz form t_</span>mall<span class="emphasis">_sku where id in( 3,4,5,6,8 )  group by kcdz 能够利用到索引</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">1234567891011121314151617181920</span></span><br><span class="line"><span class="emphasis">5.分页查询的优化-limit</span></span><br><span class="line"><span class="emphasis">1</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203095128383.png" alt="在这里插入图片描述"></p>
<h5 id="12-7-查询截取分析"><a href="#12-7-查询截取分析" class="headerlink" title="12.7 查询截取分析"></a>12.7 查询截取分析</h5><h6 id="12-7-1-慢查询日志"><a href="#12-7-1-慢查询日志" class="headerlink" title="12.7.1 慢查询日志"></a>12.7.1 慢查询日志</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">MySQL的慢查询日志是MySQL提供的一种日志记录，它用来记</span><br><span class="line">录在MySQL中响应时间超过阀值的语句，具体指运行时间超</span><br><span class="line">过long<span class="emphasis">_query_</span>time值的SQL，则会被记录到慢查询日志中。</span><br><span class="line"></span><br><span class="line">具体指运行时间超过long<span class="emphasis">_query_</span>time值的SQL，则会被记录到</span><br><span class="line">慢查询日志中。long<span class="emphasis">_query_</span>time的默认值为10，意思是运行10秒</span><br><span class="line">以上的语句。</span><br><span class="line"></span><br><span class="line">由他来查看哪些SQL超出了我们的最大忍耐时间值，比如一条</span><br><span class="line">sql执行超过5秒钟，我们就算慢SQL，希望能收集超过5秒的</span><br><span class="line">sql，结合之前explain进行全面分析。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">默认情况下，MySQL数据库没有开启慢查询日志，需要我们手</span><br><span class="line">动来设置这个参数。</span><br><span class="line">当然，如果不是调优需要的话，一般不建议启动该参数，因为开</span><br><span class="line">启慢查询日志会或多或少带来一定的性能影响。慢查询日志支持</span><br><span class="line">将日志记录写入文件</span><br><span class="line">123456789101112131415161718192021</span><br><span class="line">默认情况下slow<span class="emphasis">_query_</span>log的值为OFF，表示慢查询日志是禁用的，</span><br><span class="line">可以通过设置slow<span class="emphasis">_query_</span>log的值来开启</span><br><span class="line"> </span><br><span class="line"> SHOW VARIABLES LIKE &#x27;%slow<span class="emphasis">_query_</span>log%&#x27;;</span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203195527147.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">使用set global slow<span class="emphasis">_query_</span>log=1开启了慢查询日志只对当前数</span><br><span class="line">据库生效，如果MySQL重启后则会失效。</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> 全局变量设置，对当前连接不影响</span><br><span class="line">对当前连接立刻生效</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">如果要永久生效，就必须修改配置文件my.cnf（其它系统变量也是如此）</span><br><span class="line">修改my.cnf文件，[mysqld]下增加或修改参数</span><br><span class="line">slow<span class="emphasis">_query_</span>log 和slow<span class="emphasis">_query_</span>log<span class="emphasis">_file后，然后重启MySQL服务器。</span></span><br><span class="line"><span class="emphasis">也即将如下两行配置进my.cnf文件</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">slow_</span>query<span class="emphasis">_log =1</span></span><br><span class="line"><span class="emphasis">slow_</span>query<span class="emphasis">_log_</span>file=/var/lib/mysql/cqm-slow.log</span><br><span class="line"> </span><br><span class="line">关于慢查询的参数slow<span class="emphasis">_query_</span>log<span class="emphasis">_file ，它指定慢查询日志文件</span></span><br><span class="line"><span class="emphasis">的存放路径，系统默认会给一个缺省的文件host_</span>name-slow.log</span><br><span class="line">（如果没有指定参数slow<span class="emphasis">_query_</span>log<span class="emphasis">_file的话）</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">123456789101112131415161718192021</span></span><br><span class="line"><span class="emphasis">那么开启了慢査询日志后，什么样的SQLオ会记录到慢查询日志里面呢</span></span><br><span class="line"><span class="emphasis">1</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203195822630.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">可以使用命令修改，也可以在my.cnf参数里面修改。</span><br><span class="line"> </span><br><span class="line">假如运行时间正好等于long<span class="emphasis">_query_</span>time的情况，并不会被记录下来。</span><br><span class="line">也就是说，在mysql源码里是判断大于long<span class="emphasis">_query_</span>time，而非大于等于。</span><br><span class="line">1234</span><br><span class="line">査看当前多少秒算慢</span><br><span class="line">SHOW VARIABLES LIKE &#x27;long<span class="emphasis">_query_</span>time%&#x27;;</span><br><span class="line">12</span><br><span class="line">设置慢的阙值时间</span><br><span class="line">set global long<span class="emphasis">_query_</span>time=1</span><br><span class="line">修改为阙值到1秒钟的就是慢sql</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203200158628.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">修改后发现long<span class="emphasis">_query_</span>time并没有改变。</span><br><span class="line">需要重新连接或新开一个会话才能看到修改值。 SHOW VARIABLES LIKE  &#x27;long<span class="emphasis">_query_</span>time%&#x27;;</span><br><span class="line"></span><br><span class="line">或者通过 set session</span><br><span class="line">long_ query time=1来改变当前 session变量；</span><br><span class="line">12345</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203200347713.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">记录慢SQL并后续分析</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203200500786.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">跟踪日志信息</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203200535361.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">查询当前系统中有多少条慢查询记录</span><br><span class="line">show global status like &#x27;%Slow<span class="emphasis">_queries%&#x27;;</span></span><br><span class="line"><span class="emphasis">12</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203201250864.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">日志分析工具 mysqldumpslow</span><br><span class="line">在生产环境中，如果要手工分析日志，查找、分析SQL，显然是</span><br><span class="line">个体力活，MySQL提供了日志分析工具mysqldumpslow。</span><br><span class="line">123</span><br><span class="line">mysqldumpslow --help</span><br><span class="line">1</span><br><span class="line">工作常用参考</span><br><span class="line">得到返回记录集最多的10个SQL</span><br><span class="line">mysqldumpslow -s r -t 10 /var/lib/mysql/cqm-slow.log</span><br><span class="line"> </span><br><span class="line">得到访问次数最多的10个SQL</span><br><span class="line">mysqldumpslow -s c -t 10 /var/lib/mysql/cqm-slow.log</span><br><span class="line"> </span><br><span class="line">得到按照时间排序的前10条里面含有左连接的查询语句</span><br><span class="line">mysqldumpslow -s t -t 10 -g &quot;left join&quot; /var/lib/mysql/cqm-slow.log</span><br><span class="line"> </span><br><span class="line">另外建议在使用这些命令时结合 | 和more 使用 ，否则有可能出现爆屏情况</span><br><span class="line">mysqldumpslow -s r -t 10 /var/lib/mysql/cqm-slow.log | more</span><br><span class="line"></span><br><span class="line">12345678910111213</span><br><span class="line">Show Profile</span><br><span class="line">是 mysql提供可以用来分析当前会话中语句执行的资源消耗情況。</span><br><span class="line">可以用于SQL的调优的测量</span><br><span class="line">默认情況下，参数处于关闭状态，并保存最近15次的运行结果</span><br><span class="line">1234</span><br><span class="line">Show  variables like &#x27;profiling&#x27;;</span><br><span class="line">默认是关闭，使用前需要开启</span><br><span class="line">开启功能，默认是关闭，使用前需要开启</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203202500602.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">查看结果， show profiles</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203202624620.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">诊新5QL, show profile cpu, block io for query n(n为上ー步前面的问题</span><br><span class="line">5QL数字号码）</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203204708908.png" alt="在这里插入图片描述"></p>
<h5 id="12-8-主从复制"><a href="#12-8-主从复制" class="headerlink" title="12.8 主从复制"></a>12.8 主从复制</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">slave会从 master 读取 binlog来进行数据同步</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203205044615.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">MySQL复制过程分成三步：</span><br><span class="line">1 master将改变记录到二进制日志（binary log）。这些记录过程叫做二进制日志事件，binary log events；</span><br><span class="line">2 slave将master的binary log events拷贝到它的中继日志（relay log）；</span><br><span class="line">3 slave重做中继日志中的事件，将改变应用到自己的数据库中。 MySQL复制是异步的且串行化的</span><br><span class="line">1234</span><br><span class="line">复制的基本原则</span><br><span class="line">每个slave有一个 master</span><br><span class="line">每个slave只能有一个唯一的服务器ID</span><br><span class="line">每个master可以有多个 salve</span><br><span class="line">1234</span><br><span class="line">复制的最大问越</span><br><span class="line">延时</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<h5 id="12-9-MySql锁机制"><a href="#12-9-MySql锁机制" class="headerlink" title="12.9 MySql锁机制"></a>12.9 MySql锁机制</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">锁是计算机协调多个进程或线程并发访问某一资源的机制。</span><br><span class="line"></span><br><span class="line">在数据库中，除传统的计算资源（如CPU、RAM、I/O等）的争用以外，数据也是一种供许多用户共享的资源。如何保证数据并发访问的一致性、有效性是所有数据库必须解决的一个问题，锁冲突也是影响数据库并发访问性能的一个重要因素。从这个角度来说，锁对数据库而言显得尤其重要，也更加复杂。</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<h5 id="12-10-锁的分类"><a href="#12-10-锁的分类" class="headerlink" title="12.10 锁的分类"></a>12.10 锁的分类</h5><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">从对数据操作的类型（读\写）分</span><br><span class="line">读锁（共享锁）：针对同一份数据，多个读操作可以同时进行而不会互相影响。</span><br><span class="line">写锁（排它锁）：当前写操作没有完成前，它会阻断其他写锁和读锁。</span><br><span class="line">从对数据操作的粒度分</span><br><span class="line">表锁</span><br><span class="line">行锁</span><br><span class="line">123456</span><br></pre></td></tr></table></figure>

<h6 id="12-10-1-表锁（偏读）"><a href="#12-10-1-表锁（偏读）" class="headerlink" title="12.10.1 表锁（偏读）"></a>12.10.1 表锁（偏读）</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">偏向 MYISAM存储引擎，开销小，加锁快；无死锁；锁定粒度大，</span><br><span class="line">发生锁冲突的概最高，并发度最低</span><br><span class="line">12</span><br><span class="line">create table mylock(</span><br><span class="line"> id int not null primary key auto<span class="emphasis">_increment,</span></span><br><span class="line"><span class="emphasis"> name varchar(20)</span></span><br><span class="line"><span class="emphasis">)engine myisam;</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">insert into mylock(name) values(&#x27;a&#x27;);</span></span><br><span class="line"><span class="emphasis">insert into mylock(name) values(&#x27;b&#x27;);</span></span><br><span class="line"><span class="emphasis">insert into mylock(name) values(&#x27;c&#x27;);</span></span><br><span class="line"><span class="emphasis">insert into mylock(name) values(&#x27;d&#x27;);</span></span><br><span class="line"><span class="emphasis">insert into mylock(name) values(&#x27;e&#x27;);</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">select * from mylock;</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">【手动增加表锁】</span></span><br><span class="line"><span class="emphasis"> lock table 表名字1 read(write)，表名字2 read(write)，其它;</span></span><br><span class="line"><span class="emphasis">【查看表上加过的锁】</span></span><br><span class="line"><span class="emphasis">  show open tables;</span></span><br><span class="line"><span class="emphasis">  【释放表锁】</span></span><br><span class="line"><span class="emphasis">unlock tables;</span></span><br><span class="line"><span class="emphasis"></span></span><br><span class="line"><span class="emphasis">1234567891011121314151617181920</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203210658919.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">我们为mylock表加read锁(读阻塞写例子)</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203211140320.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203211226876.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203211510677.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203211524262.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">加写锁</span><br><span class="line">mylockwrite(MyISAM)</span><br><span class="line">12</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203211656234.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203211912471.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203211929625.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">MyISAM在执行查询语句（SELECT）前，会自动给涉及的所有表加读锁，在执行增删改操作前，会自动给涉及的表加写锁。 </span><br><span class="line">MySQL的表级锁有两种模式：</span><br><span class="line">表共享读锁（Table Read Lock）</span><br><span class="line">表独占写锁（Table Write Lock）</span><br><span class="line">1234</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203212133939.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">结论：</span><br><span class="line"> 结合上表，所以对MyISAM表进行操作，会有以下情况： </span><br><span class="line">  1、对MyISAM表的读操作（加读锁），不会阻塞其他进程对同一表</span><br><span class="line">的读请求，但会阻塞对同一表的写请求。只有当读锁释放后，才会执行</span><br><span class="line">其它进程的写操作。 </span><br><span class="line">  2、对MyISAM表的写操作（加写锁），会阻塞其他进程对同一表的</span><br><span class="line">读和写操作，只有当写锁释放后，才会执行其它进程的读写操作。</span><br><span class="line">简而言之，就是读锁会阻塞写，但是不会堵塞读。而写锁则会把读和写都堵塞</span><br><span class="line">12345678</span><br></pre></td></tr></table></figure>

<h6 id="12-10-2-行锁-偏写"><a href="#12-10-2-行锁-偏写" class="headerlink" title="12.10.2 行锁(偏写)"></a>12.10.2 行锁(偏写)</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">偏向 INNODB存储引擎，开销大，</span><br><span class="line">加锁慢；会出现死锁；锁定粒度</span><br><span class="line">最小，发生锁冲突的概率最低，并</span><br><span class="line">发度也最高。</span><br><span class="line"></span><br><span class="line">INNODB与 MYISAM的最大不同有两点：一是支持事务（TRANSACTION）;二是采用了行级锁</span><br><span class="line">123456</span><br><span class="line">由于行锁支持事务</span><br><span class="line">1</span><br><span class="line">事务（Transaction）及其ACID属性</span><br><span class="line">事务是由一组SQL语句组成的逻辑处理单元，事务具有以下4个属性，通常简称为事务的ACID属性。 </span><br><span class="line">原子性（Atomicity）：事务是一个原子操作单元，其对数据的修改，要么全都执行，要么全都不执行。 </span><br><span class="line">一致性（Consistent）：在事务开始和完成时，数据都必须保持一致状态。</span><br><span class="line">这意味着所有相关的数据规则都必须应用于事务的修改，以保持数据的完</span><br><span class="line">整性；事务结束时，所有的内部数据结构（如B树索引或双向链表）也都</span><br><span class="line">必须是正确的。 </span><br><span class="line">隔离性（Isolation）：数据库系统提供一定的隔离机制，保证事务在不受</span><br><span class="line">外部并发操作影响的“独立”环境执行。这意味着事务处理过程中的中间状</span><br><span class="line">态对外部是不可见的，反之亦然。 </span><br><span class="line">持久性（Durable）：事务完成之后，它对于数据的修改是永久性的，即</span><br><span class="line">使出现系统故障也能够保持。 </span><br><span class="line"></span><br><span class="line">12345678910111213</span><br><span class="line">建表SQL</span><br><span class="line">create table test<span class="emphasis">_innodb_</span>lock (a int(11),b varchar(16))engine=innodb;</span><br><span class="line"> </span><br><span class="line">insert into test<span class="emphasis">_innodb_</span>lock values(1,&#x27;b2&#x27;);</span><br><span class="line">insert into test<span class="emphasis">_innodb_</span>lock values(3,&#x27;3&#x27;);</span><br><span class="line">insert into test<span class="emphasis">_innodb_</span>lock values(4,&#x27;4000&#x27;);</span><br><span class="line">insert into test<span class="emphasis">_innodb_</span>lock values(5,&#x27;5000&#x27;);</span><br><span class="line">insert into test<span class="emphasis">_innodb_</span>lock values(6,&#x27;6000&#x27;);</span><br><span class="line">insert into test<span class="emphasis">_innodb_</span>lock values(7,&#x27;7000&#x27;);</span><br><span class="line">insert into test<span class="emphasis">_innodb_</span>lock values(8,&#x27;8000&#x27;);</span><br><span class="line">insert into test<span class="emphasis">_innodb_</span>lock values(9,&#x27;9000&#x27;);</span><br><span class="line">insert into test<span class="emphasis">_innodb_</span>lock values(1,&#x27;b1&#x27;);</span><br><span class="line"> </span><br><span class="line">create index test<span class="emphasis">_innodb_</span>a<span class="emphasis">_ind on test_</span>innodb<span class="emphasis">_lock(a);</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">create index test_</span>innodb<span class="emphasis">_lock_</span>b<span class="emphasis">_ind on test_</span>innodb<span class="emphasis">_lock(b);</span></span><br><span class="line"><span class="emphasis"> </span></span><br><span class="line"><span class="emphasis">select * from test_</span>innodb<span class="emphasis">_lock;</span></span><br><span class="line"><span class="emphasis">123456789101112131415161718</span></span><br><span class="line"><span class="emphasis">行锁定基本演示</span></span><br><span class="line"><span class="emphasis">1</span></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203213428769.png" alt="在这里插入图片描述"><br><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203213451312.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">无索引行锁升级为表锁</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203213556373.png" alt="在这里插入图片描述"></p>
<h6 id="12-10-2-1-间隙锁"><a href="#12-10-2-1-间隙锁" class="headerlink" title="12.10.2.1 间隙锁"></a>12.10.2.1 间隙锁</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">间隙锁带来的插入问题</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203213935913.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">【什么是间隙锁】</span><br><span class="line">当我们用范围条件而不是相等条件检索数据，并请求共享或排他锁时，</span><br><span class="line">InnoDB会给符合条件的已有数据记录的索引项加锁；对于键值在条件</span><br><span class="line">范围内但并不存在的记录，叫做“间隙（GAP)”，</span><br><span class="line">InnoDB也会对这个“间隙”加锁，这种锁机制就是所谓的间隙锁（GAP Lock）。</span><br><span class="line"> </span><br><span class="line">【危害】</span><br><span class="line">因为Query执行过程中通过过范围查找的话，他会锁定整个范围内所</span><br><span class="line">有的索引键值，即使这个键值并不存在。</span><br><span class="line">间隙锁有一个比较致命的弱点，就是当锁定一个范围键值之后，即使某</span><br><span class="line">些不存在的键值也会被无辜的锁定，而造成在锁定的时候无法插入</span><br><span class="line">锁定键值范围内的任何数据。在某些场景下这可能会对性能造成很</span><br><span class="line">大的危害</span><br><span class="line">12345678910111213</span><br><span class="line">行锁分析</span><br><span class="line">通过检查InnoDB<span class="emphasis">_row_</span>lock状态变量来分析系统上的行锁的争夺情况</span><br><span class="line">mysql&gt;show status like &#x27;innodb<span class="emphasis">_row_</span>lock%&#x27;;</span><br><span class="line">123</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/../UpPictures/mysql%E5%9F%BA%E7%A1%80%E5%92%8C%E9%AB%98%E7%BA%A7Pictures/20201203214549124.png" alt="在这里插入图片描述"></p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">对各个状态量的说明如下：</span><br><span class="line"></span><br><span class="line">Innodb<span class="emphasis">_row_</span>lock<span class="emphasis">_current_</span>waits：当前正在等待锁定的数量；</span><br><span class="line">Innodb<span class="emphasis">_row_</span>lock<span class="emphasis">_time：从系统启动到现在锁定总时间长度；</span></span><br><span class="line"><span class="emphasis">Innodb_</span>row<span class="emphasis">_lock_</span>time<span class="emphasis">_avg：每次等待所花平均时间；</span></span><br><span class="line"><span class="emphasis">Innodb_</span>row<span class="emphasis">_lock_</span>time<span class="emphasis">_max：从系统启动到现在等待最常的一次所花的时间；</span></span><br><span class="line"><span class="emphasis">Innodb_</span>row<span class="emphasis">_lock_</span>waits：系统启动后到现在总共等待的次数；</span><br><span class="line">对于这5个状态变量，比较重要的主要是</span><br><span class="line">Innodb<span class="emphasis">_row_</span>lock<span class="emphasis">_time_</span>avg（等待平均时长），</span><br><span class="line">Innodb<span class="emphasis">_row_</span>lock<span class="emphasis">_waits（等待总次数）</span></span><br><span class="line"><span class="emphasis">Innodb_</span>row<span class="emphasis">_lock_</span>time（等待总时长）这三项。</span><br><span class="line">尤其是当等待次数很高，而且每次等待时长也不小的时候，我们就需要</span><br><span class="line">分析系统中为什么会有如此多的等待，然后根据分析结果着手指</span><br><span class="line">定优化计划。</span><br><span class="line"></span><br><span class="line">最后可以通过</span><br><span class="line">SELECT * FROM information<span class="emphasis">_schema.INNODB_</span>TRX\G;</span><br><span class="line">来查询正在被锁阻塞的sql语句。</span><br><span class="line"></span><br><span class="line">12345678910111213141516171819</span><br><span class="line">优化建议</span><br><span class="line">尽可能让所有数据检索都通过索引来完成，避免无索引行锁升级为表锁。</span><br><span class="line"></span><br><span class="line">尽可能较少检索条件，避免间隙锁</span><br><span class="line"></span><br><span class="line">尽量控制事务大小，减少锁定资源量和时间长度</span><br><span class="line"></span><br><span class="line">锁住某行后，尽量不要去调别的行或表，赶紧处理被锁住的行然后</span><br><span class="line">释放掉锁</span><br><span class="line"></span><br><span class="line">涉及相同表的事务，对于调用表的顺序尽量保持一致。</span><br><span class="line"></span><br><span class="line">在业务环境允许的情况下，尽可能低级别事务隔离</span><br><span class="line">12345678910111213</span><br></pre></td></tr></table></figure>

<h6 id="12-10-3-页锁"><a href="#12-10-3-页锁" class="headerlink" title="12.10.3 页锁"></a>12.10.3 页锁</h6><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">开销和加锁时间界于表锁和行锁之间：会出现死锁；锁定粒度界于表锁</span><br><span class="line">利行锁之间，并发度一般</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="https://chabai000.github.io">茶白</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="https://chabai000.github.io/posts/37461/">https://chabai000.github.io/posts/37461/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://chabai000.github.io" target="_blank">茶白的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/">数据库</a></div><div class="post_share"><div class="social-share" data-image="https://api.aqcoder.cn/random" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i>赞助</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/%E8%B5%9E%E8%B5%8F%E7%A0%81.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/%E8%B5%9E%E8%B5%8F%E7%A0%81.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/12796/" title="centos7"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.aqcoder.cn/random" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">centos7</div></div></a></div><div class="next-post pull-right"><a href="/posts/49176/" title="docker"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.aqcoder.cn/random" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">docker</div></div></a></div></nav><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="disqus_thread"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">茶白</div><div class="author-info__description">不论你在什么时候开始，重要的是开始之后就不要停止；不论你在什么时候结束，重要的是结束之后就不要悔恨</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">13</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">2</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/chabai000"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/chabai000" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1693522579@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">MySQL基础</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E5%90%AF%E5%8A%A8%E5%92%8C%E5%81%9C%E6%AD%A2MySQL%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 启动和停止MySQL服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-MySQL%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%9A%84%E7%99%BB%E5%BD%95%E5%92%8C%E9%80%80%E5%87%BA"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 MySQL服务端的登录和退出</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-MySQL%E7%9A%84%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 MySQL的常见命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-4-MySQL%E7%9A%84%E8%AF%AD%E6%B3%95%E8%A7%84%E8%8C%83"><span class="toc-number">1.4.</span> <span class="toc-text">1.4 MySQL的语法规范</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-5-%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.5.</span> <span class="toc-text">1.5 基础查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-5-1-%E5%9F%BA%E7%A1%80%E6%9F%A5%E8%AF%A2%E6%A1%88%E4%BE%8B"><span class="toc-number">1.5.1.</span> <span class="toc-text">1.5.1 基础查询案例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-6-%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.6.</span> <span class="toc-text">1.6 条件查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-7-%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.7.</span> <span class="toc-text">1.7 排序查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-7-1-%E6%A1%88%E4%BE%8B%E6%8E%92%E5%BA%8F%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.7.1.</span> <span class="toc-text">1.7.1 案例排序查询</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-8-%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0"><span class="toc-number">1.8.</span> <span class="toc-text">1.8 常见函数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-8-1-%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">1.8.1.</span> <span class="toc-text">1.8.1 单行函数</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-8-1-1-%E6%A1%88%E4%BE%8B%E5%8D%95%E8%A1%8C%E5%87%BD%E6%95%B0"><span class="toc-number">1.8.1.1.</span> <span class="toc-text">1.8.1.1 案例单行函数</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-8-2-%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0"><span class="toc-number">1.8.2.</span> <span class="toc-text">1.8.2 分组函数</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#1-8-2-1-%E6%A1%88%E4%BE%8B%E5%88%86%E7%BB%84%E5%87%BD%E6%95%B0"><span class="toc-number">1.8.2.1.</span> <span class="toc-text">1.8.2.1 案例分组函数</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-9-%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.9.</span> <span class="toc-text">1.9 分组查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-9-1-%E6%A1%88%E4%BE%8B%E5%88%86%E7%BB%84%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.9.1.</span> <span class="toc-text">1.9.1 案例分组查询</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.10.</span> <span class="toc-text">2.1 连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-1-%E6%A1%88%E4%BE%8B%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.10.1.</span> <span class="toc-text">2.1.1 案例连接查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-2-sql99%E8%AF%AD%E6%B3%95%E7%9A%84%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.10.2.</span> <span class="toc-text">2.1.2 sql99语法的连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#2-1-2-1-%E5%A4%9A%E8%A1%A8%E8%BF%9E%E6%8E%A5"><span class="toc-number">1.10.2.1.</span> <span class="toc-text">2.1.2.1 多表连接</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#2-1-2-2-join%E8%BF%9E%E6%8E%A5%E6%80%BB%E7%BB%93"><span class="toc-number">1.10.2.2.</span> <span class="toc-text">2.1.2.2 join连接总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.11.</span> <span class="toc-text">2.2 子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-1-%E6%A1%88%E4%BE%8B%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.11.1.</span> <span class="toc-text">2.2.1 案例子查询</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-2-%E5%AD%90%E6%9F%A5%E8%AF%A2%E7%BB%8F%E5%85%B8%E6%A1%88%E4%BE%8B"><span class="toc-number">1.11.2.</span> <span class="toc-text">2.2.2 子查询经典案例</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.12.</span> <span class="toc-text">2.3 分页查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E8%81%94%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.13.</span> <span class="toc-text">2.4 联合查询</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-select%E8%AF%AD%E5%8F%A5%E6%80%BB%E7%BB%93"><span class="toc-number">1.14.</span> <span class="toc-text">2.5 select语句总结</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-%E6%95%B0%E6%8D%AE%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9"><span class="toc-number">1.15.</span> <span class="toc-text">2.6 数据的增删改</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-6-1-%E6%A1%88%E4%BE%8B%E6%95%B0%E6%8D%AE%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9"><span class="toc-number">1.15.1.</span> <span class="toc-text">2.6.1 案例数据的增删改</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-7-%E5%BA%93%E5%92%8C%E8%A1%A8%E7%9A%84%E7%AE%A1%E7%90%86"><span class="toc-number">1.16.</span> <span class="toc-text">2.7 库和表的管理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-7-1-%E6%A1%88%E4%BE%8B%E5%BA%93%E5%92%8C%E8%A1%A8%E7%9A%84%E7%AE%A1%E7%90%86"><span class="toc-number">1.16.1.</span> <span class="toc-text">2.7.1 案例库和表的管理</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-8-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.17.</span> <span class="toc-text">2.8 数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-9-%E5%B8%B8%E8%A7%81%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.18.</span> <span class="toc-text">2.9 常见约束</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-9-1-%E6%A1%88%E4%BE%8B%E5%B8%B8%E8%A7%81%E7%BA%A6%E6%9D%9F"><span class="toc-number">1.18.1.</span> <span class="toc-text">2.9.1 案例常见约束</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E4%BA%8B%E5%8A%A1"><span class="toc-number">1.19.</span> <span class="toc-text">3.1 事务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E8%A7%86%E5%9B%BE"><span class="toc-number">1.20.</span> <span class="toc-text">3.2 视图</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-1-%E6%A1%88%E4%BE%8B%E8%A7%86%E5%9B%BE"><span class="toc-number">1.20.1.</span> <span class="toc-text">3.2.1 案例视图</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-%E5%8F%98%E9%87%8F"><span class="toc-number">1.21.</span> <span class="toc-text">3.3 变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">1.22.</span> <span class="toc-text">3.4 存储过程</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-4-1-%E6%A1%88%E4%BE%8B%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="toc-number">1.22.1.</span> <span class="toc-text">3.4.1 案例存储过程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-%E5%87%BD%E6%95%B0"><span class="toc-number">1.23.</span> <span class="toc-text">3.5 函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-6-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84"><span class="toc-number">1.24.</span> <span class="toc-text">3.6 流程控制结构</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-6-1-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E7%BB%8F%E5%85%B8%E6%A1%88%E4%BE%8B%E8%AE%B2%E8%A7%A3"><span class="toc-number">1.24.1.</span> <span class="toc-text">3.6.1 流程控制经典案例讲解</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySql%E9%AB%98%E7%BA%A7"><span class="toc-number">2.</span> <span class="toc-text">MySql高级</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-MYSQL%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86"><span class="toc-number">2.1.</span> <span class="toc-text">1 MYSQL用户管理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="toc-number">2.1.1.</span> <span class="toc-text">1.1 创建用户</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-%E4%BA%86%E8%A7%A3User%E8%A1%A8"><span class="toc-number">2.1.2.</span> <span class="toc-text">1.2 了解User表</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-3-%E8%AE%BE%E7%BD%AE%E5%AF%86%E7%A0%81"><span class="toc-number">2.1.3.</span> <span class="toc-text">1.3 设置密码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-4-%E4%BF%AE%E6%94%B9%E7%94%A8%E6%88%B7"><span class="toc-number">2.1.4.</span> <span class="toc-text">1.4 修改用户</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-5-%E5%88%A0%E9%99%A4%E7%94%A8%E6%88%B7"><span class="toc-number">2.1.5.</span> <span class="toc-text">1.5 删除用户</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="toc-number">2.2.</span> <span class="toc-text">2 权限管理</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-%E6%8E%88%E4%BA%88%E6%9D%83%E9%99%90"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.1 授予权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-%E6%94%B6%E5%9B%9E%E6%9D%83%E9%99%90"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2 收回权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-%E6%9F%A5%E7%9C%8B%E6%9D%83%E9%99%90"><span class="toc-number">2.2.3.</span> <span class="toc-text">2.3 查看权限</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-4-%E9%80%9A%E8%BF%87%E5%B7%A5%E5%85%B7%E8%BF%9C%E7%A8%8B%E8%AE%BF%E9%97%AE"><span class="toc-number">2.2.4.</span> <span class="toc-text">2.4 通过工具远程访问</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-mysql%E7%9A%84%E4%B8%80%E4%BA%9B%E6%9D%82%E9%A1%B9%E9%85%8D%E7%BD%AE"><span class="toc-number">2.3.</span> <span class="toc-text">3 mysql的一些杂项配置</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-1-%E5%A4%A7%E5%B0%8F%E5%86%99%E9%97%AE%E9%A2%98"><span class="toc-number">2.3.1.</span> <span class="toc-text">3.1 大小写问题</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-sql-mode"><span class="toc-number">2.3.2.</span> <span class="toc-text">3.2 sql_mode</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-Mysql%E9%80%BB%E8%BE%91%E6%9E%B6%E6%9E%84"><span class="toc-number">2.4.</span> <span class="toc-text">4 Mysql逻辑架构</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-%E6%80%BB%E4%BD%93%E6%A6%82%E8%A7%88"><span class="toc-number">2.4.1.</span> <span class="toc-text">4.1 总体概览</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-Mysql%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E"><span class="toc-number">2.5.</span> <span class="toc-text">5 Mysql存储引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-%E6%9F%A5%E7%9C%8B%E5%91%BD%E4%BB%A4"><span class="toc-number">2.5.1.</span> <span class="toc-text">5.1 查看命令</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-2-%E5%90%84%E4%B8%AA%E5%BC%95%E6%93%8E%E7%AE%80%E4%BB%8B"><span class="toc-number">2.5.2.</span> <span class="toc-text">5.2 各个引擎简介</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#5-2-1-MyISAM%E5%92%8CInnoDB"><span class="toc-number">2.5.2.1.</span> <span class="toc-text">5.2.1 MyISAM和InnoDB</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E7%B4%A2%E5%BC%95%E4%BC%98%E5%8C%96%E5%88%86%E6%9E%90"><span class="toc-number">2.6.</span> <span class="toc-text">6 索引优化分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E6%89%8B%E5%86%99%E8%B7%9F%E6%9C%BA%E8%AF%BB"><span class="toc-number">2.7.</span> <span class="toc-text">7 手写跟机读</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#7-1-%E6%89%8B%E5%86%99"><span class="toc-number">2.7.1.</span> <span class="toc-text">7.1 手写</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#7-2-%E6%9C%BA%E8%AF%BB"><span class="toc-number">2.7.2.</span> <span class="toc-text">7.2 机读</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E4%B8%83%E7%A7%8Djoin"><span class="toc-number">2.8.</span> <span class="toc-text">8 七种join</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E7%B4%A2%E5%BC%95"><span class="toc-number">2.9.</span> <span class="toc-text">9 索引</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#9-1-%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">2.9.1.</span> <span class="toc-text">9.1 是什么</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#9-2-%E4%BC%98%E5%8A%BF-%E5%8A%A3%E5%8A%BF"><span class="toc-number">2.9.2.</span> <span class="toc-text">9.2 优势 &amp;&amp; 劣势</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-mysq%E7%B4%A2%E5%BC%95%E7%BB%93%E6%9E%84"><span class="toc-number">2.10.</span> <span class="toc-text">10 mysq索引结构</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#10-1-Myisam%E6%99%AE%E9%80%9A%E7%B4%A0%E5%BC%95"><span class="toc-number">2.10.1.</span> <span class="toc-text">10.1 Myisam普通素引</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#10-1-1-Btree%E7%B4%A2%E5%BC%95"><span class="toc-number">2.10.1.1.</span> <span class="toc-text">10.1.1 Btree索引</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#10-1-2-%E5%85%B3%E4%BA%8E%E6%97%B6%E9%97%B4%E5%A4%8D%E6%9D%82%E5%BA%A6"><span class="toc-number">2.10.1.2.</span> <span class="toc-text">10.1.2 关于时间复杂度</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#10-2-innodb%E7%9A%84%E6%99%AE%E9%80%9A%E7%B4%A0%E5%BC%95"><span class="toc-number">2.10.2.</span> <span class="toc-text">10.2 innodb的普通素引</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#10-2-1-B-Tree%E7%B4%A2%E5%BC%95"><span class="toc-number">2.10.2.1.</span> <span class="toc-text">10.2.1 B+Tree索引</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#10-2-2-B%E6%A0%91%E5%92%8CB-%E6%A0%91%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.10.2.2.</span> <span class="toc-text">10.2.2 B树和B+树的区别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-mysq%E7%B4%A0%E5%BC%95%E5%88%86%E7%B1%BB"><span class="toc-number">2.11.</span> <span class="toc-text">11 mysq素引分类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#11-1-%E4%B8%BB%E9%94%AE%E7%B4%A2%E5%BC%95"><span class="toc-number">2.11.1.</span> <span class="toc-text">11.1 主键索引</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-2-%E5%8D%95%E5%80%BC%E7%B4%A2%E5%BC%95"><span class="toc-number">2.11.2.</span> <span class="toc-text">11.2 单值索引</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-3-%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95"><span class="toc-number">2.11.3.</span> <span class="toc-text">11.3 唯一索引</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-4-%E5%A4%8D%E5%90%88%E7%B4%A2%E5%BC%95"><span class="toc-number">2.11.4.</span> <span class="toc-text">11.4 复合索引</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-5-%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">2.11.5.</span> <span class="toc-text">11.5 基本语法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-6-%E5%93%AA%E4%BA%9B%E6%83%85%E5%86%B5%E9%9C%80%E8%A6%81%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="toc-number">2.11.6.</span> <span class="toc-text">11.6 哪些情况需要创建索引</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#11-7-%E5%93%AA%E4%BA%9B%E6%83%85%E5%86%B5%E4%B8%8D%E8%A6%81%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="toc-number">2.11.7.</span> <span class="toc-text">11.7 哪些情况不要创建索引</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90"><span class="toc-number">2.12.</span> <span class="toc-text">12 性能分析</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#12-1-MYSQL%E5%B8%B8%E8%A7%81%E7%93%B6%E9%A2%88"><span class="toc-number">2.12.1.</span> <span class="toc-text">12.1 MYSQL常见瓶颈</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-2-Explain"><span class="toc-number">2.12.2.</span> <span class="toc-text">12.2 Explain</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-3-%E6%89%A7%E8%A1%8C%E8%AE%A1%E5%88%92%E5%8C%85%E5%90%AB%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="toc-number">2.12.3.</span> <span class="toc-text">12.3 执行计划包含的信息</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#12-3-1-id"><span class="toc-number">2.12.3.1.</span> <span class="toc-text">12.3.1 id</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-3-2-select-type"><span class="toc-number">2.12.3.2.</span> <span class="toc-text">12.3.2 select_type</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-3-3-table"><span class="toc-number">2.12.3.3.</span> <span class="toc-text">12.3.3 table</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-3-4-%E8%AE%BF%E9%97%AE%E7%B1%BB%E5%9E%8B%E6%8E%92%E5%88%97"><span class="toc-number">2.12.3.4.</span> <span class="toc-text">12.3.4 访问类型排列</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-3-5-possible-keys"><span class="toc-number">2.12.3.5.</span> <span class="toc-text">12.3.5 possible_keys</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-3-6-key"><span class="toc-number">2.12.3.6.</span> <span class="toc-text">12.3.6 key</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-3-7-key-len"><span class="toc-number">2.12.3.7.</span> <span class="toc-text">12.3.7 key_len</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-3-8-ref"><span class="toc-number">2.12.3.8.</span> <span class="toc-text">12.3.8 ref</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-3-9-rows"><span class="toc-number">2.12.3.9.</span> <span class="toc-text">12.3.9 rows</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-3-10-Extra"><span class="toc-number">2.12.3.10.</span> <span class="toc-text">12.3.10 Extra</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-4-%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96"><span class="toc-number">2.12.4.</span> <span class="toc-text">12.4 查询优化</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#12-4-1-%E6%A1%88%E4%BE%8B%EF%BC%88%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88%EF%BC%89"><span class="toc-number">2.12.4.1.</span> <span class="toc-text">12.4.1 案例（索引失效）</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-5-order-by%E5%85%B3%E9%94%AE%E5%AD%97%E4%BC%98%E5%8C%96"><span class="toc-number">2.12.5.</span> <span class="toc-text">12.5 order by关键字优化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-6-GROUP-BY%E5%85%B3%E9%94%AE%E5%AD%97%E4%BC%98%E5%8C%96"><span class="toc-number">2.12.6.</span> <span class="toc-text">12.6 GROUP BY关键字优化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-7-%E6%9F%A5%E8%AF%A2%E6%88%AA%E5%8F%96%E5%88%86%E6%9E%90"><span class="toc-number">2.12.7.</span> <span class="toc-text">12.7 查询截取分析</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#12-7-1-%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97"><span class="toc-number">2.12.7.1.</span> <span class="toc-text">12.7.1 慢查询日志</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-8-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6"><span class="toc-number">2.12.8.</span> <span class="toc-text">12.8 主从复制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-9-MySql%E9%94%81%E6%9C%BA%E5%88%B6"><span class="toc-number">2.12.9.</span> <span class="toc-text">12.9 MySql锁机制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#12-10-%E9%94%81%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-number">2.12.10.</span> <span class="toc-text">12.10 锁的分类</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#12-10-1-%E8%A1%A8%E9%94%81%EF%BC%88%E5%81%8F%E8%AF%BB%EF%BC%89"><span class="toc-number">2.12.10.1.</span> <span class="toc-text">12.10.1 表锁（偏读）</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-10-2-%E8%A1%8C%E9%94%81-%E5%81%8F%E5%86%99"><span class="toc-number">2.12.10.2.</span> <span class="toc-text">12.10.2 行锁(偏写)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-10-2-1-%E9%97%B4%E9%9A%99%E9%94%81"><span class="toc-number">2.12.10.3.</span> <span class="toc-text">12.10.2.1 间隙锁</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#12-10-3-%E9%A1%B5%E9%94%81"><span class="toc-number">2.12.10.4.</span> <span class="toc-text">12.10.3 页锁</span></a></li></ol></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/12796/" title="centos7"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.aqcoder.cn/random" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="centos7"/></a><div class="content"><a class="title" href="/posts/12796/" title="centos7">centos7</a><time datetime="2024-05-18T07:14:53.000Z" title="发表于 2024-05-18 15:14:53">2024-05-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/37461/" title="mysql基础和高级"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.aqcoder.cn/random" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="mysql基础和高级"/></a><div class="content"><a class="title" href="/posts/37461/" title="mysql基础和高级">mysql基础和高级</a><time datetime="2024-05-18T07:14:41.000Z" title="发表于 2024-05-18 15:14:41">2024-05-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/49176/" title="docker"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.aqcoder.cn/random" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="docker"/></a><div class="content"><a class="title" href="/posts/49176/" title="docker">docker</a><time datetime="2024-05-17T07:52:50.000Z" title="发表于 2024-05-17 15:52:50">2024-05-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/22256/" title="swagger"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.aqcoder.cn/random" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="swagger"/></a><div class="content"><a class="title" href="/posts/22256/" title="swagger">swagger</a><time datetime="2024-05-17T07:23:44.000Z" title="发表于 2024-05-17 15:23:44">2024-05-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/43167/" title="git"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://api.aqcoder.cn/random" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="git"/></a><div class="content"><a class="title" href="/posts/43167/" title="git">git</a><time datetime="2024-05-17T07:23:16.000Z" title="发表于 2024-05-17 15:23:16">2024-05-17</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2024 By 茶白</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="/js/tw_cn.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@17.8.8/dist/lazyload.iife.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.16/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const disqus_config = function () {
    this.page.url = 'https://chabai000.github.io/posts/37461/'
    this.page.identifier = '/posts/37461/'
    this.page.title = 'mysql基础和高级'
  }

  const disqusReset = () => {
    window.DISQUS && window.DISQUS.reset({
      reload: true,
      config: disqus_config
    })
  }

  btf.addGlobalFn('themeChange', disqusReset, 'disqus')

  const loadDisqus = () =>{
    if (window.DISQUS) disqusReset()
    else {
      const script = document.createElement('script')
      script.src = 'https://lchabai.disqus.com/embed.js'
      script.setAttribute('data-timestamp', +new Date())
      document.head.appendChild(script)
    }
  }

  const getCount = async() => {
    try {
      const eleGroup = document.querySelector('#post-meta .disqus-comment-count')
      if (!eleGroup) return
      const cleanedLinks = eleGroup.href.replace(/#post-comment$/, '')

      const res = await fetch(`https://disqus.com/api/3.0/threads/set.json?forum=lchabai&api_key=&thread:link=${cleanedLinks}`,{
        method: 'GET'
      })
      const result = await res.json()

      const count = result.response.length ? result.response[0].posts : 0
      eleGroup.textContent = count
    } catch (err) {
      console.error(err)
    }
  }

  if ('Disqus' === 'Disqus' || !true) {
    if (true) btf.loadComment(document.getElementById('disqus_thread'), loadDisqus)
    else {
      loadDisqus()
      
    }
  } else {
    window.loadOtherComment = loadDisqus
  }
})()</script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<code>.*?<\/code>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    fetch('https://disqus.com/api/3.0/forums/listPosts.json?forum=lchabai&related=thread&limit=6&api_key=')
      .then(response => response.json())
      .then(data => {
        const disqusArray = data.response.map(item => {
          return {
            'avatar': item.author.avatar.cache,
            'content': changeContent(item.message),
            'nick': item.author.name,
            'url': item.url,
            'date': item.createdAt
          }
        })

        saveToLocal.set('disqus-newest-comments', JSON.stringify(disqusArray), 10/(60*24))
        generateHtml(disqusArray)
      }).catch(e => {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (false) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>
        </div></div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('disqus-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><div class="aplayer no-destroy" data-id="9310458102" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false" data-lrcType="0"> </div><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/click-show-text.min.js" data-mobile="false" data-text="I,LOVE,YOU" data-fontsize="15px" data-random="false" async="async"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/metingjs/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener
  btf.removeGlobalFnEvent('pjax')
  btf.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>